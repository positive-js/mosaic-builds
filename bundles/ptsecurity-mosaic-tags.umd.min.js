!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/cdk/platform"),require("@angular/common"),require("@angular/core"),require("@ptsecurity/cdk/keycodes"),require("@angular/cdk/coercion"),require("@angular/forms"),require("@angular/cdk/bidi"),require("@angular/cdk/collections"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/mosaic/core"),require("@ptsecurity/mosaic/form-field"),require("rxjs"),require("rxjs/operators"),require("@ptsecurity/mosaic/icon")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/tags",["exports","@angular/cdk/platform","@angular/common","@angular/core","@ptsecurity/cdk/keycodes","@angular/cdk/coercion","@angular/forms","@angular/cdk/bidi","@angular/cdk/collections","@ptsecurity/cdk/a11y","@ptsecurity/mosaic/core","@ptsecurity/mosaic/form-field","rxjs","rxjs/operators","@ptsecurity/mosaic/icon"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).ptsecurity=t.ptsecurity||{},t.ptsecurity.mosaic=t.ptsecurity.mosaic||{},t.ptsecurity.mosaic.tags={}),t.ng.cdk.platform,t.ng.common,t.ng.core,t.keycodes,t.ng.cdk.coercion,t.ng.forms,t.ng.cdk.bidi,t.ng.cdk.collections,t.a11y,t.ptsecurity.mosaic.core,t.ptsecurity.mosaic["form-field"],t.rxjs,t.rxjs.operators,t.ptsecurity.mosaic.icon)}(this,(function(t,e,n,i,o,r,s,a,c,l,u,p,h,d,g){"use strict";var f=new i.InjectionToken("mc-tags-default-options"),y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function m(t,e){function n(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;function b(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function C(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}Object.create;var x=0,_=function(){function t(t,e,n,o){this.elementRef=t,this.renderer=e,this.defaultOptions=n,this.ngControl=o,this.focused=!1,this.separatorKeyCodes=this.defaultOptions.separatorKeyCodes,this.tagEnd=new i.EventEmitter,this.placeholder="",this.id="mc-tag-list-input-"+x++,this._addOnBlur=!0,this._disabled=!1,this.countOfSymbolsForUpdateWidth=3,this.inputElement=this.elementRef.nativeElement,this.setDefaultInputWidth()}return Object.defineProperty(t.prototype,"tagList",{set:function(t){t&&(this._tagList=t,this._tagList.registerInput(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addOnBlur",{get:function(){return this._addOnBlur},set:function(t){this._addOnBlur=r.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled||this._tagList&&this._tagList.disabled},set:function(t){this._disabled=r.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return!this.inputElement.value},enumerable:!1,configurable:!0}),t.prototype.ngOnChanges=function(){this._tagList.stateChanges.next()},t.prototype.onKeydown=function(t){this.inputElement.value||this._tagList.keydown(t),this.isSeparatorKey(t)&&(this.emitTagEnd(),t.preventDefault())},t.prototype.blur=function(){this.focused=!1,this._tagList.focused||(this.triggerValidation(),this._tagList.blur()),this.addOnBlur&&this.emitTagEnd(),this._tagList.stateChanges.next()},t.prototype.triggerValidation=function(){this.hasControl()&&this.ngControl.statusChanges.emit(this.ngControl.status)},t.prototype.emitTagEnd=function(){(!this.hasControl()||this.hasControl()&&!this.ngControl.invalid)&&(this.tagEnd.emit({input:this.inputElement,value:this.inputElement.value}),this.updateInputWidth())},t.prototype.onInput=function(){this.updateInputWidth(),this._tagList.stateChanges.next()},t.prototype.onPaste=function(t){var e,n,i=this;if(t.clipboardData){var o=t.clipboardData.getData("text");if(!o||0!==o.length){var r=[];try{for(var s=b(this.separatorKeyCodes),a=s.next();!a.done;a=s.next()){var c=a.value,l=this.separatorKeyToSymbol(c);if(o.search(l)>-1){r.push.apply(r,C(o.split(l)));break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}0===r.length&&r.push(o),r.forEach((function(t){return i.tagEnd.emit({input:i.inputElement,value:t})})),this.updateInputWidth(),t.preventDefault(),t.stopPropagation()}}},t.prototype.updateInputWidth=function(){var t=this.inputElement.value.length;this.renderer.setStyle(this.inputElement,"max-width",0),this.oneSymbolWidth=this.inputElement.scrollWidth/t,this.renderer.setStyle(this.inputElement,"max-width",""),t>this.countOfSymbolsForUpdateWidth?this.renderer.setStyle(this.inputElement,"width",t*this.oneSymbolWidth+"px"):this.setDefaultInputWidth()},t.prototype.onFocus=function(){this.focused=!0,this._tagList.stateChanges.next()},t.prototype.focus=function(){this.inputElement.focus()},t.prototype.separatorKeyToSymbol=function(t){var e,n=(e={},e[o.ENTER]=/\r?\n/,e[o.TAB]=/\t/,e[o.SPACE]=/ /,e[o.COMMA]=/,/,e)[t];return n||t},t.prototype.hasControl=function(){return!!this.ngControl},t.prototype.setDefaultInputWidth=function(){this.renderer.setStyle(this.inputElement,"width","30px")},t.prototype.isSeparatorKey=function(t){return!o.hasModifierKey(t)&&this.separatorKeyCodes.indexOf(t.keyCode)>-1},t}();_.decorators=[{type:i.Directive,args:[{selector:"input[mcTagInputFor]",exportAs:"mcTagInput, mcTagInputFor",host:{class:"mc-tag-input","[id]":"id","[attr.disabled]":"disabled || null","[attr.placeholder]":"placeholder || null","(keydown)":"onKeydown($event)","(blur)":"blur()","(focus)":"onFocus()","(input)":"onInput()","(paste)":"onPaste($event)"}}]}],_.ctorParameters=function(){return[{type:i.ElementRef},{type:i.Renderer2},{type:void 0,decorators:[{type:i.Inject,args:[f]}]},{type:s.NgControl,decorators:[{type:i.Optional},{type:i.Self}]}]},_.propDecorators={separatorKeyCodes:[{type:i.Input,args:["mcTagInputSeparatorKeyCodes"]}],tagEnd:[{type:i.Output,args:["mcTagInputTokenEnd"]}],placeholder:[{type:i.Input}],id:[{type:i.Input}],tagList:[{type:i.Input,args:["mcTagInputFor"]}],addOnBlur:[{type:i.Input,args:["mcTagInputAddOnBlur"]}],disabled:[{type:i.Input}]};var I=function(t,e,n){void 0===n&&(n=!1),this.source=t,this.selected=e,this.isUserInput=n};var S=["mc-basic-tag"],T=function(){};T.decorators=[{type:i.Directive,args:[{selector:"mc-tag-avatar, [mcTagAvatar]",host:{class:"mc-tag-avatar"}}]}];var E=function(){};E.decorators=[{type:i.Directive,args:[{selector:"mc-tag-trailing-icon, [mcTagTrailingIcon]",host:{class:"mc-tag-trailing-icon"}}]}];var O=function(t){this._elementRef=t};var k=u.mixinColor(u.mixinDisabled(O)),w=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.elementRef=e,r.changeDetectorRef=n,r._ngZone=o,r.onFocus=new h.Subject,r.onBlur=new h.Subject,r.hasFocus=!1,r.tagListSelectable=!0,r.selectionChange=new i.EventEmitter,r.destroyed=new i.EventEmitter,r.removed=new i.EventEmitter,r._selected=!1,r._selectable=!0,r._removable=!0,r._disabled=!1,r.addHostClassName(),r.nativeElement=e.nativeElement,r}return m(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){var e=r.coerceBooleanProperty(t);e!==this._selected&&(this._selected=e,this.dispatchSelectionChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return void 0!==this._value?this._value:this.elementRef.nativeElement.textContent},set:function(t){this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectable",{get:function(){return this._selectable&&this.tagListSelectable},set:function(t){this._selectable=r.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"removable",{get:function(){return this._removable},set:function(t){this._removable=r.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabindex",{get:function(){return this.selectable?this.disabled?null:-1:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t!==this.disabled&&(this._disabled=t)},enumerable:!1,configurable:!0}),e.prototype.ngAfterContentInit=function(){this.addClassModificatorForIcons()},e.prototype.addClassModificatorForIcons=function(){var t=this.contentChildren.map((function(t){return t._elementRef.nativeElement}));if(1===t.length){var e=t[0];e.previousElementSibling||e.nextElementSibling||(e.nextSibling&&(e.classList.add("mc-icon_left"),this.nativeElement.classList.add("mc-left-icon")),e.previousSibling&&(e.classList.add("mc-icon_right"),this.nativeElement.classList.add("mc-right-icon")))}else if(t.length>1){var n=t[0],i=t[1];n.classList.add("mc-icon_left"),i.classList.add("mc-icon_right")}},e.prototype.addHostClassName=function(){var t,e;try{for(var n=b(S),i=n.next();!i.done;i=n.next()){var o=i.value;if(this.elementRef.nativeElement.hasAttribute(o)||this.elementRef.nativeElement.tagName.toLowerCase()===o)return void this.elementRef.nativeElement.classList.add(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.elementRef.nativeElement.classList.add("mc-standard-tag")},e.prototype.ngOnDestroy=function(){this.destroyed.emit({tag:this})},e.prototype.select=function(){this._selected||(this._selected=!0,this.dispatchSelectionChange())},e.prototype.deselect=function(){this._selected&&(this._selected=!1,this.dispatchSelectionChange())},e.prototype.selectViaInteraction=function(){this._selected||(this._selected=!0,this.dispatchSelectionChange(!0))},e.prototype.toggleSelected=function(t){return void 0===t&&(t=!1),this._selected=!this.selected,this.dispatchSelectionChange(t),this.selected},e.prototype.focus=function(){var t=this;this.selectable&&(this.hasFocus||(this.elementRef.nativeElement.focus(),this.onFocus.next({tag:this}),Promise.resolve().then((function(){t.hasFocus=!0,t.changeDetectorRef.markForCheck()}))))},e.prototype.remove=function(){this.removable&&this.removed.emit({tag:this})},e.prototype.handleClick=function(t){this.disabled?t.preventDefault():t.stopPropagation()},e.prototype.handleKeydown=function(t){if(!this.disabled)switch(t.keyCode){case o.DELETE:case o.BACKSPACE:this.remove(),t.preventDefault();break;case o.SPACE:this.selectable&&this.toggleSelected(!0),t.preventDefault()}},e.prototype.blur=function(){var t=this;this._ngZone.onStable.asObservable().pipe(d.take(1)).subscribe((function(){t._ngZone.run((function(){t.hasFocus=!1,t.onBlur.next({tag:t})}))}))},e.prototype.dispatchSelectionChange=function(t){void 0===t&&(t=!1),this.selectionChange.emit({source:this,isUserInput:t,selected:this._selected})},e}(k);w.decorators=[{type:i.Component,args:[{selector:"mc-tag, [mc-tag], mc-basic-tag, [mc-basic-tag]",exportAs:"mcTag",template:'<div class="mc-tag__wrapper">\n    <span class="mc-tag__text"><ng-content></ng-content></span>\n    <ng-content select="[mc-icon]"></ng-content>\n    <div class="mc-tag-overlay"></div>\n</div>\n',inputs:["color"],host:{class:"mc-tag","[attr.tabindex]":"tabindex","[attr.disabled]":"disabled || null","[class.mc-selected]":"selected","[class.mc-focused]":"hasFocus","[class.mc-tag-with-avatar]":"avatar","[class.mc-tag-with-trailing-icon]":"trailingIcon || removeIcon","[class.mc-disabled]":"disabled","(click)":"handleClick($event)","(keydown)":"handleKeydown($event)","(focus)":"focus()","(blur)":"blur()"},changeDetection:i.ChangeDetectionStrategy.OnPush,encapsulation:i.ViewEncapsulation.None,styles:[".mc-tag{border-radius:var(--mc-tags-size-border-radius,4px);border-style:solid;border-width:var(--mc-tags-size-border-width,1px);box-sizing:border-box;cursor:default;display:inline-block;height:var(--mc-tags-size-height,24px);margin:var(--mc-tags-size-margin,2px);outline:none;overflow:hidden;position:relative}.mc-tag.mc-left-icon{padding-left:var(--mc-tags-size-icon-padding,3px)}.mc-tag.mc-right-icon{padding-right:var(--mc-tags-size-icon-padding,3px)}.mc-tag__wrapper{align-items:center;display:flex;flex:1 1 100%;height:100%}.mc-tag__wrapper .mc-icon{align-items:center;display:flex;flex-shrink:0;height:var(--mc-tags-size-height,24px);justify-content:center;width:var(--mc-tags-size-height,24px)}.mc-tag__wrapper .mc-icon_left{margin-right:var(--mc-tags-size-icon-padding,3px)}.mc-tag__wrapper .mc-icon_right{margin-left:var(--mc-tags-size-icon-padding,3px)}.mc-tag-overlay{border-radius:inherit;bottom:-1px;left:-1px;pointer-events:none;position:absolute;right:-1px;top:-1px}.mc-tag__text{margin-left:calc(var(--mc-tags-size-text-margin, 8px) - var(--mc-tags-size-border-width, 1px));overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}]}],w.ctorParameters=function(){return[{type:i.ElementRef},{type:i.ChangeDetectorRef},{type:i.NgZone}]},w.propDecorators={contentChildren:[{type:i.ContentChildren,args:[g.McIcon]}],avatar:[{type:i.ContentChild,args:[T,{static:!1}]}],trailingIcon:[{type:i.ContentChild,args:[E,{static:!1}]}],removeIcon:[{type:i.ContentChild,args:[i.forwardRef((function(){return M})),{static:!1}]}],selectionChange:[{type:i.Output}],destroyed:[{type:i.Output}],removed:[{type:i.Output}],selected:[{type:i.Input}],value:[{type:i.Input}],selectable:[{type:i.Input}],removable:[{type:i.Input}],disabled:[{type:i.Input}]};var M=function(){function t(t){this.parentTag=t}return t.prototype.focus=function(t){t.stopPropagation()},t.prototype.handleClick=function(t){this.parentTag.removable&&this.parentTag.remove(),t.stopPropagation()},t}();M.decorators=[{type:i.Directive,args:[{selector:"[mcTagRemove]",host:{class:"mc-tag-remove mc-tag-trailing-icon","[attr.tabindex]":"-1","(click)":"handleClick($event)","(focus)":"focus($event)"}}]}],M.ctorParameters=function(){return[{type:w}]};var P=function(t,e,n,i){this.defaultErrorStateMatcher=t,this.parentForm=e,this.parentFormGroup=n,this.ngControl=i};var D=u.mixinErrorState(P),F=0,j=function(t,e){this.source=t,this.value=e};var A=function(t){function e(e,n,o,r,s,a,c,l,u,p,d){var g=t.call(this,o,c,l,u)||this;return g.elementRef=e,g.changeDetectorRef=n,g.rawValidators=r,g.mcValidation=s,g.dir=a,g.ngModel=p,g.formControlName=d,g.controlType="mc-tag-list",g._tabIndex=0,g.valueChange=new i.EventEmitter,g.uid="mc-tag-list-"+F++,g.userTabIndex=null,g.tagChanges=new i.EventEmitter,g.orientation="horizontal",g.change=new i.EventEmitter,g._required=!1,g._disabled=!1,g._selectable=!0,g._multiple=!1,g.lastDestroyedTagIndex=null,g.destroyed=new h.Subject,g.onTouched=function(){},g.onChange=function(){},g._compareWith=function(t,e){return t===e},g.ngControl&&(g.ngControl.valueAccessor=g),g}return m(e,t),Object.defineProperty(e.prototype,"tagSelectionChanges",{get:function(){return h.merge.apply(void 0,C(this.tags.map((function(t){return t.selectionChange}))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagFocusChanges",{get:function(){return h.merge.apply(void 0,C(this.tags.map((function(t){return t.onFocus}))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagBlurChanges",{get:function(){return h.merge.apply(void 0,C(this.tags.map((function(t){return t.onBlur}))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagRemoveChanges",{get:function(){return h.merge.apply(void 0,C(this.tags.map((function(t){return t.destroyed}))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this.multiple?this.selectionModel.selected:this.selectionModel.selected[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canShowCleaner",{get:function(){return this.cleaner&&this.tags.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiple",{get:function(){return this._multiple},set:function(t){this._multiple=r.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"compareWith",{get:function(){return this._compareWith},set:function(t){this._compareWith=t,this.selectionModel&&this.initializeSelection()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this.writeValue(t),this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.tagInput?this.tagInput.id:this.uid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(t){this._required=r.coerceBooleanProperty(t),this.stateChanges.next()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this.tagInput?this.tagInput.placeholder:this._placeholder},set:function(t){this._placeholder=t,this.stateChanges.next()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return this.tagInput&&this.tagInput.focused||this.hasFocusedTag()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return(!this.tagInput||this.tagInput.empty)&&0===this.tags.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldLabelFloat",{get:function(){return!this.empty||this.focused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.ngControl?!!this.ngControl.disabled:this._disabled},set:function(t){this._disabled=r.coerceBooleanProperty(t),this.syncTagsDisabledState()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectable",{get:function(){return this._selectable},set:function(t){var e=this;this._selectable=r.coerceBooleanProperty(t),this.tags&&this.tags.forEach((function(t){return t.tagListSelectable=e._selectable}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabIndex",{get:function(){return this._tabIndex},set:function(t){this.userTabIndex=t,this._tabIndex=t},enumerable:!1,configurable:!0}),e.prototype.ngAfterContentInit=function(){var t=this;this.mcValidation.useValidation&&u.setMosaicValidation(this),this.keyManager=new l.FocusKeyManager(this.tags).withVerticalOrientation().withHorizontalOrientation(this.dir?this.dir.value:"ltr"),this.dir&&this.dir.change.pipe(d.takeUntil(this.destroyed)).subscribe((function(e){return t.keyManager.withHorizontalOrientation(e)})),this.keyManager.tabOut.pipe(d.takeUntil(this.destroyed)).subscribe((function(){t._tabIndex=-1,setTimeout((function(){t._tabIndex=t.userTabIndex||0,t.changeDetectorRef.markForCheck()}))})),this.tags.changes.pipe(d.startWith(null),d.takeUntil(this.destroyed)).subscribe((function(){t.disabled&&Promise.resolve().then((function(){t.syncTagsDisabledState()})),t.resetTags(),t.initializeSelection(),t.updateTabIndex(),t.updateFocusForDestroyedTags(),Promise.resolve().then((function(){t.tagChanges.emit(t.tags.toArray()),t.stateChanges.next(),t.propagateTagsChanges()}))}))},e.prototype.ngOnInit=function(){this.selectionModel=new c.SelectionModel(this.multiple,void 0,!1),this.stateChanges.next()},e.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState()},e.prototype.ngOnDestroy=function(){this.destroyed.next(),this.destroyed.complete(),this.stateChanges.complete(),this.dropSubscriptions()},e.prototype.registerInput=function(t){var e,n=this;this.tagInput=t,this.ngControl&&(null===(e=t.ngControl)||void 0===e?void 0:e.statusChanges)&&t.ngControl.statusChanges.subscribe((function(){return n.ngControl.control.setErrors(t.ngControl.errors)}))},e.prototype.writeValue=function(t){this.tags&&this.setSelectionByValue(t,!1)},e.prototype.registerOnChange=function(t){this.onChange=t},e.prototype.registerOnTouched=function(t){this.onTouched=t},e.prototype.setDisabledState=function(t){this.disabled=t,this.stateChanges.next()},e.prototype.onContainerClick=function(t){this.originatesFromTag(t)||this.focus()},e.prototype.focus=function(){this.disabled||this.tagInput&&this.tagInput.focused||(this.tags.length>0?(this.keyManager.setFirstItemActive(),this.stateChanges.next()):(this.focusInput(),this.stateChanges.next()))},e.prototype.focusInput=function(){this.tagInput&&this.tagInput.focus()},e.prototype.keydown=function(t){var e=t.target;t.keyCode===o.BACKSPACE&&this.isInputEmpty(e)?(this.keyManager.setLastItemActive(),t.preventDefault()):e&&e.classList.contains("mc-tag")&&(t.keyCode===o.HOME?(this.keyManager.setFirstItemActive(),t.preventDefault()):t.keyCode===o.END?(this.keyManager.setLastItemActive(),t.preventDefault()):this.keyManager.onKeydown(t),this.stateChanges.next())},e.prototype.setSelectionByValue=function(t,e){var n=this;if(void 0===e&&(e=!0),this.clearSelection(),this.tags.forEach((function(t){return t.deselect()})),Array.isArray(t))t.forEach((function(t){return n.selectValue(t,e)})),this.sortValues();else{var i=this.selectValue(t,e);i&&e&&this.keyManager.setActiveItem(i)}},e.prototype.blur=function(){var t=this;this.hasFocusedTag()||this.keyManager.setActiveItem(-1),this.disabled||(this.tagInput?setTimeout((function(){t.focused||t.markAsTouched()})):this.markAsTouched())},e.prototype.markAsTouched=function(){this.onTouched(),this.changeDetectorRef.markForCheck(),this.stateChanges.next()},e.prototype.updateTabIndex=function(){this._tabIndex=this.userTabIndex||(0===this.tags.length?-1:0)},e.prototype.updateFocusForDestroyedTags=function(){if(null!=this.lastDestroyedTagIndex)if(this.tags.length){var t=Math.min(this.lastDestroyedTagIndex,this.tags.length-1);this.keyManager.setActiveItem(t)}else this.focusInput();this.lastDestroyedTagIndex=null},e.prototype.isValidIndex=function(t){return t>=0&&t<this.tags.length},e.prototype.isInputEmpty=function(t){return!(!t||"input"!==t.nodeName.toLowerCase())&&!t.value},e.prototype.selectValue=function(t,e){var n=this;void 0===e&&(e=!0);var i=this.tags.find((function(e){return null!=e.value&&n._compareWith(e.value,t)}));return i&&(e?i.selectViaInteraction():i.select(),this.selectionModel.select(i)),i},e.prototype.initializeSelection=function(){var t=this;Promise.resolve().then((function(){(t.ngControl||t._value)&&(t.setSelectionByValue(t.ngControl?t.ngControl.value:t._value,!1),t.stateChanges.next())}))},e.prototype.clearSelection=function(t){this.selectionModel.clear(),this.tags.forEach((function(e){e!==t&&e.deselect()})),this.stateChanges.next()},e.prototype.sortValues=function(){var t=this;this._multiple&&(this.selectionModel.clear(),this.tags.forEach((function(e){e.selected&&t.selectionModel.select(e)})),this.stateChanges.next())},e.prototype.propagateChanges=function(t){var e=null;e=Array.isArray(this.selected)?this.selected.map((function(t){return t.value})):this.selected?this.selected.value:t,this._value=e,this.change.emit(new j(this,e)),this.valueChange.emit(e),this.onChange(e),this.changeDetectorRef.markForCheck()},e.prototype.propagateTagsChanges=function(){var t=this.tags.map((function(t){return t.value}));this._value=t,this.change.emit(new j(this,t)),this.valueChange.emit(t),this.onChange(t),this.changeDetectorRef.markForCheck()},e.prototype.resetTags=function(){this.dropSubscriptions(),this.listenToTagsFocus(),this.listenToTagsSelection(),this.listenToTagsRemoved()},e.prototype.dropSubscriptions=function(){this.tagFocusSubscription&&(this.tagFocusSubscription.unsubscribe(),this.tagFocusSubscription=null),this.tagBlurSubscription&&(this.tagBlurSubscription.unsubscribe(),this.tagBlurSubscription=null),this.tagSelectionSubscription&&(this.tagSelectionSubscription.unsubscribe(),this.tagSelectionSubscription=null),this.tagRemoveSubscription&&(this.tagRemoveSubscription.unsubscribe(),this.tagRemoveSubscription=null)},e.prototype.listenToTagsSelection=function(){var t=this;this.tagSelectionSubscription=this.tagSelectionChanges.subscribe((function(e){e.source.selected?t.selectionModel.select(e.source):t.selectionModel.deselect(e.source),t.multiple||t.tags.forEach((function(e){!t.selectionModel.isSelected(e)&&e.selected&&e.deselect()})),e.isUserInput&&t.propagateChanges()}))},e.prototype.listenToTagsFocus=function(){var t=this;this.tagFocusSubscription=this.tagFocusChanges.subscribe((function(e){var n=t.tags.toArray().indexOf(e.tag);t.isValidIndex(n)&&t.keyManager.updateActiveItem(n),t.stateChanges.next()})),this.tagBlurSubscription=this.tagBlurChanges.subscribe((function(){t.blur(),t.stateChanges.next()}))},e.prototype.listenToTagsRemoved=function(){var t=this;this.tagRemoveSubscription=this.tagRemoveChanges.subscribe((function(e){var n=e.tag,i=t.tags.toArray().indexOf(e.tag);t.isValidIndex(i)&&n.hasFocus?t.lastDestroyedTagIndex=i:t.isValidIndex(i)&&!n.hasFocus&&t.focusInput()}))},e.prototype.originatesFromTag=function(t){for(var e=t.target;e&&e!==this.elementRef.nativeElement;){if(e.classList.contains("mc-tag"))return!0;e=e.parentElement}return!1},e.prototype.hasFocusedTag=function(){return this.tags.some((function(t){return t.hasFocus}))},e.prototype.syncTagsDisabledState=function(){var t=this;this.tags&&this.tags.forEach((function(e){e.disabled=t._disabled}))},e}(D);A.decorators=[{type:i.Component,args:[{selector:"mc-tag-list",exportAs:"mcTagList",template:'<div class="mc-tags-list__list-container">\n    <ng-content></ng-content>\n</div>\n\n<div class="mc-tags-list__cleaner"\n     *ngIf="canShowCleaner">\n    <ng-content select="mc-cleaner"></ng-content>\n</div>\n',host:{class:"mc-tag-list","[class.mc-disabled]":"disabled","[class.mc-invalid]":"errorState","[attr.tabindex]":"disabled ? null : tabIndex","[id]":"uid","(focus)":"focus()","(blur)":"blur()","(keydown)":"keydown($event)"},encapsulation:i.ViewEncapsulation.None,changeDetection:i.ChangeDetectionStrategy.OnPush,providers:[{provide:p.McFormFieldControl,useExisting:A}],styles:[".mc-tag-list{display:flex;flex-direction:row}.mc-tag-input{background:transparent;border:none;outline:none}.mc-tags-list__list-container{display:flex;flex:1 1 100%;flex-wrap:wrap;min-height:var(--mc-tag-list-size-min-height,28px);min-width:0;padding:var(--mc-tag-list-size-padding,1px 6px)}.mc-tags-list__list-container .mc-tag-input{flex:1 1 auto;height:var(--mc-tag-input-size-height,22px);margin:var(--mc-tag-input-size-margin,2px 4px);max-width:100%}.mc-tags-list__cleaner .mc-cleaner{height:30px}"]}]}],A.ctorParameters=function(){return[{type:i.ElementRef},{type:i.ChangeDetectorRef},{type:u.ErrorStateMatcher},{type:Array,decorators:[{type:i.Optional},{type:i.Inject,args:[s.NG_VALIDATORS]}]},{type:void 0,decorators:[{type:i.Optional},{type:i.Inject,args:[u.MC_VALIDATION]}]},{type:a.Directionality,decorators:[{type:i.Optional}]},{type:s.NgForm,decorators:[{type:i.Optional}]},{type:s.FormGroupDirective,decorators:[{type:i.Optional}]},{type:s.NgControl,decorators:[{type:i.Optional},{type:i.Self}]},{type:s.NgModel,decorators:[{type:i.Optional},{type:i.Self}]},{type:s.FormControlName,decorators:[{type:i.Optional},{type:i.Self}]}]},A.propDecorators={multiple:[{type:i.Input}],compareWith:[{type:i.Input}],value:[{type:i.Input}],required:[{type:i.Input}],placeholder:[{type:i.Input}],disabled:[{type:i.Input}],selectable:[{type:i.Input}],tabIndex:[{type:i.Input}],valueChange:[{type:i.Output}],errorStateMatcher:[{type:i.Input}],orientation:[{type:i.Input,args:["orientation"]}],change:[{type:i.Output}],cleaner:[{type:i.ContentChild,args:["mcTagListCleaner",{static:!0}]}],tags:[{type:i.ContentChildren,args:[w,{descendants:!0}]}]};var L={separatorKeyCodes:[o.ENTER]},R=function(){};R.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule,e.PlatformModule],exports:[A,w,_,E,T,M],declarations:[A,w,_,E,T,M],providers:[{provide:f,useValue:L}]}]}],t.MC_TAGS_DEFAULT_OPTIONS=f,t.McTag=w,t.McTagAvatar=T,t.McTagBase=O,t.McTagInput=_,t.McTagList=A,t.McTagListBase=P,t.McTagListChange=j,t.McTagListMixinBase=D,t.McTagMixinBase=k,t.McTagRemove=M,t.McTagSelectionChange=I,t.McTagTrailingIcon=E,t.McTagsModule=R,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ptsecurity-mosaic-tags.umd.min.js.map
/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/animations"),require("@angular/cdk/bidi"),require("@angular/cdk/coercion"),require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/core"),require("@ptsecurity/cdk/keycodes"),require("@ptsecurity/mosaic/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/popover",["exports","@angular/animations","@angular/cdk/bidi","@angular/cdk/coercion","@angular/cdk/overlay","@angular/cdk/portal","@angular/core","@ptsecurity/cdk/keycodes","@ptsecurity/mosaic/core","rxjs","rxjs/operators","@angular/common"],t):t((e.ng=e.ng||{},e.ng.mosaic=e.ng.mosaic||{},e.ng.mosaic.popover={}),e.ng.animations,e.ng.cdk.bidi,e.ng.cdk.coercion,e.ng.cdk.overlay,e.ng.cdk.portal,e.ng.core,e.ng.cdk.keycodes,e.ng.mosaic.core,e.rxjs,e.rxjs.operators,e.ng.common)}(this,function(e,t,o,i,r,n,s,p,a,c,l,m){"use strict";function h(e){return function(){return e.scrollStrategies.reposition({scrollThrottle:20})}}function u(e){return Error('McPopover position "'+e+'" is invalid.')}var v=function(){return v=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},v.apply(this,arguments)},g={popoverState:t.trigger("state",[t.state("initial",t.style({opacity:0,transform:"scale(1, 0.8)"})),t.transition("* => visible",t.animate("120ms cubic-bezier(0, 0, 0.2, 1)",t.style({opacity:1,transform:"scale(1, 1)"}))),t.transition("* => hidden",t.animate("100ms linear",t.style({opacity:0})))])},d=function(){function e(e,t){this.changeDetectorRef=e,this.componentElementRef=t,this.positions=a.EXTENDED_OVERLAY_POSITIONS.slice(),this.popoverVisibility="initial",this.closeOnInteraction=!1,this.mcVisibleChange=new s.EventEmitter,this._mcTrigger="hover",this._mcPlacement="top",this._mcVisible=new c.BehaviorSubject(!1),this._classList=[],this.onHideSubject=new c.Subject,this.availablePositions=a.POSITION_MAP}return Object.defineProperty(e.prototype,"mcTrigger",{get:function(){return this._mcTrigger},set:function(e){this._mcTrigger=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcPlacement",{get:function(){return this._mcPlacement},set:function(e){e!==this._mcPlacement?(this._mcPlacement=e,this.positions.unshift(a.POSITION_MAP[this.mcPlacement])):e||(this._mcPlacement="top")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcPopoverSize",{get:function(){return this.popoverSize},set:function(e){e!==this.popoverSize?this.popoverSize=e:e||(this.popoverSize="normal")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcVisible",{get:function(){return this._mcVisible.value},set:function(e){var t=i.coerceBooleanProperty(e);this._mcVisible.value!==t&&(this._mcVisible.next(t),this.mcVisibleChange.emit(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this._classList.join(" ")},set:function(e){var t=[];Array.isArray(e)?t=e:t.push(e),this._classList=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getCssClassesList",{get:function(){return this.classList+" mc-popover-"+this.mcPopoverSize+" mc-popover_placement-"+this.getPlacementClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getPlacementClass",{get:function(){return a.POSITION_TO_CSS_MAP[this.mcPlacement]},enumerable:!0,configurable:!0}),e.prototype.show=function(){this.isNonEmptyContent()&&(this.closeOnInteraction=!0,this.popoverVisibility="visible",this.markForCheck())},e.prototype.hide=function(){this.popoverVisibility="hidden",this.mcVisibleChange.emit(!1),this.markForCheck()},e.prototype.isNonEmptyContent=function(){return!!this.mcContent&&(this.isTemplateRef(this.mcContent)||this.isNonEmptyString(this.mcContent))},e.prototype.afterHidden=function(){return this.onHideSubject.asObservable()},e.prototype.isVisible=function(){return"visible"===this.popoverVisibility},e.prototype.markForCheck=function(){this.changeDetectorRef.markForCheck()},e.prototype.isTemplateRef=function(e){return e instanceof s.TemplateRef},e.prototype.isNonEmptyString=function(e){return"string"==typeof e&&""!==e},e.prototype.handleBodyInteraction=function(e){this.closeOnInteraction&&!this.componentElementRef.nativeElement.contains(e.target)&&this.hide()},e.prototype.animationStart=function(){this.closeOnInteraction=!1},e.prototype.animationDone=function(e){var t=e.toState;"hidden"!==t||this.isVisible()||this.onHideSubject.next(),"visible"!==t&&"hidden"!==t||(this.closeOnInteraction=!0)},e.prototype.ngOnDestroy=function(){this.onHideSubject.complete()},e.decorators=[{type:s.Component,args:[{selector:"mc-popover",template:'<div class="mc-popover" [ngClass]="classList" [@state]="popoverVisibility" (@state.start)="animationStart()" (@state.done)="animationDone($event)"><div class="mc-popover__container"><div class="mc-popover__header" *ngIf="mcHeader"><ng-container *ngIf="isTemplateRef(mcHeader)" [ngTemplateOutlet]="mcHeader"></ng-container><ng-container *ngIf="isNonEmptyString(mcHeader)"><div [innerHTML]="mcHeader"></div></ng-container></div><div class="mc-popover__content" *ngIf="mcContent"><ng-container *ngIf="isTemplateRef(mcContent)" [ngTemplateOutlet]="mcContent"></ng-container><ng-container *ngIf="isNonEmptyString(mcContent)"><div [innerHTML]="mcContent"></div></ng-container></div><div class="mc-popover__footer" *ngIf="mcFooter"><ng-container *ngIf="isTemplateRef(mcFooter)" [ngTemplateOutlet]="mcFooter"></ng-container><ng-container *ngIf="isNonEmptyString(mcFooter)"><div [innerHTML]="mcFooter"></div></ng-container></div></div><div class="mc-popover__arrow" [ngClass]="{ \'mc-popover__arrow_with-footer\': mcFooter }"></div></div>',preserveWhitespaces:!1,styles:["@keyframes mc-progress{from{background-position:0 0}to{background-position:29px 0}}.mc-progress{position:relative}.mc-progress:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(135deg,rgba(0,0,0,.05) 10px,transparent 10px,transparent 20px,rgba(0,0,0,.05) 20px,rgba(0,0,0,.05) 30px,transparent 30px) repeat;background-size:29px 29px;animation:mc-progress 1s linear infinite}.cdk-overlay-container{pointer-events:none;top:0;left:0;height:100%;width:100%;position:fixed;z-index:1000;box-sizing:border-box;margin:0;padding:0}.cdk-overlay-backdrop{top:0;bottom:0;left:0;right:0;-webkit-tap-highlight-color:transparent;transition:opacity .4s cubic-bezier(.25,.8,.25,1);opacity:0;position:absolute;pointer-events:auto;z-index:1000;box-sizing:border-box;margin:0;padding:0}.cdk-overlay-pane{box-sizing:border-box;position:absolute;pointer-events:auto;margin:0;padding:0;z-index:1000;max-width:100%;max-height:100%}.cdk-overlay-connected-position-bounding-box{box-sizing:border-box;position:absolute;z-index:1000;display:flex;flex-direction:column;margin:0;padding:0;min-width:1px;min-height:1px}.mc-popover{position:relative;display:block;margin:0;padding:0;box-sizing:border-box;visibility:visible;z-index:1060;list-style:none;white-space:pre-line}.mc-popover-small{max-width:280px}.mc-popover-small .mc-popover{max-width:280px!important}.mc-popover-normal{max-width:400px}.mc-popover-normal .mc-popover{max-width:400px!important}.mc-popover-large{max-width:640px}.mc-popover-large .mc-popover{max-width:640px!important}.mc-popover__container{font-size:15px;border-radius:4px;border-width:1px;border-style:solid;overflow:hidden}.mc-popover__header{padding:10px 16px;border-bottom-width:1px;border-bottom-style:solid}.mc-popover__content{padding:16px}.mc-popover__footer{margin-top:8px;padding:12px 16px;border-top-width:1px;border-top-style:solid}.mc-popover_placement-top .mc-popover,.mc-popover_placement-top-left .mc-popover,.mc-popover_placement-top-right .mc-popover{padding-bottom:10px}.mc-popover_placement-right .mc-popover,.mc-popover_placement-right-bottom .mc-popover,.mc-popover_placement-right-top .mc-popover{padding-left:10px}.mc-popover_placement-bottom .mc-popover,.mc-popover_placement-bottom-left .mc-popover,.mc-popover_placement-bottom-right .mc-popover{padding-top:10px}.mc-popover_placement-left .mc-popover,.mc-popover_placement-left-bottom .mc-popover,.mc-popover_placement-left-top .mc-popover{padding-right:10px}.mc-popover__arrow{position:absolute;width:14px;height:14px;border:solid 1px;transform:rotate(45deg)}.mc-popover_placement-top .mc-popover__arrow{bottom:4px;left:50%;margin-left:-6px}.mc-popover_placement-top-left .mc-popover__arrow{bottom:4px;left:20px;margin-left:0}.mc-popover_placement-top-right .mc-popover__arrow{bottom:4px;right:20px;margin-left:0}.mc-popover_placement-right .mc-popover__arrow{left:4px;top:50%;margin-top:-6px}.mc-popover_placement-right-top .mc-popover__arrow{left:4px;top:20px;margin-top:-6px}.mc-popover_placement-right-bottom .mc-popover__arrow{left:4px;bottom:14px;margin-top:-6px}.mc-popover_placement-left .mc-popover__arrow{right:4px;top:50%;margin-top:-6px}.mc-popover_placement-left-top .mc-popover__arrow{right:4px;top:20px;margin-top:-6px}.mc-popover_placement-left-bottom .mc-popover__arrow{right:4px;bottom:14px;margin-top:-6px}.mc-popover_placement-bottom .mc-popover__arrow{top:4px;left:50%;margin-left:-6px}.mc-popover_placement-bottom-left .mc-popover__arrow{top:4px;left:20px;margin-left:0}.mc-popover_placement-bottom-right .mc-popover__arrow{top:4px;right:20px;margin-left:0}"],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush,animations:[g.popoverState],host:{"[class]":"getCssClassesList","(body:click)":"handleBodyInteraction($event)"}}]}],e.ctorParameters=function(){return[{type:s.ChangeDetectorRef},{type:s.ElementRef}]},e.propDecorators={mcVisibleChange:[{type:s.Output,args:["mcPopoverVisibleChange"]}]},e}(),f=new s.InjectionToken("mc-popover-scroll-strategy"),y={provide:f,deps:[r.Overlay],useFactory:h},b=function(){function e(e,t,o,i,r,n,p){this.overlay=e,this.elementRef=t,this.ngZone=o,this.scrollDispatcher=i,this.hostView=r,this.scrollStrategy=n,this.direction=p,this.isPopoverOpen=!1,this.isDynamicPopover=!1,this.mcVisibleChange=new s.EventEmitter,this.$unsubscribe=new c.Subject,this._disabled=!1,this._mcTrigger="hover",this.popoverSize="normal",this._mcPlacement="top",this.manualListeners=new Map,this.destroyed=new c.Subject,this.availablePositions=a.POSITION_MAP}return Object.defineProperty(e.prototype,"mcHeader",{get:function(){return this._mcHeader},set:function(e){this._mcHeader=e,this.updateCompValue("mcHeader",e),this.isPopoverOpen&&this.updatePosition(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcContent",{get:function(){return this._mcContent},set:function(e){this._mcContent=e,this.updateCompValue("mcContent",e),this.isPopoverOpen&&this.updatePosition(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcFooter",{get:function(){return this._mcFooter},set:function(e){this._mcFooter=e,this.updateCompValue("mcFooter",e),this.isPopoverOpen&&this.updatePosition(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=i.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcMouseEnterDelay",{get:function(){return this._mcMouseEnterDelay},set:function(e){this._mcMouseEnterDelay=e,this.updateCompValue("mcMouseEnterDelay",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcMouseLeaveDelay",{get:function(){return this._mcMouseLeaveDelay},set:function(e){this._mcMouseLeaveDelay=e,this.updateCompValue("mcMouseLeaveDelay",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcTrigger",{get:function(){return this._mcTrigger},set:function(e){e?(this._mcTrigger=e,this.updateCompValue("mcTrigger",e)):this._mcTrigger="hover"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcPopoverSize",{get:function(){return this.popoverSize},set:function(e){!e||"small"!==e&&"normal"!==e&&"large"!==e?this.popoverSize="normal":(this.popoverSize=e,this.updateCompValue("mcPopoverSize",e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcPlacement",{get:function(){return this._mcPlacement},set:function(e){e?(this._mcPlacement=e,this.updateCompValue("mcPlacement",e)):this._mcPlacement="top"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this._classList},set:function(e){this._classList=e,this.updateCompValue("classList",this._classList)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcVisible",{get:function(){return this._mcVisible},set:function(e){var t=i.coerceBooleanProperty(e);this._mcVisible=t,this.updateCompValue("mcVisible",t),t?this.show():this.hide()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.isPopoverOpen},enumerable:!0,configurable:!0}),e.prototype.createOverlay=function(){var e=this;if(this.overlayRef)return this.overlayRef;var t=this.overlay.position().flexibleConnectedTo(this.elementRef).withTransformOriginOn(".mc-popover").withFlexibleDimensions(!1).withViewportMargin(8).withPositions(a.EXTENDED_OVERLAY_POSITIONS.slice()),o=this.scrollDispatcher.getAncestorScrollContainers(this.elementRef);return t.withScrollableContainers(o),t.positionChanges.pipe(l.takeUntil(this.destroyed)).subscribe(function(t){e.popover&&(e.onPositionChange(t),t.scrollableViewProperties.isOverlayClipped&&e.popover.mcVisible&&e.ngZone.run(function(){return e.hide()}))}),this.overlayRef=this.overlay.create({direction:this.direction,positionStrategy:t,panelClass:"mc-popover__panel",scrollStrategy:this.scrollStrategy()}),this.updatePosition(),this.overlayRef.detachments().pipe(l.takeUntil(this.destroyed)).subscribe(function(){return e.detach()}),this.overlayRef},e.prototype.detach=function(){this.overlayRef&&this.overlayRef.hasAttached()&&this.popover&&(this.overlayRef.detach(),this.popover=null)},e.prototype.onPositionChange=function(e){var t=this,o=this.mcPlacement;Object.keys(this.availablePositions).some(function(i){return e.connectionPair.originX===t.availablePositions[i].originX&&e.connectionPair.originY===t.availablePositions[i].originY&&e.connectionPair.overlayX===t.availablePositions[i].overlayX&&e.connectionPair.overlayY===t.availablePositions[i].overlayY&&(o=i,!0)}),this.updateCompValue("mcPlacement",o),this.popover&&(this.updateCompValue("classList",this.classList),this.popover.markForCheck()),this.handlePositionUpdate()},e.prototype.handlePositionUpdate=function(){this.overlayRef||(this.overlayRef=this.createOverlay());var e=this.hostView.element.nativeElement.clientHeight/2,t=this.hostView.element.nativeElement.clientWidth;if("rightTop"===this.mcPlacement||"leftTop"===this.mcPlacement){var o=this.overlayRef.overlayElement.style.top||"0px";this.overlayRef.overlayElement.style.top=parseInt(o.split("px")[0],10)+e-20+"px"}if("rightBottom"===this.mcPlacement||"leftBottom"===this.mcPlacement){var o=this.overlayRef.overlayElement.style.bottom||"0px";this.overlayRef.overlayElement.style.bottom=parseInt(o.split("px")[0],10)+e-22+"px"}if(("topRight"===this.mcPlacement||"bottomRight"===this.mcPlacement)&&t<40){var o=this.overlayRef.overlayElement.style.right||"0px";this.overlayRef.overlayElement.style.right=parseInt(o.split("px")[0],10)-18+"px"}if(("topLeft"===this.mcPlacement||"bottomLeft"===this.mcPlacement)&&t<40){var o=this.overlayRef.overlayElement.style.left||"0px";this.overlayRef.overlayElement.style.left=parseInt(o.split("px")[0],10)-20+"px"}},e.prototype.updateCompValue=function(e,t){this.isDynamicPopover&&t&&this.popover&&(this.popover[e]=t)},e.prototype.ngOnInit=function(){this.initElementRefListeners()},e.prototype.ngOnDestroy=function(){var e=this;this.overlayRef&&this.overlayRef.dispose(),this.manualListeners.forEach(function(t,o){return e.elementRef.nativeElement.removeEventListener(o,t)}),this.manualListeners.clear(),this.$unsubscribe.next(),this.$unsubscribe.complete()},e.prototype.handleKeydown=function(e){this.isOpen&&e.keyCode===p.ESCAPE&&this.hide()},e.prototype.handleTouchend=function(){this.hide()},e.prototype.initElementRefListeners=function(){var e=this;"hover"===this.mcTrigger&&this.manualListeners.set("mouseenter",function(){return e.show()}).set("mouseleave",function(){return e.hide()}).forEach(function(t,o){return e.elementRef.nativeElement.addEventListener(o,t)}),"focus"===this.mcTrigger&&this.manualListeners.set("focus",function(){return e.show()}).set("blur",function(){return e.hide()}).forEach(function(t,o){return e.elementRef.nativeElement.addEventListener(o,t)})},e.prototype.show=function(){var e=this;if(!this.disabled){if(!this.popover){var t=this.createOverlay();this.detach(),this.portal=this.portal||new n.ComponentPortal(d,this.hostView),this.popover=t.attach(this.portal).instance,this.isDynamicPopover=!0;["mcPlacement","mcPopoverSize","mcTrigger","mcMouseEnterDelay","mcMouseLeaveDelay","classList","mcVisible","mcHeader","mcContent","mcFooter"].forEach(function(t){return e.updateCompValue(t,e[t])}),this.popover.mcVisibleChange.pipe(l.takeUntil(this.$unsubscribe),l.distinctUntilChanged()).subscribe(function(t){e.mcVisible=t,e.mcVisibleChange.emit(t),e.isPopoverOpen=t}),this.popover.afterHidden().pipe(l.takeUntil(this.destroyed)).subscribe(function(){return e.detach()})}this.updatePosition(),this.popover.show()}},e.prototype.hide=function(){this.popover&&this.popover.hide()},e.prototype.updatePosition=function(e){void 0===e&&(e=!1),this.overlayRef||(this.overlayRef=this.createOverlay());var t=this.overlayRef.getConfig().positionStrategy,o=this.getOrigin(),i=this.getOverlayPosition();t.withPositions([v({},o.main,i.main),v({},o.fallback,i.fallback)]),e&&setTimeout(function(){t.reapplyLastPosition()})},e.prototype.getOrigin=function(){var e;e={originX:this.getOriginXaxis(),originY:this.getOriginYaxis()};var t=this.invertPosition(e.originX,e.originY);return{main:e,fallback:{originX:t.x,originY:t.y}}},e.prototype.getOriginXaxis=function(){var e,t=this.mcPlacement,o=!this.direction||"ltr"===this.direction.value;if("top"===t||"bottom"===t)e="center";else if(t.toLowerCase().includes("right")&&!o||t.toLowerCase().includes("left")&&o)e="start";else{if(!(t.toLowerCase().includes("right")&&o||t.toLowerCase().includes("left")&&!o))throw u(t);e="end"}return e},e.prototype.getOriginYaxis=function(){var e,t=this.mcPlacement;if("right"===t||"left"===t)e="center";else if(t.toLowerCase().includes("top"))e="top";else{if(!t.toLowerCase().includes("bottom"))throw u(t);e="bottom"}return e},e.prototype.getOverlayPosition=function(){var e,t=this.mcPlacement;if(!this.availablePositions[t])throw u(t);e={overlayX:this.availablePositions[t].overlayX,overlayY:this.availablePositions[t].overlayY};var o=this.invertPosition(e.overlayX,e.overlayY);return{main:e,fallback:{overlayX:o.x,overlayY:o.y}}},e.prototype.invertPosition=function(e,t){var o=e,i=t;return"top"===this.mcPlacement||"bottom"===this.mcPlacement?"top"===t?i="bottom":"bottom"===t&&(i="top"):"end"===e?o="start":"start"===e&&(o="end"),{x:o,y:i}},e.decorators=[{type:s.Directive,args:[{selector:"[mcPopover]",exportAs:"mcPopover",host:{"(keydown)":"handleKeydown($event)","(touchend)":"handleTouchend()","[class.mc-popover_open]":"isOpen"}}]}],e.ctorParameters=function(){return[{type:r.Overlay},{type:s.ElementRef},{type:s.NgZone},{type:r.ScrollDispatcher},{type:s.ViewContainerRef},{type:void 0,decorators:[{type:s.Inject,args:[f]}]},{type:o.Directionality,decorators:[{type:s.Optional}]}]},e.propDecorators={mcVisibleChange:[{type:s.Output,args:["mcPopoverVisibleChange"]}],mcHeader:[{type:s.Input,args:["mcPopoverHeader"]}],mcContent:[{type:s.Input,args:["mcPopoverContent"]}],mcFooter:[{type:s.Input,args:["mcPopoverFooter"]}],disabled:[{type:s.Input,args:["mcPopoverDisabled"]}],mcMouseEnterDelay:[{type:s.Input,args:["mcPopoverMouseEnterDelay"]}],mcMouseLeaveDelay:[{type:s.Input,args:["mcPopoverMouseLeaveDelay"]}],mcTrigger:[{type:s.Input,args:["mcPopoverTrigger"]}],mcPopoverSize:[{type:s.Input,args:["mcPopoverSize"]}],mcPlacement:[{type:s.Input,args:["mcPopoverPlacement"]}],classList:[{type:s.Input,args:["mcPopoverClass"]}],mcVisible:[{type:s.Input,args:["mcPopoverVisible"]}]},e}(),P=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{declarations:[d,b],exports:[d,b],imports:[m.CommonModule,r.OverlayModule],providers:[y],entryComponents:[d]}]}],e}();e.McPopoverModule=P,e.mcPopoverScrollStrategyFactory=h,e.getMcPopoverInvalidPositionError=u,e.McPopoverComponent=d,e.MC_POPOVER_SCROLL_STRATEGY=f,e.MC_POPOVER_SCROLL_STRATEGY_FACTORY_PROVIDER=y,e.McPopover=b,e.mcPopoverAnimations=g,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-popover.umd.min.js.map

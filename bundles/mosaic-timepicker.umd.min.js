/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("@ptsecurity/cdk/coercion"),require("@ptsecurity/mosaic/core"),require("@ptsecurity/mosaic/form-field"),require("@angular/common"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/cdk/platform")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/timepicker",["exports","@angular/core","@angular/forms","rxjs","@ptsecurity/cdk/coercion","@ptsecurity/mosaic/core","@ptsecurity/mosaic/form-field","@angular/common","@ptsecurity/cdk/a11y","@ptsecurity/cdk/platform"],t):t((e.ng=e.ng||{},e.ng.mosaic=e.ng.mosaic||{},e.ng.mosaic.timepicker={}),e.ng.core,e.ng.forms,e.rxjs,e.ng.cdk.coercion,e.ng.mosaic.core,e.ng.mosaic.formField,e.ng.common,e.ng.cdk.a11y,e.ng.cdk.platform)}(this,function(e,t,n,i,r,o,s,a,u,m){"use strict";function c(e,t){function n(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function p(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function l(e,t){return function(n,i){t(n,i,e)}}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};!function(e){e[e.hours=0]="hours",e[e.minutes=1]="minutes",e[e.seconds=2]="seconds"}(e.TimeParts||(e.TimeParts={})),function(e){e.HHmmss="HH:mm:ss",e.HHmm="HH:mm"}(e.TimeFormats||(e.TimeFormats={}));var f={"hh:mm:ss":"  :  :  ","hh:mm":"  :  "},g=e.TimeFormats.HHmm,_=new RegExp(/^([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]|[0-9]):([0-5][0-9]|[0-9])?$/),y=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]|[0-9])?$/,T=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):?$/,v=0,E=i.noop,O=function(){return null},C=O,P=new t.InjectionToken("MC_INPUT_VALUE_ACCESSOR"),R=function(){function e(e,t,n,i){this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=n,this.ngControl=i}return e}(),b=o.mixinErrorState(R),S={validate:function(e){return O?O(e):null},registerOnValidatorChange:function(e){E=e}},D=function(a){function u(e,t,r,o,s,u,m){var c=a.call(this,s,r,o,t)||this;return c._elementRef=e,c.ngControl=t,c._renderer=m,c.focused=!1,c.stateChanges=new i.Subject,c.controlType="mc-timepicker",c._uid="mc-timepicker-"+v++,c._minTime=null,c._maxTime=null,c._inputValueAccessor=u||c._elementRef.nativeElement,c._previousNativeValue=c.value,c._onChange=i.noop,c.id=c.id,c.ngControl&&(c.ngControl.valueAccessor=c),O=n.Validators.compose([function(){return c._parseValidator()},function(){return c._minTimeValidator()},function(){return c._maxTimeValidator()}]),c}c(u,a),m=u,Object.defineProperty(u.prototype,"disabled",{get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(e){this._disabled=r.coerceBooleanProperty(e),this.focused&&(this.focused=!1),this.stateChanges.next()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e||this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"required",{get:function(){return this._required},set:function(e){this._required=r.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"value",{get:function(){return this._inputValueAccessor.value},set:function(e){e!==this.value&&(this._inputValueAccessor.value=e,this._applyInputChanges())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(t){this._timeFormat=Object.keys(e.TimeFormats).map(function(t){return e.TimeFormats[t]}).indexOf(t)>-1?t:g,E(),this.placeholder=f[this._timeFormat.toLowerCase()]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"minTime",{get:function(){return this._minTime},set:function(e){this._minTime=e,this._minDTime=null!==e?this._getDateFromTimeString(e):void 0,E()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"maxTime",{get:function(){return this._maxTime},set:function(e){this._maxTime=e,this._maxDTime=null!==e?this._getDateFromTimeString(e):void 0,E()},enumerable:!0,configurable:!0}),u.prototype.ngOnChanges=function(){this.stateChanges.next()},u.prototype.ngOnDestroy=function(){this.stateChanges.complete()},u.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()},u.prototype.focus=function(){this._elementRef.nativeElement.focus()},u.prototype.focusChanged=function(e){e!==this.focused&&(this.focused=e,this._onTouched(),this.stateChanges.next())},u.prototype.onBlur=function(){this._applyInputChanges(),this.focusChanged(!1)},u.prototype.onInput=function(){var e=this._elementRef.nativeElement.selectionStart,t=this._elementRef.nativeElement.selectionEnd,n=!1,i=this._getParsedTimeParts(this._elementRef.nativeElement.value),r=i.hoursOnly,o=i.hoursAndMinutes,s=i.hoursAndMinutesAndSeconds;r&&r[1]&&2===r[1].length?n=!0:o&&1===o[1].length&&o[2]&&2===o[2].length?n=!0:s&&2===s[1].length&&2===s[2].length&&s[3]&&2===s[3].length&&(n=!0),this._applyInputChanges({doTimestringReformat:n}),this._elementRef.nativeElement.selectionStart=e,this._elementRef.nativeElement.selectionEnd=t,n&&null===this.ngControl.errors&&this._createSelectionOfTimeComponentInInput(e+1)},Object.defineProperty(u.prototype,"empty",{get:function(){return!this._elementRef.nativeElement.value&&!this._isBadInput()},enumerable:!0,configurable:!0}),u.prototype.onContainerClick=function(){this.focus()},u.prototype.writeValue=function(e){null!==e&&this._renderer.setProperty(this._elementRef.nativeElement,"value",this._getTimeStringFromDate(e,this.timeFormat)),this._onChange(e||null),this._applyInputChanges()},u.prototype.onKeyDown=function(e){var t=this._getKeyCode(e);"ArrowUp"!==t&&"ArrowDown"!==t||this._upDownTimeByArrowKeys(e),"ArrowLeft"!==t&&"ArrowRight"!==t||this._switchSelectionBetweenTimeparts(e)},u.prototype.registerOnChange=function(e){this._onChange=e},u.prototype.registerOnTouched=function(e){this._onTouched=e},u.prototype._dirtyCheckNativeValue=function(){var e=this.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())},u.prototype._isBadInput=function(){var e=this._elementRef.nativeElement.validity;return e&&e.badInput},u.prototype._applyInputChanges=function(e){void 0===e&&(e={});var t=e.changedTime,n=e.doTimestringReformat,i=void 0===n||n,r=t||this._getDateFromTimeString(this._elementRef.nativeElement.value);this._currentDTimeInput=r,i&&void 0!==r&&this._renderer.setProperty(this._elementRef.nativeElement,"value",this._getTimeStringFromDate(r,this.timeFormat)),this.ngControl.control.updateValueAndValidity();var o=null===this.ngControl.errors&&void 0!==r?r:null;this._onChange(o),this.stateChanges.next()},u.prototype._upDownTimeByArrowKeys=function(e){e.preventDefault();var t=this._currentDTimeInput;if(void 0!==t){var n=this._elementRef.nativeElement.selectionStart,i=this._getTimeEditMetrics(n).modifiedTimePart,r=this._getKeyCode(e);"ArrowUp"===r&&(t=this._incrementTime(t,i)),"ArrowDown"===r&&(t=this._decrementTime(t,i)),this._applyInputChanges({changedTime:t}),this._createSelectionOfTimeComponentInInput(n)}},u.prototype._switchSelectionBetweenTimeparts=function(e){var t=this._currentDTimeInput,n=this._getKeyCode(e);if(void 0!==t){var i=this._elementRef.nativeElement.selectionStart;"ArrowLeft"===n?i=this._getCursorPositionOfPrevTimePartStart(i,this._elementRef.nativeElement.value):"ArrowRight"===n&&(i=this._getCursorPositionOfNextTimePartStart(i,this._elementRef.nativeElement.value)),this._createSelectionOfTimeComponentInInput(i)}},u.prototype._getKeyCode=function(e){return e.code||e.key},u.prototype._createSelectionOfTimeComponentInInput=function(e){var t=this;setTimeout(function(){var n=t._getTimeEditMetrics(e);t._elementRef.nativeElement.selectionStart=n.cursorStartPosition,t._elementRef.nativeElement.selectionEnd=n.cursorEndPosition})},u.prototype._incrementTime=function(t,n){void 0===n&&(n=e.TimeParts.seconds);var i=this._getTimeDigitsFromDate(t),r=i.hours,o=i.minutes,s=i.seconds;switch(n){case e.TimeParts.hours:r++;break;case e.TimeParts.minutes:o++;break;case e.TimeParts.seconds:s++}return s>59&&(s=0),o>59&&(o=0),r>23&&(r=0),this._getDateFromTimeDigits(r,o,s)},u.prototype._decrementTime=function(t,n){void 0===n&&(n=e.TimeParts.seconds);var i=this._getTimeDigitsFromDate(t),r=i.hours,o=i.minutes,s=i.seconds;switch(n){case e.TimeParts.hours:r--;break;case e.TimeParts.minutes:o--;break;case e.TimeParts.seconds:s--}return s<0&&(s=59),o<0&&(o=59),r<0&&(r=23),this._getDateFromTimeDigits(r,o,s)},u.prototype._getCursorPositionOfPrevTimePartStart=function(e,t){return 0===e?t.length:e-1},u.prototype._getCursorPositionOfNextTimePartStart=function(e,t,n){void 0===n&&(n=":");var i=t.indexOf(n,e);return void 0!==i?i+1:0},u.prototype._getTimeEditMetrics=function(t){var n,i,r,o=this._elementRef.nativeElement.value,s=o.indexOf(":",1),a=-1!==s?o.indexOf(":",s+1):-1;return-1!==a&&t>a?(n=e.TimeParts.seconds,i=a+1,r=o.length):-1!==s&&t>s?(n=e.TimeParts.minutes,i=s+1,r=a>-1?a:o.length):(n=e.TimeParts.hours,i=0,r=-1!==s?s:o.length),{modifiedTimePart:n,cursorStartPosition:i,cursorEndPosition:r}},u.prototype._getTimeStringFromDate=function(t,n){void 0===n&&(n=g);var i,r=this._getNumberWithLeadingZero(t.getHours()),o=this._getNumberWithLeadingZero(t.getMinutes()),s=this._getNumberWithLeadingZero(t.getSeconds());return(i={},i[e.TimeFormats.HHmm]=function(){return r+":"+o},i[e.TimeFormats.HHmmss]=function(){return r+":"+o+":"+s},i)[n]()},u.prototype._getParsedTimeParts=function(e){var t=e.match(_),n=e.match(y);return{hoursOnly:e.match(T),hoursAndMinutes:n,hoursAndMinutesAndSeconds:t}},u.prototype._getDateFromTimeDigits=function(e,t,n){return void 0===n&&(n=0),this._getDateFromTimeString(e+":"+t+":"+n)},u.prototype._getDateFromTimeString=function(e){if(void 0!==e){var t=this._getParsedTimeParts(e),n=t.hoursOnly,i=t.hoursAndMinutes,r=t.hoursAndMinutesAndSeconds;if(0!==e.trim().length&&(null!==n||null!==i||null!==r)){var o=0,s=0,a=0;n?o=Number(n[1]):i?(o=Number(i[1]),s=Number(i[2])):r&&(o=Number(r[1]),s=Number(r[2]),a=Number(r[3]));var u=new Date(1970,0,1,o,s,a);return isNaN(u.getTime())?void 0:u}}},u.prototype._getNumberWithLeadingZero=function(e){return e>9?""+e:"0"+e},u.prototype._getTimeDigitsFromDate=function(e){return{hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}},u.prototype._parseValidator=function(){return void 0===this._currentDTimeInput?{mcTimepickerParse:{text:this._elementRef.nativeElement.value}}:null},u.prototype._minTimeValidator=function(){return void 0!==this._currentDTimeInput&&void 0!==this._minDTime&&this._isTimeLowerThenMin(this._currentDTimeInput)?{mcTimepickerLowerThenMintime:{text:this._elementRef.nativeElement.value}}:null},u.prototype._maxTimeValidator=function(){return void 0!==this._currentDTimeInput&&void 0!==this._maxDTime&&this._isTimeGreaterThenMax(this._currentDTimeInput)?{mcTimepickerHigherThenMaxtime:{text:this._elementRef.nativeElement.value}}:null},u.prototype._isTimeLowerThenMin=function(e){return e.getTime()-this._minDTime.getTime()<0},u.prototype._isTimeGreaterThenMax=function(e){return e.getTime()-this._maxDTime.getTime()>=0};var m;return p([t.Input(),h("design:type",o.ErrorStateMatcher)],u.prototype,"errorStateMatcher",void 0),p([t.Input(),h("design:type",Boolean),h("design:paramtypes",[Boolean])],u.prototype,"disabled",null),p([t.Input(),h("design:type",String),h("design:paramtypes",[String])],u.prototype,"id",null),p([t.Input(),h("design:type",String)],u.prototype,"placeholder",void 0),p([t.Input(),h("design:type",Boolean),h("design:paramtypes",[Boolean])],u.prototype,"required",null),p([t.Input(),h("design:type",String),h("design:paramtypes",[String])],u.prototype,"value",null),p([t.Input("time-format"),h("design:type",String),h("design:paramtypes",[String])],u.prototype,"timeFormat",null),p([t.Input("min-time"),h("design:type",Object),h("design:paramtypes",[Object])],u.prototype,"minTime",null),p([t.Input("max-time"),h("design:type",Object),h("design:paramtypes",[Object])],u.prototype,"maxTime",null),u=m=p([t.Directive({selector:"input[mcTimepicker]",exportAs:"mcTimepickerInput",host:{class:"mc-timepicker mc-input","[attr.id]":"id","[attr.placeholder]":"placeholder","[disabled]":"disabled","[required]":"required","[attr.time-format]":"timeFormat","[attr.min-time]":"minTime","[attr.max-time]":"maxTime","[attr.value]":"value","(blur)":"onBlur()","(focus)":"focusChanged(true)","(input)":"onInput()","(keydown)":"onKeyDown($event)"},providers:[{provide:n.NG_VALIDATORS,useValue:S,multi:!0},{provide:s.McFormFieldControl,useExisting:t.forwardRef(function(){return m})}]}),l(1,t.Optional()),l(1,t.Self()),l(2,t.Optional()),l(3,t.Optional()),l(5,t.Optional()),l(5,t.Self()),l(5,t.Inject(P)),h("design:paramtypes",[t.ElementRef,n.NgControl,n.NgForm,n.FormGroupDirective,o.ErrorStateMatcher,Object,t.Renderer2])],u)}(b),I=function(){function e(){}return e=p([t.NgModule({imports:[a.CommonModule,u.A11yModule,m.PlatformModule,n.FormsModule],declarations:[D],exports:[D]})],e)}();e.McTimepickerModule=I,e.TIMEFORMAT_PLACEHOLDERS=f,e.DEFAULT_TIME_FORMAT=g,e.HOURS_MINUTES_SECONDS_REGEXP=_,e.HOURS_MINUTES_REGEXP=y,e.HOURS_ONLY_REGEXP=T,e.SECONDS_PER_MINUTE=59,e.MINUTES_PER_HOUR=59,e.HOURS_PER_DAY=23,e.ARROW_UP_KEYCODE="ArrowUp",e.ARROW_DOWN_KEYCODE="ArrowDown",e.ARROW_LEFT_KEYCODE="ArrowLeft",e.ARROW_RIGHT_KEYCODE="ArrowRight",e.MC_INPUT_VALUE_ACCESSOR=P,e.McTimepickerBase=R,e.McTimepickerMixinBase=b,e.McTimepicker=D,e.ɵ0=C,e.ɵ1=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-timepicker.umd.min.js.map

/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@ptsecurity/cdk/coercion"),require("@ptsecurity/mosaic/core"),require("@ptsecurity/mosaic/form-field"),require("@ptsecurity/mosaic/input"),require("rxjs"),require("@angular/common"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/cdk/platform")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/timepicker",["exports","@angular/core","@angular/forms","@ptsecurity/cdk/coercion","@ptsecurity/mosaic/core","@ptsecurity/mosaic/form-field","@ptsecurity/mosaic/input","rxjs","@angular/common","@ptsecurity/cdk/a11y","@ptsecurity/cdk/platform"],t):t((e.ng=e.ng||{},e.ng.mosaic=e.ng.mosaic||{},e.ng.mosaic.timepicker={}),e.ng.core,e.ng.forms,e.ng.cdk.coercion,e.ng.mosaic.core,e.ng.mosaic.formField,e.ng.mosaic.input,e.rxjs,e.ng.common,e.ng.cdk.a11y,e.ng.cdk.platform)}(this,function(e,t,i,n,r,o,s,a,u,m,c){"use strict";function p(e,t){function i(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function l(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function h(e,t){return function(i,n){t(i,n,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var f,g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};!function(e){e[e.hours=0]="hours",e[e.minutes=1]="minutes",e[e.seconds=2]="seconds"}(e.TimeParts||(e.TimeParts={})),function(e){e.HHmmss="HH:mm:ss",e.HHmm="HH:mm"}(e.TimeFormats||(e.TimeFormats={}));var y=(f={},f[e.TimeFormats.HHmmss]="  :  :  ",f[e.TimeFormats.HHmm]="  :  ",f),T=e.TimeFormats.HHmm,v=new RegExp(/^([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]|[0-9]):([0-5][0-9]|[0-9])?$/),E=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]|[0-9])?$/,O=/^([0-9]|0[0-9]|1[0-9]|2[0-3]):?$/,R=0,P=a.noop,b=function(){return null},C=b,S=function(){function e(e,t,i,n){this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=i,this.ngControl=n}return e}(),D=r.mixinErrorState(S),_={validate:function(e){return b?b(e):null},registerOnValidatorChange:function(e){P=e}},I=function(u){function m(e,t,n,r,o,s,m){var c=u.call(this,o,n,r,t)||this;return c.elementRef=e,c.ngControl=t,c.renderer=m,c.focused=!1,c.stateChanges=new a.Subject,c.controlType="mc-timepicker",c.uid="mc-timepicker-"+R++,c._minTime=null,c._maxTime=null,c.inputValueAccessor=s||c.elementRef.nativeElement,c.previousNativeValue=c.value,c.onChange=a.noop,c.id=c.id,c.placeholder=y[T],c.ngControl&&(c.ngControl.valueAccessor=c),b=i.Validators.compose([function(){return c.parseValidator()},function(){return c.minTimeValidator()},function(){return c.maxTimeValidator()}]),c}p(m,u),c=m,Object.defineProperty(m.prototype,"disabled",{get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(e){this._disabled=n.coerceBooleanProperty(e),this.focused&&(this.focused=!1),this.stateChanges.next()},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e||this.uid},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"required",{get:function(){return this._required},set:function(e){this._required=n.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"value",{get:function(){return this.inputValueAccessor.value},set:function(e){e!==this.value&&(this.inputValueAccessor.value=e,this.applyInputChanges())},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(t){this._timeFormat=Object.keys(e.TimeFormats).map(function(t){return e.TimeFormats[t]}).indexOf(t)>-1?t:T,P(),this.placeholder=y[this._timeFormat]},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"minTime",{get:function(){return this._minTime},set:function(e){this._minTime=e,this.minDateTime=null!==e?this.getDateFromTimeString(e):void 0,P()},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"maxTime",{get:function(){return this._maxTime},set:function(e){this._maxTime=e,this.maxDateTime=null!==e?this.getDateFromTimeString(e):void 0,P()},enumerable:!0,configurable:!0}),m.prototype.ngOnChanges=function(){this.stateChanges.next()},m.prototype.ngOnDestroy=function(){this.stateChanges.complete()},m.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState(),this.dirtyCheckNativeValue()},m.prototype.focus=function(){this.elementRef.nativeElement.focus()},m.prototype.focusChanged=function(e){e!==this.focused&&(this.focused=e,this.onTouched(),this.stateChanges.next())},m.prototype.onBlur=function(){this.applyInputChanges(),this.focusChanged(!1)},m.prototype.onPaste=function(e){e.preventDefault();var t=e.clipboardData.getData("text");void 0!==this.getDateFromTimeString(t)&&(this.elementRef.nativeElement.value=t,this.onInput())},m.prototype.onInput=function(){var e=this.elementRef.nativeElement.selectionStart,t=this.elementRef.nativeElement.selectionEnd,i=!1,n=this.getParsedTimeParts(this.elementRef.nativeElement.value),r=n.hoursOnly,o=n.hoursAndMinutes,s=n.hoursAndMinutesAndSeconds;r&&r[1]&&2===r[1].length?i=!0:o&&1===o[1].length&&o[2]&&2===o[2].length?i=!0:s&&2===s[1].length&&2===s[2].length&&s[3]&&2===s[3].length&&(i=!0),this.applyInputChanges({doTimestringReformat:i}),this.elementRef.nativeElement.selectionStart=e,this.elementRef.nativeElement.selectionEnd=t,i&&null===this.ngControl.errors&&this.createSelectionOfTimeComponentInInput(e+1)},Object.defineProperty(m.prototype,"empty",{get:function(){return!this.elementRef.nativeElement.value&&!this.isBadInput()},enumerable:!0,configurable:!0}),m.prototype.onContainerClick=function(){this.focus()},m.prototype.writeValue=function(e){null!==e&&this.renderer.setProperty(this.elementRef.nativeElement,"value",this.getTimeStringFromDate(e,this.timeFormat)),this.onChange(e||null),this.applyInputChanges()},m.prototype.onKeyDown=function(e){var t=this.getKeyCode(e);"ArrowUp"!==t&&"ArrowDown"!==t||this.upDownTimeByArrowKeys(e),"ArrowLeft"!==t&&"ArrowRight"!==t||this.switchSelectionBetweenTimeparts(e)},m.prototype.registerOnChange=function(e){this.onChange=e},m.prototype.registerOnTouched=function(e){this.onTouched=e},m.prototype.dirtyCheckNativeValue=function(){var e=this.value;this.previousNativeValue!==e&&(this.previousNativeValue=e,this.stateChanges.next())},m.prototype.isBadInput=function(){var e=this.elementRef.nativeElement.validity;return e&&e.badInput},m.prototype.applyInputChanges=function(e){void 0===e&&(e={});var t=e.changedTime,i=e.doTimestringReformat,n=void 0===i||i,r=t||this.getDateFromTimeString(this.elementRef.nativeElement.value);if(this.currentDateTimeInput=r,n&&void 0!==r){var o=this.elementRef.nativeElement.selectionStart,s=this.elementRef.nativeElement.selectionEnd;this.renderer.setProperty(this.elementRef.nativeElement,"value",this.getTimeStringFromDate(r,this.timeFormat)),this.elementRef.nativeElement.selectionStart=o,this.elementRef.nativeElement.selectionEnd=s}this.ngControl.control.updateValueAndValidity();var a=null===this.ngControl.errors&&void 0!==r?r:null;this.onChange(a),this.stateChanges.next()},m.prototype.upDownTimeByArrowKeys=function(e){e.preventDefault();var t=this.currentDateTimeInput;if(void 0!==t){var i=this.elementRef.nativeElement.selectionStart,n=this.getTimeEditMetrics(i).modifiedTimePart,r=this.getKeyCode(e);"ArrowUp"===r&&(t=this.incrementTime(t,n)),"ArrowDown"===r&&(t=this.decrementTime(t,n)),this.applyInputChanges({changedTime:t}),this.createSelectionOfTimeComponentInInput(i)}},m.prototype.switchSelectionBetweenTimeparts=function(e){var t=this.currentDateTimeInput,i=this.getKeyCode(e);if(void 0!==t){var n=this.elementRef.nativeElement.selectionStart;"ArrowLeft"===i?n=this.getCursorPositionOfPrevTimePartStart(n,this.elementRef.nativeElement.value):"ArrowRight"===i&&(n=this.getCursorPositionOfNextTimePartStart(n,this.elementRef.nativeElement.value)),this.createSelectionOfTimeComponentInInput(n)}},m.prototype.getKeyCode=function(e){return e.code||e.key},m.prototype.createSelectionOfTimeComponentInInput=function(e){var t=this;setTimeout(function(){var i=t.getTimeEditMetrics(e);t.elementRef.nativeElement.selectionStart=i.cursorStartPosition,t.elementRef.nativeElement.selectionEnd=i.cursorEndPosition})},m.prototype.incrementTime=function(t,i){void 0===i&&(i=e.TimeParts.seconds);var n=this.getTimeDigitsFromDate(t),r=n.hours,o=n.minutes,s=n.seconds;switch(i){case e.TimeParts.hours:r++;break;case e.TimeParts.minutes:o++;break;case e.TimeParts.seconds:s++}return s>59&&(s=0),o>59&&(o=0),r>23&&(r=0),this.getDateFromTimeDigits(r,o,s)},m.prototype.decrementTime=function(t,i){void 0===i&&(i=e.TimeParts.seconds);var n=this.getTimeDigitsFromDate(t),r=n.hours,o=n.minutes,s=n.seconds;switch(i){case e.TimeParts.hours:r--;break;case e.TimeParts.minutes:o--;break;case e.TimeParts.seconds:s--}return s<0&&(s=59),o<0&&(o=59),r<0&&(r=23),this.getDateFromTimeDigits(r,o,s)},m.prototype.getCursorPositionOfPrevTimePartStart=function(e,t){return 0===e?t.length:e-1},m.prototype.getCursorPositionOfNextTimePartStart=function(e,t,i){void 0===i&&(i=":");var n=t.indexOf(i,e);return void 0!==n?n+1:0},m.prototype.getTimeEditMetrics=function(t){var i,n,r,o=this.elementRef.nativeElement.value,s=o.indexOf(":",1),a=-1!==s?o.indexOf(":",s+1):-1;return-1!==a&&t>a?(i=e.TimeParts.seconds,n=a+1,r=o.length):-1!==s&&t>s?(i=e.TimeParts.minutes,n=s+1,r=a>-1?a:o.length):(i=e.TimeParts.hours,n=0,r=-1!==s?s:o.length),{modifiedTimePart:i,cursorStartPosition:n,cursorEndPosition:r}},m.prototype.getTimeStringFromDate=function(t,i){void 0===i&&(i=T);var n,r=this.getNumberWithLeadingZero(t.getHours()),o=this.getNumberWithLeadingZero(t.getMinutes()),s=this.getNumberWithLeadingZero(t.getSeconds());return(n={},n[e.TimeFormats.HHmm]=function(){return r+":"+o},n[e.TimeFormats.HHmmss]=function(){return r+":"+o+":"+s},n)[i]()},m.prototype.getParsedTimeParts=function(e){var t=e.match(v),i=e.match(E);return{hoursOnly:e.match(O),hoursAndMinutes:i,hoursAndMinutesAndSeconds:t}},m.prototype.getDateFromTimeDigits=function(e,t,i){return void 0===i&&(i=0),this.getDateFromTimeString(e+":"+t+":"+i)},m.prototype.getDateFromTimeString=function(e){if(void 0!==e){var t=this.getParsedTimeParts(e),i=t.hoursOnly,n=t.hoursAndMinutes,r=t.hoursAndMinutesAndSeconds;if(0!==e.trim().length&&(null!==i||null!==n||null!==r)){var o=0,s=0,a=0;i?o=Number(i[1]):n?(o=Number(n[1]),s=Number(n[2])):r&&(o=Number(r[1]),s=Number(r[2]),a=Number(r[3]));var u=new Date(1970,0,1,o,s,a);return isNaN(u.getTime())?void 0:u}}},m.prototype.getNumberWithLeadingZero=function(e){return e>9?""+e:"0"+e},m.prototype.getTimeDigitsFromDate=function(e){return{hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}},m.prototype.parseValidator=function(){return void 0===this.currentDateTimeInput?{mcTimepickerParse:{text:this.elementRef.nativeElement.value}}:null},m.prototype.minTimeValidator=function(){return void 0!==this.currentDateTimeInput&&void 0!==this.minDateTime&&this.isTimeLowerThenMin(this.currentDateTimeInput)?{mcTimepickerLowerThenMintime:{text:this.elementRef.nativeElement.value}}:null},m.prototype.maxTimeValidator=function(){return void 0!==this.currentDateTimeInput&&void 0!==this.maxDateTime&&this.isTimeGreaterThenMax(this.currentDateTimeInput)?{mcTimepickerHigherThenMaxtime:{text:this.elementRef.nativeElement.value}}:null},m.prototype.isTimeLowerThenMin=function(e){return e.getTime()-this.minDateTime.getTime()<0},m.prototype.isTimeGreaterThenMax=function(e){return e.getTime()-this.maxDateTime.getTime()>=0};var c;return l([t.Input(),d("design:type",r.ErrorStateMatcher)],m.prototype,"errorStateMatcher",void 0),l([t.Input(),d("design:type",Boolean),d("design:paramtypes",[Boolean])],m.prototype,"disabled",null),l([t.Input(),d("design:type",String),d("design:paramtypes",[String])],m.prototype,"id",null),l([t.Input(),d("design:type",String)],m.prototype,"placeholder",void 0),l([t.Input(),d("design:type",Boolean),d("design:paramtypes",[Boolean])],m.prototype,"required",null),l([t.Input(),d("design:type",String),d("design:paramtypes",[String])],m.prototype,"value",null),l([t.Input("time-format"),d("design:type",String),d("design:paramtypes",[String])],m.prototype,"timeFormat",null),l([t.Input("min-time"),d("design:type",Object),d("design:paramtypes",[Object])],m.prototype,"minTime",null),l([t.Input("max-time"),d("design:type",Object),d("design:paramtypes",[Object])],m.prototype,"maxTime",null),m=c=l([t.Directive({selector:"input[mcTimepicker]",exportAs:"mcTimepickerInput",host:{class:"mc-timepicker mc-input","[attr.id]":"id","[attr.placeholder]":"placeholder","[disabled]":"disabled","[required]":"required","[attr.time-format]":"timeFormat","[attr.min-time]":"minTime","[attr.max-time]":"maxTime","[attr.value]":"value","(blur)":"onBlur()","(focus)":"focusChanged(true)","(input)":"onInput()","(paste)":"onPaste($event)","(keydown)":"onKeyDown($event)"},providers:[{provide:i.NG_VALIDATORS,useValue:_,multi:!0},{provide:o.McFormFieldControl,useExisting:t.forwardRef(function(){return c})}]}),h(1,t.Optional()),h(1,t.Self()),h(2,t.Optional()),h(3,t.Optional()),h(5,t.Optional()),h(5,t.Self()),h(5,t.Inject(s.MC_INPUT_VALUE_ACCESSOR)),d("design:paramtypes",[t.ElementRef,i.NgControl,i.NgForm,i.FormGroupDirective,r.ErrorStateMatcher,Object,t.Renderer2])],m)}(D),A=function(){function e(){}return e=l([t.NgModule({imports:[u.CommonModule,m.A11yModule,c.PlatformModule,i.FormsModule],declarations:[I],exports:[I]})],e)}();e.McTimepickerModule=A,e.TIMEFORMAT_PLACEHOLDERS=y,e.DEFAULT_TIME_FORMAT=T,e.HOURS_MINUTES_SECONDS_REGEXP=v,e.HOURS_MINUTES_REGEXP=E,e.HOURS_ONLY_REGEXP=O,e.SECONDS_PER_MINUTE=59,e.MINUTES_PER_HOUR=59,e.HOURS_PER_DAY=23,e.ARROW_UP_KEYCODE="ArrowUp",e.ARROW_DOWN_KEYCODE="ArrowDown",e.ARROW_LEFT_KEYCODE="ArrowLeft",e.ARROW_RIGHT_KEYCODE="ArrowRight",e.McTimepickerBase=S,e.McTimepickerMixinBase=D,e.McTimepicker=I,e.ɵ0=C,e.ɵ1=_,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-timepicker.umd.min.js.map

{"version":3,"sources":["../../../packages/mosaic/datepicker/calendar-body.component.ts","../../../packages/mosaic/datepicker/datepicker-errors.ts","../../../packages/mosaic/datepicker/datepicker-intl.ts","../../../packages/mosaic/datepicker/month-view.component.ts","../../../packages/mosaic/datepicker/multi-year-view.component.ts","../../../packages/mosaic/datepicker/calendar.component.ts","../../../packages/mosaic/datepicker/year-view.component.ts","../../../node_modules/tslib/tslib.es6.js","../../../packages/mosaic/datepicker/datepicker-input.directive.ts","../../../packages/mosaic/datepicker/datepicker-toggle.component.ts","../../../packages/mosaic/datepicker/datepicker-animations.ts","../../../packages/mosaic/datepicker/datepicker.component.ts","../../../packages/mosaic/datepicker/datepicker-module.ts"],"names":["value","displayValue","ariaLabel","enabled","cssClasses","this","McCalendarBody","elementRef","ngZone","numCols","activeCell","cellAspectRatio","selectedValueChange","EventEmitter","prototype","cellClicked","cell","emit","ngOnChanges","changes","columnChanges","rows","firstRowOffset","length","cellPadding","cellWidth","isActiveCell","rowIndex","colIndex","cellNumber","focusActiveCell","_this","runOutsideAngular","onStable","asObservable","pipe","take","subscribe","nativeElement","querySelector","focus","createMissingDateImplError","provider","Error","Component","args","selector","exportAs","template","host","class","role","aria-readonly","encapsulation","ViewEncapsulation","None","changeDetection","ChangeDetectionStrategy","OnPush","ElementRef","NgZone","Input","Output","Subject","calendarLabel","openCalendarLabel","prevMonthLabel","nextMonthLabel","prevYearLabel","nextYearLabel","prevMultiYearLabel","nextMultiYearLabel","switchToMonthViewLabel","switchToMultiYearViewLabel","Injectable","providedIn","McMonthView","changeDetectorRef","dateFormats","dateAdapter","dir","selectedChange","userSelection","activeDateChange","firstDayOfWeek","getFirstDayOfWeek","narrowWeekdays","getDayOfWeekNames","weekdays","map","long","i","narrow","slice","concat","_activeDate","today","Object","defineProperty","oldActiveDate","validDate","getValidDateOrNull","deserialize","clampDate","minDate","maxDate","hasSameMonthAndYear","init","_selected","selectedDate","getDateInCurrentMonth","_minDate","_maxDate","ngAfterContentInit","dateSelected","date","selectedYear","getYear","activeDate","selectedMonth","getMonth","createDate","handleCalendarBodyKeydown","event","isRtl","keyCode","LEFT_ARROW","addCalendarDays","RIGHT_ARROW","UP_ARROW","DOWN_ARROW","HOME","getDate","END","getNumDaysInMonth","PAGE_UP","altKey","addCalendarYears","addCalendarMonths","PAGE_DOWN","ENTER","SPACE","dateFilter","preventDefault","compareDate","selected","todayDate","monthLabel","getMonthNames","toLocaleUpperCase","substr","firstOfMonth","firstWeekOffset","getDayOfWeek","createWeekCells","markForCheck","mcCalendarBody","daysInMonth","dateNames","getDateNames","weeks","push","shouldEnableDate","format","dateA11yLabel","cellClasses","dateClass","undefined","McCalendarCell","d1","d2","obj","isDateInstance","isValid","ChangeDetectorRef","Optional","type","Inject","MC_DATE_FORMATS","DateAdapter","decorators","Directionality","ViewChild","static","yearsPerPage","McMultiYearView","yearSelected","Math","floor","todayYear","activeYear","activeOffset","years","row","year","createCellForYear","onYearSelected","month","min","getActiveCell","yearName","getYearName","shouldEnableYear","McCalendarView","McYearView","monthSelected","getMonthInCurrentYear","onMonthSelected","normalizedDate","todayMonth","yearLabel","monthNames","months","createCellForMonth","monthName","monthYearA11yLabel","newMonthName","shouldEnableMonth","isYearAndMonthAfterMaxDate","isYearAndMonthBeforeMinDate","maxYear","maxMonth","minYear","minMonth","McCalendarHeader","intl","calendar","stateChanges","currentView","Month","label","monthYearLabel","replace","Year","_a","MultiYear","currentPeriodClicked","includes","previousClicked","nextClicked","previousEnabled","isSameView","nextEnabled","firstDate","secondDate","firstYear","secondYear","firstMonth","secondMonth","McDatepickerIntl","McCalendar","forwardRef","startView","moveFocusOnNextTick","intlChanges","next","_startAt","clampedActiveDate","_currentView","calendarHeaderPortal","ComponentPortal","headerComponent","startAt","ngAfterViewChecked","ngOnDestroy","unsubscribe","complete","change","firstChange","view","getCurrentViewComponent","detectChanges","updateTodaysDate","monthView","yearView","multiYearView","sameDate","yearSelectedInMultiYearView","normalizedYear","monthSelectedInYearView","normalizedMonth","userSelected","goToDateInView","create","__values","o","s","Symbol","iterator","m","call","done","TypeError","__read","n","r","e","ar","error","DateParts","DateDigit","start","maxDays","day","parse","parseDay","parseMonth","parseYear","isDay","isMonth","isYear","parsedValue","parseInt","MC_DATEPICKER_VALUE_ACCESSOR","provide","NG_VALUE_ACCESSOR","useExisting","McDatepickerInput","multi","MC_DATEPICKER_VALIDATORS","NG_VALIDATORS","target","targetElement","uniqueComponentIdSuffix","renderer","controlType","focused","valueChange","disabledChange","_disabled","incorrectInput","dateChange","dateInput","uid","datepickerSubscription","Subscription","EMPTY","localeSubscription","lastValueValid","onTouched","onInput","correctCursorPosition","formattedValue","replaceSymbols","viewValue","newTimeObj","getDateFromString","control","updateValueAndValidity","_value","setViewValue","getTimeStringFromDate","selectNextDigitByCursor","selectionStart","updateValue","parseOnBlur","getDefaultValue","viewDigits","split","separator","filter","_d","firsViewDigit","secondViewDigit","thirdViewDigit","setTimeout","firstDigit","fullName","secondDigit","thirdDigit","_e","reduce","acc","digit","index","digitWithYear","viewDigitWithYear","createDateTime","hours","minutes","seconds","milliseconds","updateLocaleParams","setFormat","cvaOnChange","validatorOnChange","parseValidator","empty","mcDatepickerParse","text","minValidator","controlValue","mcDatepickerMin","actual","maxValidator","max","mcDatepickerMax","filterValidator","mcDatepickerFilter","validator","Validators","compose","localeChanges","_required","coerceBooleanProperty","datepicker","registerInput","selectedChanged","McDatepickerInputEvent","newValue","oldDate","formatValue","_min","_max","element","blur","_id","tooltip","mcMouseEnterDelay","validationTooltipShowDelay","mcTrigger","mcTooltipClass","initElementRefListeners","isTooltipOpen","show","hide","validationTooltipHideDelay","isBadInput","readOnly","selectionEnd","onContainerClick","focusChanged","isFocused","registerOnValidatorChange","fn","validate","setControl","writeValue","registerOnChange","registerOnTouched","setDisabledState","isDisabled","disabled","onKeyDown","isReadOnly","isLetterKey","isKeyForOpen","open","isKeyForClose","close","TAB","isKeyForByPass","spaceKeyHandler","verticalArrowKeyHandler","changeCaretPosition","test","key","getNewValue","onChange","onBlur","onPaste","$event","rawValue","clipboardData","getData","match","groups","first","_b","second","_c","third","join","toISO8601","toIso8601","separatorPositions","item","arguments","__spread","getDigitPositions","ESCAPE","ctrlKey","metaKey","hasModifierKey","isVerticalMovement","isHorizontalMovement","DELETE","BACKSPACE","selectNextDigit","position","savePosition","setProperty","part","timeString","defaultValue","getHours","getMinutes","getSeconds","getMilliseconds","timeFormat","getDateEditMetrics","cursorPosition","_f","end","incrementDate","dateVal","whatToIncrement","lastDay","getLastDayFor","decrementDate","whatToDecrement","changedTime","modifiedTimePart","cursorPos","nextSeparatorPos","indexOf","selectDigitByCursor","endPositionOfCurrentDigit","cycle","lastValue","newCursorPos","validity","badInput","toLowerCase","arr","prev","Directive","providers","McFormFieldControl","[attr.placeholder]","[attr.required]","[attr.disabled]","[attr.min]","[attr.max]","[attr.autocomplete]","(paste)","(change)","(focus)","(blur)","(keydown)","Renderer2","McDatepickerToggle","watchStateChanges","stopPropagation","datepickerDisabled","observableOf","inputDisabled","datepickerInput","datepickerToggled","merge","openedStream","closedStream","[class.mc-active]","ContentChild","McDatepickerToggleIcon","mcDatepickerAnimations","transformPanel","trigger","state","style","opacity","transform","transition","animate","fadeInCalendar","Element","matches","msMatchesSelector","datepickerUid","MC_DATEPICKER_SCROLL_STRATEGY","InjectionToken","MC_DATEPICKER_SCROLL_STRATEGY_FACTORY","overlay","scrollStrategies","reposition","MC_DATEPICKER_SCROLL_STRATEGY_FACTORY_PROVIDER","deps","Overlay","useFactory","McDatepickerContent","animationDone","subscriptions","ngAfterViewInit","add","startExitAnimation","animationState","[@transformPanel]","(@transformPanel.done)","animations","McDatepicker","viewContainerRef","scrollStrategy","document","_hasBackdrop","_opened","backdropClass","id","validSelected","focusedElementBeforeOpen","inputSubscription","closeSubscription","destroyOverlay","select","oldValue","selectYear","selectMonth","input","popupComponentRef","instance","activeElement","openAsPopup","restoreFocus","toggle","popupRef","dispose","calendarPortal","createPopup","hasAttached","attach","updatePosition","overlayConfig","OverlayConfig","positionStrategy","createPopupPositionStrategy","hasBackdrop","direction","panelClass","closingActions","body","backdropClick","outsidePointerEvents","detachments","flexibleConnectedTo","withTransformOriginOn","withFlexibleDimensions","withViewportMargin","withLockedPosition","withPositions","originX","originY","overlayX","overlayY","ViewContainerRef","DOCUMENT","NgModule","imports","CommonModule","McButtonModule","OverlayModule","A11yModule","PortalModule","McIconModule","exports","declarations","entryComponents"],"mappings":"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","sourcesContent":["// tslint:disable:no-magic-numbers\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    ElementRef,\n    EventEmitter,\n    Input,\n    Output,\n    ViewEncapsulation,\n    NgZone,\n    OnChanges,\n    SimpleChanges\n} from '@angular/core';\nimport { take } from 'rxjs/operators';\n\n\n/**\n * Extra CSS classes that can be associated with a calendar cell.\n */\nexport type McCalendarCellCssClasses = string | string[] | Set<string> | { [key: string]: any };\n\n/**\n * An internal class that represents the data corresponding to a single calendar cell.\n * @docs-private\n */\nexport class McCalendarCell {\n    constructor(\n        public value: number,\n        public displayValue: string,\n        public ariaLabel: string,\n        public enabled: boolean,\n        public cssClasses?: McCalendarCellCssClasses\n    ) {}\n}\n\n\n/**\n * An internal component used to display calendar data in a table.\n * @docs-private\n */\n@Component({\n    selector: '[mc-calendar-body]',\n    exportAs: 'mcCalendarBody',\n    templateUrl: 'calendar-body.html',\n    styleUrls: ['calendar-body.scss'],\n    host: {\n        class: 'mc-calendar__body',\n        role: 'grid',\n        'aria-readonly': 'true'\n    },\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McCalendarBody implements OnChanges {\n    /** The label for the table. (e.g. \"Jan 2017\"). */\n    @Input() label: string;\n\n    /** The cells to display in the table. */\n    @Input() rows: McCalendarCell[][];\n\n    /** The value in the table that corresponds to today. */\n    @Input() todayValue: number;\n\n    /** The value in the table that is currently selected. */\n    @Input() selectedValue: number;\n\n    /** The minimum number of free cells needed to fit the label in the first row. */\n    @Input() labelMinRequiredCells: number;\n\n    /** The number of columns in the table. */\n    @Input() numCols = 7;\n\n    /** The cell number of the active cell in the table. */\n    @Input() activeCell = 0;\n\n    /**\n     * The aspect ratio (width / height) to use for the cells in the table. This aspect ratio will be\n     * maintained even as the table resizes.\n     */\n    @Input() cellAspectRatio = 1;\n\n    /** Emits when a new value is selected. */\n    @Output() readonly selectedValueChange: EventEmitter<number> = new EventEmitter<number>();\n\n    /** The number of blank cells to put at the beginning for the first row. */\n    firstRowOffset: number;\n\n    /** Padding for the individual date cells. */\n    cellPadding: string;\n\n    /** Width of an individual cell. */\n    cellWidth: string;\n\n    constructor(private readonly elementRef: ElementRef<HTMLElement>, private readonly ngZone: NgZone) {}\n\n    cellClicked(cell: McCalendarCell): void {\n        if (cell.enabled) {\n            this.selectedValueChange.emit(cell.value);\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        const columnChanges = changes.numCols;\n        // tslint:disable-next-line:no-this-assignment\n        const { rows, numCols } = this;\n\n        if (changes.rows || columnChanges) {\n            this.firstRowOffset = rows && rows.length && rows[0].length ? numCols - rows[0].length : 0;\n        }\n\n        if (changes.cellAspectRatio || columnChanges || !this.cellPadding) {\n            this.cellPadding = `${this.cellAspectRatio * 50 / numCols}%`;\n        }\n\n        if (columnChanges || !this.cellWidth) {\n            this.cellWidth = `${100 / numCols}%`;\n        }\n    }\n\n    isActiveCell(rowIndex: number, colIndex: number): boolean {\n        let cellNumber = rowIndex * this.numCols + colIndex;\n\n        // Account for the fact that the first row may not have as many cells.\n        if (rowIndex) {\n            cellNumber -= this.firstRowOffset;\n        }\n\n        return cellNumber === this.activeCell;\n    }\n\n    /** Focuses the active cell after the microtask queue is empty. */\n    focusActiveCell() {\n        this.ngZone.runOutsideAngular(() => {\n            this.ngZone.onStable.asObservable().pipe(take(1)).subscribe(() => {\n                const activeCell: HTMLElement | null =\n                    this.elementRef.nativeElement.querySelector('.mc-calendar__body_active');\n\n                if (activeCell) {\n                    activeCell.focus();\n                }\n            });\n        });\n    }\n}\n","/** @docs-private */\nexport function createMissingDateImplError(provider: string) {\n    return Error(\n        `McDatepicker: No provider found for ${provider}. You must import one of the existing ` +\n        `modules at your application root or provide a custom implementation or use exists ones.`);\n}\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n\n/** Datepicker data that requires internationalization. */\n@Injectable({ providedIn: 'root' })\nexport class McDatepickerIntl {\n    /**\n     * Stream that emits whenever the labels here are changed. Use this to notify\n     * components if the labels have changed after initialization.\n     */\n    readonly changes: Subject<void> = new Subject<void>();\n\n    /** A label for the calendar popup (used by screen readers). */\n    calendarLabel: string = 'Calendar';\n\n    /** A label for the button used to open the calendar popup (used by screen readers). */\n    openCalendarLabel: string = 'Open calendar';\n\n    /** A label for the previous month button (used by screen readers). */\n    prevMonthLabel: string = 'Previous month';\n\n    /** A label for the next month button (used by screen readers). */\n    nextMonthLabel: string = 'Next month';\n\n    /** A label for the previous year button (used by screen readers). */\n    prevYearLabel: string = 'Previous year';\n\n    /** A label for the next year button (used by screen readers). */\n    nextYearLabel: string = 'Next year';\n\n    /** A label for the previous multi-year button (used by screen readers). */\n    prevMultiYearLabel: string = 'Previous 20 years';\n\n    /** A label for the next multi-year button (used by screen readers). */\n    nextMultiYearLabel: string = 'Next 20 years';\n\n    /** A label for the 'switch to month view' button (used by screen readers). */\n    switchToMonthViewLabel: string = 'Choose date';\n\n    /** A label for the 'switch to year view' button (used by screen readers). */\n    switchToMultiYearViewLabel: string = 'Choose month and year';\n}\n","// tslint:disable:no-magic-numbers\nimport { Directionality } from '@angular/cdk/bidi';\nimport {\n    AfterContentInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Inject,\n    Input,\n    Optional,\n    Output,\n    ViewEncapsulation,\n    ViewChild\n} from '@angular/core';\nimport { DateAdapter, MC_DATE_FORMATS, McDateFormats } from '@ptsecurity/cdk/datetime';\nimport {\n    DOWN_ARROW,\n    END,\n    ENTER,\n    HOME,\n    LEFT_ARROW,\n    PAGE_DOWN,\n    PAGE_UP,\n    RIGHT_ARROW,\n    UP_ARROW,\n    SPACE\n} from '@ptsecurity/cdk/keycodes';\n\nimport { McCalendarBody, McCalendarCell, McCalendarCellCssClasses } from './calendar-body.component';\nimport { createMissingDateImplError } from './datepicker-errors';\n\n\nconst DAYS_PER_WEEK = 7;\n\n\n/**\n * An internal component used to display a single month in the datepicker.\n * @docs-private\n */\n@Component({\n    selector: 'mc-month-view',\n    exportAs: 'mcMonthView',\n    templateUrl: 'month-view.html',\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McMonthView<D> implements AfterContentInit {\n    /**\n     * The date to display in this month view (everything other than the month and year is ignored).\n     */\n    @Input()\n    get activeDate(): D {\n        return this._activeDate;\n    }\n\n    set activeDate(value: D) {\n        const oldActiveDate = this._activeDate;\n        const validDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value)) || this.dateAdapter.today();\n        this._activeDate = this.dateAdapter.clampDate(validDate, this.minDate, this.maxDate);\n\n        if (!this.hasSameMonthAndYear(oldActiveDate, this._activeDate)) {\n            this.init();\n        }\n    }\n\n    /** The currently selected date. */\n    @Input()\n    get selected(): D | null {\n        return this._selected;\n    }\n\n    set selected(value: D | null) {\n        this._selected = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n        this.selectedDate = this.getDateInCurrentMonth(this._selected);\n    }\n\n    /** The minimum selectable date. */\n    @Input()\n    get minDate(): D | null {\n        return this._minDate;\n    }\n\n    set minDate(value: D | null) {\n        this._minDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The maximum selectable date. */\n    @Input()\n    get maxDate(): D | null {\n        return this._maxDate;\n    }\n\n    set maxDate(value: D | null) {\n        this._maxDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** Function used to filter which dates are selectable. */\n    @Input() dateFilter: (date: D) => boolean;\n\n    /** Function that can be used to add custom CSS classes to dates. */\n    @Input() dateClass: (date: D) => McCalendarCellCssClasses;\n\n    /** Emits when a new date is selected. */\n    @Output() readonly selectedChange: EventEmitter<D | null> = new EventEmitter<D | null>();\n\n    /** Emits when any date is selected. */\n    @Output() readonly userSelection: EventEmitter<void> = new EventEmitter<void>();\n\n    /** Emits when any date is activated. */\n    @Output() readonly activeDateChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /** The body of calendar table */\n    @ViewChild(McCalendarBody, {static: false}) mcCalendarBody: McCalendarBody;\n\n    /** The label for this month (e.g. \"January 2017\"). */\n    monthLabel: string;\n\n    /** Grid of calendar cells representing the dates of the month. */\n    weeks: McCalendarCell[][];\n\n    /** The number of blank cells in the first row before the 1st of the month. */\n    firstWeekOffset: number;\n\n    /**\n     * The date of the month that the currently selected Date falls on.\n     * Null if the currently selected Date is in another month.\n     */\n    selectedDate: number | null;\n\n    /** The date of the month that today falls on. Null if today is in another month. */\n    todayDate: number | null;\n\n    /** The names of the weekdays. */\n    weekdays: { long: string; narrow: string }[];\n    private _activeDate: D;\n    private _selected: D | null;\n    private _minDate: D | null;\n    private _maxDate: D | null;\n\n    constructor(\n        private changeDetectorRef: ChangeDetectorRef,\n        @Optional() @Inject(MC_DATE_FORMATS) private readonly dateFormats: McDateFormats,\n        @Optional() public dateAdapter: DateAdapter<D>,\n        @Optional() private dir?: Directionality\n    ) {\n\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        if (!this.dateFormats) {\n            throw createMissingDateImplError('MC_DATE_FORMATS');\n        }\n\n        const firstDayOfWeek = this.dateAdapter.getFirstDayOfWeek();\n        const narrowWeekdays = this.dateAdapter.getDayOfWeekNames('short');\n        const longWeekdays = this.dateAdapter.getDayOfWeekNames('long');\n\n        // Rotate the labels for days of the week based on the configured first day of the week.\n        const weekdays = longWeekdays.map((long, i) => {\n            return { long, narrow: narrowWeekdays[i] };\n        });\n        this.weekdays = weekdays\n            .slice(firstDayOfWeek)\n            .concat(weekdays.slice(0, firstDayOfWeek));\n\n        this._activeDate = this.dateAdapter.today();\n    }\n\n    ngAfterContentInit() {\n        this.init();\n    }\n\n    /** Handles when a new date is selected. */\n    dateSelected(date: number) {\n        if (this.selectedDate !== date) {\n            const selectedYear = this.dateAdapter.getYear(this.activeDate);\n            const selectedMonth = this.dateAdapter.getMonth(this.activeDate);\n            const selectedDate = this.dateAdapter.createDate(selectedYear, selectedMonth, date);\n\n            this.selectedChange.emit(selectedDate);\n        }\n\n        this.userSelection.emit();\n    }\n\n    /** Handles keydown events on the calendar body when calendar is in month view. */\n    handleCalendarBodyKeydown(event: KeyboardEvent): void {\n        // TODO(mmalerba): We currently allow keyboard navigation to disabled dates, but just prevent\n        // disabled ones from being selected. This may not be ideal, we should look into whether\n        // navigation should skip over disabled dates, and if so, how to implement that efficiently.\n\n        const oldActiveDate = this._activeDate;\n        const isRtl = this.isRtl();\n\n        // tslint:disable-next-line:deprecation\n        switch (event.keyCode) {\n            case LEFT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarDays(this._activeDate, isRtl ? 1 : -1);\n                break;\n            case RIGHT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarDays(this._activeDate, isRtl ? -1 : 1);\n                break;\n            case UP_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarDays(this._activeDate, -7);\n                break;\n            case DOWN_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarDays(this._activeDate, 7);\n                break;\n            case HOME:\n                this.activeDate = this.dateAdapter.addCalendarDays(\n                    this._activeDate,\n                    1 - this.dateAdapter.getDate(this._activeDate)\n                );\n                break;\n            case END:\n                this.activeDate = this.dateAdapter.addCalendarDays(\n                    this._activeDate,\n                    (this.dateAdapter.getNumDaysInMonth(this._activeDate) - this.dateAdapter.getDate(this._activeDate))\n                );\n                break;\n            case PAGE_UP:\n                this.activeDate = event.altKey ?\n                    this.dateAdapter.addCalendarYears(this._activeDate, -1) :\n                    this.dateAdapter.addCalendarMonths(this._activeDate, -1);\n                break;\n            case PAGE_DOWN:\n                this.activeDate = event.altKey ?\n                    this.dateAdapter.addCalendarYears(this._activeDate, 1) :\n                    this.dateAdapter.addCalendarMonths(this._activeDate, 1);\n                break;\n            case ENTER:\n            case SPACE:\n                if (!this.dateFilter || this.dateFilter(this._activeDate)) {\n                    this.dateSelected(this.dateAdapter.getDate(this._activeDate));\n                    this.userSelection.emit();\n                    // Prevent unexpected default actions such as form submission.\n                    event.preventDefault();\n                }\n\n                return;\n            default:\n                // Don't prevent default or focus active cell on keys that we don't explicitly handle.\n                return;\n        }\n\n        if (this.dateAdapter.compareDate(oldActiveDate, this.activeDate)) {\n            this.activeDateChange.emit(this.activeDate);\n        }\n\n        this.focusActiveCell();\n        // Prevent unexpected default actions such as form submission.\n        event.preventDefault();\n    }\n\n    /** Initializes this month view. */\n    init() {\n        this.selectedDate = this.getDateInCurrentMonth(this.selected);\n        this.todayDate = this.getDateInCurrentMonth(this.dateAdapter.today());\n        this.monthLabel = this.dateAdapter.getMonthNames('short')[this.dateAdapter.getMonth(this.activeDate)];\n\n        this.monthLabel = this.monthLabel[0].toLocaleUpperCase() + this.monthLabel.substr(1);\n\n        const firstOfMonth = this.dateAdapter.createDate(\n            this.dateAdapter.getYear(this.activeDate),\n            this.dateAdapter.getMonth(this.activeDate)\n        );\n\n        this.firstWeekOffset =\n            (DAYS_PER_WEEK + this.dateAdapter.getDayOfWeek(firstOfMonth) -\n                this.dateAdapter.getFirstDayOfWeek()) % DAYS_PER_WEEK;\n\n        this.createWeekCells();\n        this.changeDetectorRef.markForCheck();\n    }\n\n    /** Focuses the active cell after the microtask queue is empty. */\n    focusActiveCell() {\n        this.mcCalendarBody.focusActiveCell();\n    }\n\n    /** Creates McCalendarCells for the dates in this month. */\n    private createWeekCells() {\n        const daysInMonth = this.dateAdapter.getNumDaysInMonth(this.activeDate);\n        const dateNames = this.dateAdapter.getDateNames();\n\n        this.weeks = [[]];\n\n        for (let i = 0, cell = this.firstWeekOffset; i < daysInMonth; i++, cell++) {\n            if (cell === DAYS_PER_WEEK) {\n                this.weeks.push([]);\n                cell = 0;\n            }\n\n            const date = this.dateAdapter.createDate(\n                this.dateAdapter.getYear(this.activeDate),\n                this.dateAdapter.getMonth(this.activeDate),\n                i + 1\n            );\n            const enabled = this.shouldEnableDate(date);\n            const ariaLabel = this.dateAdapter.format(date, this.dateFormats.dateA11yLabel);\n            const cellClasses = this.dateClass ? this.dateClass(date) : undefined;\n\n            this.weeks[this.weeks.length - 1]\n                .push(new McCalendarCell(i + 1, dateNames[i], ariaLabel, enabled, cellClasses));\n        }\n    }\n\n    /** Date filter for the month */\n    private shouldEnableDate(date: D): boolean {\n        return !!date &&\n            (!this.dateFilter || this.dateFilter(date)) &&\n            (!this.minDate || this.dateAdapter.compareDate(date, this.minDate) >= 0) &&\n            (!this.maxDate || this.dateAdapter.compareDate(date, this.maxDate) <= 0);\n    }\n\n    /**\n     * Gets the date in this month that the given Date falls on.\n     * Returns null if the given Date is in another month.\n     */\n    private getDateInCurrentMonth(date: D | null): number | null {\n        return date && this.hasSameMonthAndYear(date, this.activeDate) ?\n            this.dateAdapter.getDate(date) : null;\n    }\n\n    /** Checks whether the 2 dates are non-null and fall within the same month of the same year. */\n    private hasSameMonthAndYear(d1: D | null, d2: D | null): boolean {\n        return !!(d1 && d2 && this.dateAdapter.getMonth(d1) === this.dateAdapter.getMonth(d2) &&\n            this.dateAdapter.getYear(d1) === this.dateAdapter.getYear(d2));\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n\n    /** Determines whether the user has the RTL layout direction. */\n    private isRtl() {\n        return this.dir && this.dir.value === 'rtl';\n    }\n}\n","// tslint:disable:no-magic-numbers\nimport { Directionality } from '@angular/cdk/bidi';\nimport {\n    AfterContentInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Input,\n    Optional,\n    Output,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { DateAdapter } from '@ptsecurity/cdk/datetime';\nimport {\n    DOWN_ARROW,\n    END,\n    ENTER,\n    HOME,\n    LEFT_ARROW,\n    PAGE_DOWN,\n    PAGE_UP,\n    RIGHT_ARROW,\n    UP_ARROW,\n    SPACE\n} from '@ptsecurity/cdk/keycodes';\n\nimport { McCalendarBody, McCalendarCell } from './calendar-body.component';\nimport { createMissingDateImplError } from './datepicker-errors';\n\n\nexport const yearsPerPage = 24;\n\nexport const yearsPerRow = 4;\n\n\n/**\n * An internal component used to display a year selector in the datepicker.\n * @docs-private\n */\n@Component({\n    selector: 'mc-multi-year-view',\n    exportAs: 'mcMultiYearView',\n    templateUrl: 'multi-year-view.html',\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McMultiYearView<D> implements AfterContentInit {\n    /** The date to display in this multi-year view (everything other than the year is ignored). */\n    @Input()\n    get activeDate(): D {\n        return this._activeDate;\n    }\n\n    set activeDate(value: D) {\n        const oldActiveDate = this._activeDate;\n        const validDate =\n            this.getValidDateOrNull(this.dateAdapter.deserialize(value)) || this.dateAdapter.today();\n        this._activeDate = this.dateAdapter.clampDate(validDate, this.minDate, this.maxDate);\n\n        if (Math.floor(this.dateAdapter.getYear(oldActiveDate) / yearsPerPage) !==\n            Math.floor(this.dateAdapter.getYear(this._activeDate) / yearsPerPage)) {\n            this.init();\n        }\n    }\n\n    /** The currently selected date. */\n    @Input()\n    get selected(): D | null {\n        return this._selected;\n    }\n\n    set selected(value: D | null) {\n        this._selected = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n        this.selectedYear = this._selected && this.dateAdapter.getYear(this._selected);\n    }\n\n    /** The minimum selectable date. */\n    @Input()\n    get minDate(): D | null {\n        return this._minDate;\n    }\n\n    set minDate(value: D | null) {\n        this._minDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The maximum selectable date. */\n    @Input()\n    get maxDate(): D | null {\n        return this._maxDate;\n    }\n\n    set maxDate(value: D | null) {\n        this._maxDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** A function used to filter which dates are selectable. */\n    @Input() dateFilter: (date: D) => boolean;\n\n    /** Emits when a new year is selected. */\n    @Output() readonly selectedChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Emits the selected year. This doesn't imply a change on the selected date */\n    @Output() readonly yearSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Emits when any date is activated. */\n    @Output() readonly activeDateChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /** The body of calendar table */\n    @ViewChild(McCalendarBody, {static: false}) mcCalendarBody: McCalendarBody;\n\n    /** Grid of calendar cells representing the currently displayed years. */\n    years: McCalendarCell[][];\n\n    /** The year that today falls on. */\n    todayYear: number;\n\n    /** The year of the selected date. Null if the selected date is null. */\n    selectedYear: number | null;\n    private _activeDate: D;\n    private _selected: D | null;\n    private _minDate: D | null;\n    private _maxDate: D | null;\n\n    constructor(\n        private readonly changeDetectorRef: ChangeDetectorRef,\n        @Optional() public dateAdapter: DateAdapter<D>,\n        @Optional() private dir?: Directionality\n    ) {\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        this._activeDate = this.dateAdapter.today();\n    }\n\n    ngAfterContentInit() {\n        this.init();\n    }\n\n    /** Initializes this multi-year view. */\n    init() {\n        this.todayYear = this.dateAdapter.getYear(this.dateAdapter.today());\n        const activeYear = this.dateAdapter.getYear(this._activeDate);\n        const activeOffset = activeYear % yearsPerPage;\n        this.years = [];\n        for (let i = 0, row: number[] = []; i < yearsPerPage; i++) {\n            row.push(activeYear - activeOffset + i);\n            if (row.length === yearsPerRow) {\n                this.years.push(row.map((year) => this.createCellForYear(year)));\n                row = [];\n            }\n        }\n        this.changeDetectorRef.markForCheck();\n    }\n\n    /** Handles when a new year is selected. */\n    onYearSelected(year: number) {\n        this.yearSelected.emit(this.dateAdapter.createDate(year));\n        const month = this.dateAdapter.getMonth(this.activeDate);\n        const daysInMonth =\n            this.dateAdapter.getNumDaysInMonth(this.dateAdapter.createDate(year, month));\n        this.selectedChange.emit(\n            this.dateAdapter.createDate(year, month, Math.min(this.dateAdapter.getDate(this.activeDate), daysInMonth))\n        );\n    }\n\n    /** Handles keydown events on the calendar body when calendar is in multi-year view. */\n    handleCalendarBodyKeydown(event: KeyboardEvent): void {\n        // TODO(mmalerba): We currently allow keyboard navigation to disabled dates, but just prevent\n        // disabled ones from being selected. This may not be ideal, we should look into whether\n        // navigation should skip over disabled dates, and if so, how to implement that efficiently.\n\n        const oldActiveDate = this._activeDate;\n        const isRtl = this.isRtl();\n\n        // tslint:disable-next-line:deprecation\n        switch (event.keyCode) {\n            case LEFT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarYears(this._activeDate, isRtl ? 1 : -1);\n                break;\n            case RIGHT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarYears(this._activeDate, isRtl ? -1 : 1);\n                break;\n            case UP_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarYears(this._activeDate, -yearsPerRow);\n                break;\n            case DOWN_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarYears(this._activeDate, yearsPerRow);\n                break;\n            case HOME:\n                this.activeDate = this.dateAdapter.addCalendarYears(\n                    this._activeDate,\n                    -this.dateAdapter.getYear(this._activeDate) % yearsPerPage\n                );\n                break;\n            case END:\n                this.activeDate = this.dateAdapter.addCalendarYears(\n                    this._activeDate,\n                    yearsPerPage - this.dateAdapter.getYear(this._activeDate) % yearsPerPage - 1\n                );\n                break;\n            case PAGE_UP:\n                this.activeDate =\n                    this.dateAdapter.addCalendarYears(\n                        this._activeDate, event.altKey ? -yearsPerPage * 10 : -yearsPerPage);\n                break;\n            case PAGE_DOWN:\n                this.activeDate =\n                    this.dateAdapter.addCalendarYears(\n                        this._activeDate, event.altKey ? yearsPerPage * 10 : yearsPerPage);\n                break;\n            case ENTER:\n            case SPACE:\n                this.onYearSelected(this.dateAdapter.getYear(this._activeDate));\n                break;\n            default:\n                // Don't prevent default or focus active cell on keys that we don't explicitly handle.\n                return;\n        }\n\n        if (this.dateAdapter.compareDate(oldActiveDate, this.activeDate)) {\n            this.activeDateChange.emit(this.activeDate);\n        }\n\n        this.focusActiveCell();\n        // Prevent unexpected default actions such as form submission.\n        event.preventDefault();\n    }\n\n    getActiveCell(): number {\n        return this.dateAdapter.getYear(this.activeDate) % yearsPerPage;\n    }\n\n    /** Focuses the active cell after the microtask queue is empty. */\n    focusActiveCell() {\n        this.mcCalendarBody.focusActiveCell();\n    }\n\n    /** Creates an McCalendarCell for the given year. */\n    private createCellForYear(year: number) {\n        const yearName = this.dateAdapter.getYearName(this.dateAdapter.createDate(year));\n\n        return new McCalendarCell(year, yearName, yearName, this.shouldEnableYear(year));\n    }\n\n    /** Whether the given year is enabled. */\n    private shouldEnableYear(year: number) {\n        // disable if the year is greater than maxDate lower than minDate\n        if (year === undefined || year === null ||\n            (this.maxDate && year > this.dateAdapter.getYear(this.maxDate)) ||\n            (this.minDate && year < this.dateAdapter.getYear(this.minDate))) {\n            return false;\n        }\n\n        // enable if it reaches here and there's no filter defined\n        if (!this.dateFilter) {\n            return true;\n        }\n\n        const firstOfYear = this.dateAdapter.createDate(year);\n\n        // If any date in the year is enabled count the year as enabled.\n        for (let date = firstOfYear; this.dateAdapter.getYear(date) === year;\n             date = this.dateAdapter.addCalendarDays(date, 1)) {\n            if (this.dateFilter(date)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n\n    /** Determines whether the user has the RTL layout direction. */\n    private isRtl() {\n        return this.dir && this.dir.value === 'rtl';\n    }\n}\n","import { ComponentPortal, ComponentType, Portal } from '@angular/cdk/portal';\nimport {\n    AfterContentInit,\n    AfterViewChecked,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    forwardRef,\n    Inject,\n    Input,\n    OnChanges,\n    OnDestroy,\n    Optional,\n    Output,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { DateAdapter, MC_DATE_FORMATS, McDateFormats } from '@ptsecurity/cdk/datetime';\nimport { Subject, Subscription } from 'rxjs';\n\nimport { McCalendarCellCssClasses } from './calendar-body.component';\nimport { createMissingDateImplError } from './datepicker-errors';\nimport { McDatepickerIntl } from './datepicker-intl';\nimport { McMonthView } from './month-view.component';\nimport { McMultiYearView, yearsPerPage } from './multi-year-view.component';\nimport { McYearView } from './year-view.component';\n\n\n/**\n * Possible views for the calendar.\n * @docs-private\n */\nexport enum McCalendarView {\n    Month = 'month',\n    Year = 'year',\n    MultiYear = 'multi-year'\n}\n\n/** Default header for McCalendar */\n@Component({\n    selector: 'mc-calendar-header',\n    templateUrl: 'calendar-header.html',\n    exportAs: 'mcCalendarHeader',\n    host: {\n        class: 'mc-calendar-header'\n    },\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McCalendarHeader<D> {\n    constructor(\n        private readonly intl: McDatepickerIntl,\n        @Inject(forwardRef(() => McCalendar)) public calendar: McCalendar<D>,\n        @Optional() private readonly dateAdapter: DateAdapter<D>,\n        @Optional() @Inject(MC_DATE_FORMATS) private readonly dateFormats: McDateFormats,\n        changeDetectorRef: ChangeDetectorRef\n    ) {\n        this.calendar.stateChanges.subscribe(() => changeDetectorRef.markForCheck());\n    }\n\n    /** The label for the current calendar view. */\n    get periodButtonText(): string {\n        if (this.calendar.currentView === McCalendarView.Month) {\n            const label = this.dateAdapter.format(this.calendar.activeDate, this.dateFormats.monthYearLabel);\n\n            return (label[0].toLocaleUpperCase() + label.substr(1)).replace('.', '');\n        }\n\n        if (this.calendar.currentView === McCalendarView.Year) {\n            return this.dateAdapter.getYearName(this.calendar.activeDate);\n        }\n\n        const activeYear = this.dateAdapter.getYear(this.calendar.activeDate);\n        const firstYearInView = this.dateAdapter.getYearName(\n            // tslint:disable-next-line:no-magic-numbers\n            this.dateAdapter.createDate(activeYear - activeYear % 24)\n        );\n        const lastYearInView = this.dateAdapter.getYearName(\n            // tslint:disable-next-line:no-magic-numbers\n            this.dateAdapter.createDate(activeYear + yearsPerPage - 1 - activeYear % 24)\n        );\n\n        return `${firstYearInView} \\u2013 ${lastYearInView}`;\n    }\n\n    get periodButtonLabel(): string {\n        return this.calendar.currentView === McCalendarView.Month ?\n            this.intl.switchToMultiYearViewLabel : this.intl.switchToMonthViewLabel;\n    }\n\n    /** The label for the previous button. */\n    get prevButtonLabel(): string {\n        return {\n            [McCalendarView.Month]: this.intl.prevMonthLabel,\n            [McCalendarView.Year]: this.intl.prevYearLabel,\n            [McCalendarView.MultiYear]: this.intl.prevMultiYearLabel\n        }[this.calendar.currentView];\n    }\n\n    /** The label for the next button. */\n    get nextButtonLabel(): string {\n        return {\n            [McCalendarView.Month]: this.intl.nextMonthLabel,\n            [McCalendarView.Year]: this.intl.nextYearLabel,\n            [McCalendarView.MultiYear]: this.intl.nextMultiYearLabel\n        }[this.calendar.currentView];\n    }\n\n    /** Handles user clicks on the period label. */\n    currentPeriodClicked(): void {\n        if (([McCalendarView.Month, McCalendarView.MultiYear] as McCalendarView[]).includes(this.calendar.currentView)) {\n            this.calendar.currentView = McCalendarView.Year;\n        } else if (this.calendar.currentView === McCalendarView.Year) {\n            this.calendar.currentView = McCalendarView.Month;\n        }\n    }\n\n    /** Handles user clicks on the previous button. */\n    previousClicked(): void {\n        if (this.calendar.currentView === McCalendarView.Month) {\n            this.calendar.activeDate = this.dateAdapter.addCalendarMonths(this.calendar.activeDate, -1);\n        } else {\n            this.calendar.activeDate = this.dateAdapter.addCalendarYears(\n                this.calendar.activeDate,\n                this.calendar.currentView === McCalendarView.Year ? -1 : -yearsPerPage\n            );\n        }\n    }\n\n    /** Handles user clicks on the next button. */\n    nextClicked(): void {\n        if (this.calendar.currentView === McCalendarView.Month) {\n            this.calendar.activeDate = this.dateAdapter.addCalendarMonths(this.calendar.activeDate, 1);\n        } else {\n            this.calendar.activeDate = this.dateAdapter.addCalendarYears(\n                this.calendar.activeDate,\n                this.calendar.currentView === McCalendarView.Year ? 1 : yearsPerPage\n            );\n        }\n    }\n\n    /** Whether the previous period button is enabled. */\n    previousEnabled(): boolean {\n        if (!this.calendar.minDate) { return true; }\n\n        return !this.calendar.minDate || !this.isSameView(this.calendar.activeDate, this.calendar.minDate);\n    }\n\n    /** Whether the next period button is enabled. */\n    nextEnabled(): boolean {\n        return !this.calendar.maxDate || !this.isSameView(this.calendar.activeDate, this.calendar.maxDate);\n    }\n\n    /** Whether the two dates represent the same view in the current view mode (month or year). */\n    private isSameView(firstDate: D, secondDate: D): boolean {\n        const firstYear = this.dateAdapter.getYear(firstDate);\n        const secondYear = this.dateAdapter.getYear(secondDate);\n\n        const firstMonth = this.dateAdapter.getMonth(firstDate);\n        const secondMonth = this.dateAdapter.getMonth(secondDate);\n\n        if (this.calendar.currentView === McCalendarView.Month) {\n            return firstYear === secondYear && firstMonth === secondMonth;\n        }\n\n        if (this.calendar.currentView === McCalendarView.Year) { return firstYear === secondYear; }\n\n        // Otherwise we are in 'multi-year' view.\n        return Math.floor(firstYear / yearsPerPage) === Math.floor(secondYear / yearsPerPage);\n    }\n}\n\n/**\n * A calendar that is used as part of the datepicker.\n * @docs-private\n */\n@Component({\n    selector: 'mc-calendar',\n    exportAs: 'mcCalendar',\n    templateUrl: 'calendar.html',\n    styleUrls: ['calendar.scss'],\n    host: {\n        class: 'mc-calendar'\n    },\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McCalendar<D> implements AfterContentInit, AfterViewChecked, OnDestroy, OnChanges {\n\n    /** A date representing the period (month or year) to start the calendar in. */\n    @Input()\n    get startAt(): D | null {\n        return this._startAt;\n    }\n\n    set startAt(value: D | null) {\n        this._startAt = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The currently selected date. */\n    @Input()\n    get selected(): D | null {\n        return this._selected;\n    }\n\n    set selected(value: D | null) {\n        this._selected = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The minimum selectable date. */\n    @Input()\n    get minDate(): D | null {\n        return this._minDate;\n    }\n\n    set minDate(value: D | null) {\n        this._minDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The maximum selectable date. */\n    @Input()\n    get maxDate(): D | null {\n        return this._maxDate;\n    }\n\n    set maxDate(value: D | null) {\n        this._maxDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /**\n     * The current active date. This determines which time period is shown and which date is\n     * highlighted when using keyboard navigation.\n     */\n    get activeDate(): D {\n        return this.clampedActiveDate;\n    }\n\n    set activeDate(value: D) {\n        this.clampedActiveDate = this.dateAdapter.clampDate(value, this.minDate, this.maxDate);\n        this.stateChanges.next();\n    }\n\n    /** Whether the calendar is in month view. */\n    get currentView(): McCalendarView {\n        return this._currentView;\n    }\n\n    set currentView(value: McCalendarView) {\n        this._currentView = value;\n        this.moveFocusOnNextTick = true;\n    }\n\n    /** An input indicating the type of the header component, if set. */\n    @Input() headerComponent: ComponentType<any>;\n\n    /** A portal containing the header component type for this calendar. */\n    calendarHeaderPortal: Portal<any>;\n\n    /** Whether the calendar should be started in month or year view. */\n    @Input() startView: McCalendarView = McCalendarView.Month;\n\n    /** Function used to filter which dates are selectable. */\n    @Input() dateFilter: (date: D) => boolean;\n\n    /** Function that can be used to add custom CSS classes to dates. */\n    @Input() dateClass: (date: D) => McCalendarCellCssClasses;\n\n    /** Emits when the currently selected date changes. */\n    @Output() readonly selectedChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /**\n     * Emits the year chosen in multiyear view.\n     * This doesn't imply a change on the selected date.\n     */\n    @Output() readonly yearSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /**\n     * Emits the month chosen in year view.\n     * This doesn't imply a change on the selected date.\n     */\n    @Output() readonly monthSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Emits when any date is selected. */\n    @Output() readonly userSelection: EventEmitter<void> = new EventEmitter<void>();\n\n    /** Reference to the current month view component. */\n    @ViewChild(McMonthView, {static: false}) monthView: McMonthView<D>;\n\n    /** Reference to the current year view component. */\n    @ViewChild(McYearView, {static: false}) yearView: McYearView<D>;\n\n    /** Reference to the current multi-year view component. */\n    @ViewChild(McMultiYearView, {static: false}) multiYearView: McMultiYearView<D>;\n\n    /**\n     * Emits whenever there is a state change that the header may need to respond to.\n     */\n    stateChanges = new Subject<void>();\n\n    private readonly intlChanges: Subscription;\n\n    /**\n     * Used for scheduling that focus should be moved to the active cell on the next tick.\n     * We need to schedule it, rather than do it immediately, because we have to wait\n     * for Angular to re-evaluate the view children.\n     */\n    private moveFocusOnNextTick = false;\n    private _startAt: D | null;\n    private _selected: D | null;\n    private _minDate: D | null;\n    private _maxDate: D | null;\n    private clampedActiveDate: D;\n    private _currentView: McCalendarView;\n\n    constructor(\n        intl: McDatepickerIntl,\n        @Optional() private readonly dateAdapter: DateAdapter<D>,\n        @Optional() @Inject(MC_DATE_FORMATS) private readonly dateFormats: McDateFormats,\n        private changeDetectorRef: ChangeDetectorRef\n    ) {\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        if (!this.dateFormats) {\n            throw createMissingDateImplError('MC_DATE_FORMATS');\n        }\n\n        this.intlChanges = intl.changes.subscribe(() => {\n            changeDetectorRef.markForCheck();\n            this.stateChanges.next();\n        });\n    }\n\n    ngAfterContentInit() {\n        this.calendarHeaderPortal = new ComponentPortal(this.headerComponent || McCalendarHeader);\n        this.activeDate = this.startAt || this.dateAdapter.today();\n\n        // Assign to the private property since we don't want to move focus on init.\n        this._currentView = this.startView;\n    }\n\n    ngAfterViewChecked() {\n        if (this.moveFocusOnNextTick) {\n            this.moveFocusOnNextTick = false;\n            this.focusActiveCell();\n        }\n    }\n\n    ngOnDestroy() {\n        this.intlChanges.unsubscribe();\n        this.stateChanges.complete();\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        const change = changes.minDate || changes.maxDate || changes.dateFilter;\n\n        if (change && !change.firstChange) {\n            const view = this.getCurrentViewComponent();\n\n            if (view) {\n                // We need to `detectChanges` manually here, because the `minDate`, `maxDate` etc. are\n                // passed down to the view via data bindings which won't be up-to-date when we call `init`.\n                this.changeDetectorRef.detectChanges();\n                view.init();\n            }\n        }\n\n        this.stateChanges.next();\n    }\n\n    focusActiveCell() {\n        this.getCurrentViewComponent().focusActiveCell();\n    }\n\n    /** Updates today's date after an update of the active date */\n    updateTodaysDate() {\n        const view = this.currentView === McCalendarView.Month ? this.monthView :\n            (this.currentView === McCalendarView.Year ? this.yearView : this.multiYearView);\n\n        view.ngAfterContentInit();\n    }\n\n    /** Handles date selection in the month view. */\n    dateSelected(date: D): void {\n        if (!this.dateAdapter.sameDate(date, this.selected)) {\n            this.selectedChange.emit(date);\n        }\n    }\n\n    /** Handles year selection in the multiyear view. */\n    yearSelectedInMultiYearView(normalizedYear: D) {\n        this.yearSelected.emit(normalizedYear);\n    }\n\n    /** Handles month selection in the year view. */\n    monthSelectedInYearView(normalizedMonth: D) {\n        this.monthSelected.emit(normalizedMonth);\n    }\n\n    userSelected(): void {\n        this.userSelection.emit();\n    }\n\n    /** Handles year/month selection in the multi-year/year views. */\n    goToDateInView(date: D, view: McCalendarView | string): void {\n        this.activeDate = date;\n        this.currentView = view as McCalendarView;\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n\n    /** Returns the component instance that corresponds to the current calendar view. */\n    private getCurrentViewComponent() {\n        return this.monthView || this.yearView || this.multiYearView;\n    }\n}\n","import { Directionality } from '@angular/cdk/bidi';\nimport {\n    AfterContentInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Inject,\n    Input,\n    Optional,\n    Output,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { DateAdapter, MC_DATE_FORMATS, McDateFormats } from '@ptsecurity/cdk/datetime';\nimport {\n    DOWN_ARROW,\n    END,\n    ENTER,\n    HOME,\n    LEFT_ARROW,\n    PAGE_DOWN,\n    PAGE_UP,\n    RIGHT_ARROW,\n    UP_ARROW,\n    SPACE\n} from '@ptsecurity/cdk/keycodes';\n\nimport { McCalendarBody, McCalendarCell } from './calendar-body.component';\nimport { createMissingDateImplError } from './datepicker-errors';\n\n\n/**\n * An internal component used to display a single year in the datepicker.\n * @docs-private\n */\n@Component({\n    selector: 'mc-year-view',\n    exportAs: 'mcYearView',\n    templateUrl: 'year-view.html',\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McYearView<D> implements AfterContentInit {\n    /** The date to display in this year view (everything other than the year is ignored). */\n    @Input()\n    get activeDate(): D {\n        return this._activeDate;\n    }\n\n    set activeDate(value: D) {\n        const oldActiveDate = this._activeDate;\n        const validDate =\n            this.getValidDateOrNull(this.dateAdapter.deserialize(value)) || this.dateAdapter.today();\n        this._activeDate = this.dateAdapter.clampDate(validDate, this.minDate, this.maxDate);\n\n        if (this.dateAdapter.getYear(oldActiveDate) !== this.dateAdapter.getYear(this._activeDate)) {\n            this.init();\n        }\n    }\n\n    /** The currently selected date. */\n    @Input()\n    get selected(): D | null {\n        return this._selected;\n    }\n\n    set selected(value: D | null) {\n        this._selected = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n        this.selectedMonth = this.getMonthInCurrentYear(this._selected);\n    }\n\n    /** The minimum selectable date. */\n    @Input()\n    get minDate(): D | null {\n        return this._minDate;\n    }\n\n    set minDate(value: D | null) {\n        this._minDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** The maximum selectable date. */\n    @Input()\n    get maxDate(): D | null {\n        return this._maxDate;\n    }\n\n    set maxDate(value: D | null) {\n        this._maxDate = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    /** A function used to filter which dates are selectable. */\n    @Input() dateFilter: (date: D) => boolean;\n\n    /** Emits when a new month is selected. */\n    @Output() readonly selectedChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Emits the selected month. This doesn't imply a change on the selected date */\n    @Output() readonly monthSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Emits when any date is activated. */\n    @Output() readonly activeDateChange: EventEmitter<D> = new EventEmitter<D>();\n\n    /** The body of calendar table */\n    @ViewChild(McCalendarBody, {static: false}) mcCalendarBody: McCalendarBody;\n\n    /** Grid of calendar cells representing the months of the year. */\n    months: McCalendarCell[][];\n\n    /** The label for this year (e.g. \"2017\"). */\n    yearLabel: string;\n\n    /** The month in this year that today falls on. Null if today is in a different year. */\n    todayMonth: number | null;\n\n    /**\n     * The month in this year that the selected Date falls on.\n     * Null if the selected Date is in a different year.\n     */\n    selectedMonth: number | null;\n    private _activeDate: D;\n    private _selected: D | null;\n    private _minDate: D | null;\n    private _maxDate: D | null;\n\n    constructor(\n        private changeDetectorRef: ChangeDetectorRef,\n        @Optional() @Inject(MC_DATE_FORMATS) private readonly dateFormats: McDateFormats,\n        @Optional() public dateAdapter: DateAdapter<D>,\n        @Optional() private dir?: Directionality\n    ) {\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        if (!this.dateFormats) {\n            throw createMissingDateImplError('MC_DATE_FORMATS');\n        }\n\n        this._activeDate = this.dateAdapter.today();\n    }\n\n    ngAfterContentInit() {\n        this.init();\n    }\n\n    /** Handles when a new month is selected. */\n    onMonthSelected(month: number) {\n        const year = this.dateAdapter.getYear(this.activeDate);\n\n        const normalizedDate = this.dateAdapter.createDate(year, month);\n\n        this.monthSelected.emit(normalizedDate);\n\n        const daysInMonth = this.dateAdapter.getNumDaysInMonth(normalizedDate);\n\n        this.selectedChange.emit(\n            this.dateAdapter.createDate(\n                year,\n                month,\n                Math.min(this.dateAdapter.getDate(this.activeDate), daysInMonth)\n            )\n        );\n    }\n\n    /** Handles keydown events on the calendar body when calendar is in year view. */\n    handleCalendarBodyKeydown(event: KeyboardEvent): void {\n        // TODO(mmalerba): We currently allow keyboard navigation to disabled dates, but just prevent\n        // disabled ones from being selected. This may not be ideal, we should look into whether\n        // navigation should skip over disabled dates, and if so, how to implement that efficiently.\n\n        const oldActiveDate = this._activeDate;\n        const isRtl = this.isRtl();\n\n        const VERTICAL_SHIFT = 4;\n        const PAGE_SHIFT = 10;\n        const MAX_MONTH_INDEX = 11;\n\n        // tslint:disable-next-line:deprecation\n        switch (event.keyCode) {\n            case LEFT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarMonths(this._activeDate, isRtl ? 1 : -1);\n                break;\n            case RIGHT_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarMonths(this._activeDate, isRtl ? -1 : 1);\n                break;\n            case UP_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarMonths(this._activeDate, -VERTICAL_SHIFT);\n                break;\n            case DOWN_ARROW:\n                this.activeDate = this.dateAdapter.addCalendarMonths(this._activeDate, VERTICAL_SHIFT);\n                break;\n            case HOME:\n                this.activeDate = this.dateAdapter.addCalendarMonths(\n                    this._activeDate,\n                    -this.dateAdapter.getMonth(this._activeDate)\n                );\n                break;\n            case END:\n                this.activeDate = this.dateAdapter.addCalendarMonths(\n                    this._activeDate,\n                    MAX_MONTH_INDEX - this.dateAdapter.getMonth(this._activeDate)\n                );\n                break;\n            case PAGE_UP:\n                this.activeDate =\n                    this.dateAdapter.addCalendarYears(this._activeDate, event.altKey ? -PAGE_SHIFT : -1);\n                break;\n            case PAGE_DOWN:\n                this.activeDate =\n                    this.dateAdapter.addCalendarYears(this._activeDate, event.altKey ? PAGE_SHIFT : 1);\n                break;\n            case ENTER:\n            case SPACE:\n                this.onMonthSelected(this.dateAdapter.getMonth(this._activeDate));\n                break;\n            default:\n                // Don't prevent default or focus active cell on keys that we don't explicitly handle.\n                return;\n        }\n\n        if (this.dateAdapter.compareDate(oldActiveDate, this.activeDate)) {\n            this.activeDateChange.emit(this.activeDate);\n        }\n\n        this.focusActiveCell();\n        // Prevent unexpected default actions such as form submission.\n        event.preventDefault();\n    }\n\n    /** Initializes this year view. */\n    init() {\n        this.selectedMonth = this.getMonthInCurrentYear(this.selected);\n        this.todayMonth = this.getMonthInCurrentYear(this.dateAdapter.today());\n        this.yearLabel = this.dateAdapter.getYearName(this.activeDate);\n\n        const monthNames = this.dateAdapter.getMonthNames('short');\n\n        // First row of months only contains 5 elements so we can fit the year label on the same row.\n        // tslint:disable-next-line:no-magic-numbers\n        this.months = [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11]]\n            .map((row) => row.map((month) => this.createCellForMonth(month, monthNames[month])));\n\n        this.changeDetectorRef.markForCheck();\n    }\n\n    /** Focuses the active cell after the microtask queue is empty. */\n    focusActiveCell() {\n        this.mcCalendarBody.focusActiveCell();\n    }\n\n    /**\n     * Gets the month in this year that the given Date falls on.\n     * Returns null if the given Date is in another year.\n     */\n    private getMonthInCurrentYear(date: D | null) {\n        return date && this.dateAdapter.getYear(date) === this.dateAdapter.getYear(this.activeDate) ?\n            this.dateAdapter.getMonth(date) : null;\n    }\n\n    /** Creates an McCalendarCell for the given month. */\n    private createCellForMonth(month: number, monthName: string) {\n        const ariaLabel = this.dateAdapter.format(\n            this.dateAdapter.createDate(this.dateAdapter.getYear(this.activeDate), month),\n            this.dateFormats.monthYearA11yLabel\n        );\n\n        const newMonthName = monthName[0].toLocaleUpperCase() + monthName.substr(1);\n\n        return new McCalendarCell(\n            month, newMonthName, ariaLabel, this.shouldEnableMonth(month));\n    }\n\n    /** Whether the given month is enabled. */\n    private shouldEnableMonth(month: number) {\n\n        const activeYear = this.dateAdapter.getYear(this.activeDate);\n\n        if (month === undefined || month === null ||\n            this.isYearAndMonthAfterMaxDate(activeYear, month) ||\n            this.isYearAndMonthBeforeMinDate(activeYear, month)) {\n            return false;\n        }\n\n        if (!this.dateFilter) {\n            return true;\n        }\n\n        const firstOfMonth = this.dateAdapter.createDate(activeYear, month);\n\n        // If any date in the month is enabled count the month as enabled.\n        for (let date = firstOfMonth; this.dateAdapter.getMonth(date) === month;\n             date = this.dateAdapter.addCalendarDays(date, 1)) {\n            if (this.dateFilter(date)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Tests whether the combination month/year is after this.maxDate, considering\n     * just the month and year of this.maxDate\n     */\n    private isYearAndMonthAfterMaxDate(year: number, month: number) {\n        if (this.maxDate) {\n            const maxYear = this.dateAdapter.getYear(this.maxDate);\n            const maxMonth = this.dateAdapter.getMonth(this.maxDate);\n\n            return year > maxYear || (year === maxYear && month > maxMonth);\n        }\n\n        return false;\n    }\n\n    /**\n     * Tests whether the combination month/year is before this.minDate, considering\n     * just the month and year of this.minDate\n     */\n    private isYearAndMonthBeforeMinDate(year: number, month: number) {\n        if (this.minDate) {\n            const minYear = this.dateAdapter.getYear(this.minDate);\n            const minMonth = this.dateAdapter.getMonth(this.minDate);\n\n            return year < minYear || (year === minYear && month < minMonth);\n        }\n\n        return false;\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n\n    /** Determines whether the user has the RTL layout direction. */\n    private isRtl() {\n        return this.dir && this.dir.value === 'rtl';\n    }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","// @ts-nocheck\n\n// tslint:disable:no-empty\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport {\n    Directive,\n    ElementRef,\n    EventEmitter,\n    forwardRef,\n    Inject,\n    Input,\n    OnDestroy,\n    Optional,\n    Output,\n    Renderer2\n} from '@angular/core';\nimport {\n    AbstractControl,\n    ControlValueAccessor,\n    NG_VALIDATORS,\n    NG_VALUE_ACCESSOR,\n    ValidationErrors,\n    Validator,\n    ValidatorFn,\n    Validators\n} from '@angular/forms';\nimport { DateAdapter, MC_DATE_FORMATS, McDateFormats } from '@ptsecurity/cdk/datetime';\nimport {\n    BACKSPACE,\n    DELETE,\n    UP_ARROW,\n    RIGHT_ARROW,\n    DOWN_ARROW,\n    LEFT_ARROW,\n    END,\n    PAGE_DOWN,\n    HOME,\n    PAGE_UP,\n    SPACE,\n    TAB,\n    ESCAPE,\n    hasModifierKey,\n    isHorizontalMovement,\n    isLetterKey,\n    isVerticalMovement\n} from '@ptsecurity/cdk/keycodes';\nimport { validationTooltipHideDelay, validationTooltipShowDelay } from '@ptsecurity/mosaic/core';\nimport { McFormFieldControl } from '@ptsecurity/mosaic/form-field';\nimport { McTooltip } from '@ptsecurity/mosaic/tooltip';\nimport { Subject, Subscription } from 'rxjs';\n\nimport { createMissingDateImplError } from './datepicker-errors';\nimport { McDatepicker } from './datepicker.component';\n\n\n// tslint:disable:naming-convention\nenum DateParts {\n    year = 'y',\n    month = 'm',\n    day = 'd'\n}\n\nclass DateDigit {\n    maxDays = 31;\n    maxMonth = 12;\n\n    parse: (value: string) => number;\n\n    constructor(public value: DateParts, public start: number, public length: number) {\n        if (value === DateParts.day) {\n            this.parse = this.parseDay;\n        } else if (value === DateParts.month) {\n            this.parse = this.parseMonth;\n        } else if (value === DateParts.year) {\n            this.parse = this.parseYear;\n        }\n    }\n\n    get end(): number {\n        return this.start + this.length;\n    }\n\n    get isDay(): boolean {\n        return this.value === DateParts.day;\n    }\n\n    get isMonth(): boolean {\n        return this.value === DateParts.month;\n    }\n\n    get isYear(): boolean {\n        return this.value === DateParts.year;\n    }\n\n    get fullName(): string {\n        if (this.isDay) { return 'date'; }\n\n        if (this.isMonth) { return 'month'; }\n\n        if (this.isYear) { return 'year'; }\n    }\n\n    private parseDay(value: string): number {\n        const parsedValue: number = parseInt(value);\n\n        if (parsedValue === 0) { return 1; }\n\n        if (parsedValue > this.maxDays) { return this.maxDays; }\n\n        return parsedValue;\n    }\n\n    private parseMonth(value: string): number {\n        const parsedValue: number = parseInt(value);\n\n        if (parsedValue === 0) { return 1; }\n\n        if (parsedValue > this.maxMonth) { return this.maxMonth; }\n\n        return parsedValue;\n    }\n\n    private parseYear(value: string): number {\n        const parsedValue: number = parseInt(value);\n\n        if (parsedValue === 0) { return 1; }\n\n        return parsedValue;\n    }\n}\n\n/** @docs-private */\nexport const MC_DATEPICKER_VALUE_ACCESSOR: any = {\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => McDatepickerInput),\n    multi: true\n};\n\n/** @docs-private */\nexport const MC_DATEPICKER_VALIDATORS: any = {\n    provide: NG_VALIDATORS,\n    useExisting: forwardRef(() => McDatepickerInput),\n    multi: true\n};\n\n\n/**\n * An event used for datepicker input and change events. We don't always have access to a native\n * input or change event because the event may have been triggered by the user clicking on the\n * calendar popup. For consistency, we always use McDatepickerInputEvent instead.\n */\nexport class McDatepickerInputEvent<D> {\n    /** The new value for the target datepicker input. */\n    value: D | null;\n\n    constructor(\n        /** Reference to the datepicker input component that emitted the event. */\n        public target: McDatepickerInput<D>,\n        /** Reference to the native input element associated with the datepicker input. */\n        public targetElement: HTMLElement\n    ) {\n        this.value = this.target.value;\n    }\n}\n\nlet uniqueComponentIdSuffix = 0;\n\n\n/** Directive used to connect an input to a McDatepicker. */\n@Directive({\n    selector: 'input[mcDatepicker]',\n    exportAs: 'mcDatepickerInput',\n    providers: [\n        MC_DATEPICKER_VALUE_ACCESSOR,\n        MC_DATEPICKER_VALIDATORS,\n        { provide: McFormFieldControl, useExisting: McDatepickerInput }\n    ],\n    host: {\n        class: 'mc-input mc-datepicker',\n        '[attr.placeholder]': 'placeholder',\n        '[attr.required]': 'required',\n        '[attr.disabled]': 'disabled || null',\n        '[attr.min]': 'min ? toISO8601(min) : null',\n        '[attr.max]': 'max ? toISO8601(max) : null',\n        '[attr.autocomplete]': '\"off\"',\n\n        '(paste)': 'onPaste($event)',\n        '(change)': 'onChange()',\n\n        '(focus)': 'focusChanged(true)',\n        '(blur)': 'onBlur()',\n\n        '(keydown)': 'onKeyDown($event)'\n    }\n})\nexport class McDatepickerInput<D> implements McFormFieldControl<D>, ControlValueAccessor, Validator, OnDestroy {\n    readonly stateChanges: Subject<void> = new Subject<void>();\n\n    readonly errorState: boolean;\n\n    controlType: string = 'datepicker';\n\n    focused: boolean = false;\n\n    datepicker: McDatepicker<D>;\n\n    dateFilter: (date: D | null) => boolean;\n\n    /** Emits when the value changes (either due to user input or programmatic change). */\n    valueChange = new EventEmitter<D | null>();\n\n    /** Emits when the disabled state has changed */\n    disabledChange = new EventEmitter<boolean>();\n\n    @Input() placeholder: string;\n\n    @Input()\n    get required(): boolean {\n        return this._required;\n    }\n\n    set required(value: boolean) {\n        this._required = coerceBooleanProperty(value);\n    }\n\n    private _required: boolean;\n\n    /** The datepicker that this input is associated with. */\n    @Input()\n    set mcDatepicker(value: McDatepicker<D>) {\n        if (!value) { return; }\n\n        this.datepicker = value;\n        this.datepicker.registerInput(this);\n        this.datepickerSubscription.unsubscribe();\n\n        this.datepickerSubscription = this.datepicker.selectedChanged\n            .subscribe((selected: D) => {\n                this.value = selected;\n                this.cvaOnChange(selected);\n                this.onTouched();\n                this.dateChange.emit(new McDatepickerInputEvent(this, this.elementRef.nativeElement));\n            });\n    }\n\n    /** Function that can be used to filter out dates within the datepicker. */\n    @Input()\n    set mcDatepickerFilter(value: (date: D | null) => boolean) {\n        this.dateFilter = value;\n        this.validatorOnChange();\n    }\n\n    /** The value of the input. */\n    @Input()\n    get value(): D | null {\n        return this._value;\n    }\n\n    set value(value: D | null) {\n        let newValue = this.dateAdapter.deserialize(value);\n\n        this.lastValueValid = !newValue || this.dateAdapter.isValid(newValue);\n\n        newValue = this.getValidDateOrNull(newValue);\n\n        const oldDate = this.value;\n        this._value = newValue;\n        this.formatValue(newValue);\n\n        if (!this.dateAdapter.sameDate(oldDate, newValue)) {\n            this.valueChange.emit(newValue);\n        }\n    }\n\n    private _value: D | null;\n\n    /** The minimum valid date. */\n    @Input()\n    get min(): D | null {\n        return this._min;\n    }\n\n    set min(value: D | null) {\n        this._min = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n        this.validatorOnChange();\n    }\n\n    private _min: D | null;\n\n    /** The maximum valid date. */\n    @Input()\n    get max(): D | null {\n        return this._max;\n    }\n\n    set max(value: D | null) {\n        this._max = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n        this.validatorOnChange();\n    }\n\n    private _max: D | null;\n\n    /** Whether the datepicker-input is disabled. */\n    @Input()\n    get disabled(): boolean {\n        return this._disabled;\n    }\n\n    set disabled(value: boolean) {\n        const newValue = coerceBooleanProperty(value);\n        const element = this.elementRef.nativeElement;\n\n        if (this._disabled !== newValue) {\n            this._disabled = newValue;\n            this.disabledChange.emit(newValue);\n        }\n\n        // We need to null check the `blur` method, because it's undefined during SSR.\n        if (newValue && element.blur) {\n            // Normally, native input elements automatically blur if they turn disabled. This behavior\n            // is problematic, because it would mean that it triggers another change detection cycle,\n            // which then causes a changed after checked error if the input element was focused before.\n            element.blur();\n        }\n    }\n\n    private _disabled: boolean = false;\n\n    @Input()\n    get id(): string {\n        return this._id;\n    }\n\n    set id(value: string) {\n        this._id = value || this.uid;\n    }\n\n    private _id: string;\n\n    @Input()\n    set mcValidationTooltip(tooltip: McTooltip) {\n        if (!tooltip) { return; }\n\n        tooltip.mcMouseEnterDelay = validationTooltipShowDelay;\n        tooltip.mcTrigger = 'manual';\n        tooltip.mcTooltipClass = 'mc-tooltip_warning';\n\n        tooltip.initElementRefListeners();\n\n        this.incorrectInput.subscribe(() => {\n            if (tooltip.isTooltipOpen) { return; }\n\n            tooltip.show();\n\n            setTimeout(() => tooltip.hide(), validationTooltipHideDelay);\n        });\n    }\n\n    @Output() incorrectInput = new EventEmitter<void>();\n\n    /** Emits when a `change` event is fired on this `<input>`. */\n    @Output() readonly dateChange = new EventEmitter<McDatepickerInputEvent<D>>();\n\n    /** Emits when an `input` event is fired on this `<input>`. */\n    @Output() readonly dateInput = new EventEmitter<McDatepickerInputEvent<D>>();\n\n    get empty(): boolean {\n        return !this.viewValue && !this.isBadInput();\n    }\n\n    get viewValue(): string {\n        return this.elementRef.nativeElement.value;\n    }\n\n    get ngControl(): any {\n        return this.control;\n    }\n\n    get isReadOnly(): boolean {\n        return this.elementRef.nativeElement.readOnly;\n    }\n\n    private get selectionStart(): number | null {\n        return this.elementRef.nativeElement.selectionStart;\n    }\n\n    private set selectionStart(value: number | null) {\n        this.elementRef.nativeElement.selectionStart = value;\n    }\n\n    private get selectionEnd(): number | null {\n        return this.elementRef.nativeElement.selectionEnd;\n    }\n\n    private set selectionEnd(value: number | null) {\n        this.elementRef.nativeElement.selectionEnd = value;\n    }\n\n    private control: AbstractControl;\n    private readonly uid = `mc-datepicker-${uniqueComponentIdSuffix++}`;\n\n    private datepickerSubscription = Subscription.EMPTY;\n\n    private localeSubscription = Subscription.EMPTY;\n\n    /** Whether the last value set on the input was valid. */\n    private lastValueValid = false;\n\n    /** The combined form control validator for this input. */\n    private readonly validator: ValidatorFn | null;\n\n    private separator: string;\n\n    private firstDigit: DateDigit;\n    private secondDigit: DateDigit;\n    private thirdDigit: DateDigit;\n\n    private separatorPositions: number[];\n\n    constructor(\n        public elementRef: ElementRef<HTMLInputElement>,\n        private readonly renderer: Renderer2,\n        @Optional() private readonly dateAdapter: DateAdapter<D>,\n        @Optional() @Inject(MC_DATE_FORMATS) private readonly dateFormats: McDateFormats\n    ) {\n        this.validator = Validators.compose([\n            this.parseValidator,\n            this.minValidator,\n            this.maxValidator,\n            this.filterValidator\n        ]);\n\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        if (!this.dateFormats) {\n            throw createMissingDateImplError('MC_DATE_FORMATS');\n        }\n\n        this.setFormat(dateFormats.dateInput);\n\n        this.localeSubscription = dateAdapter.localeChanges\n            .subscribe(this.updateLocaleParams);\n    }\n\n    onContainerClick() {\n        this.focus();\n    }\n\n    focus(): void {\n        this.elementRef.nativeElement.focus();\n    }\n\n    focusChanged(isFocused: boolean): void {\n        if (isFocused !== this.focused) {\n            this.focused = isFocused;\n            this.onTouched();\n            this.stateChanges.next();\n        }\n    }\n\n    onTouched = () => {};\n\n    ngOnDestroy() {\n        this.datepickerSubscription.unsubscribe();\n        this.localeSubscription.unsubscribe();\n        this.valueChange.complete();\n        this.disabledChange.complete();\n    }\n\n    /** @docs-private */\n    registerOnValidatorChange(fn: () => void): void {\n        this.validatorOnChange = fn;\n    }\n\n    /** @docs-private */\n    validate(control: AbstractControl): ValidationErrors | null {\n        this.setControl(control);\n\n        return this.validator ? this.validator(control) : null;\n    }\n\n    // Implemented as part of ControlValueAccessor.\n    writeValue(value: D): void {\n        this.value = value;\n    }\n\n    // Implemented as part of ControlValueAccessor.\n    registerOnChange(fn: (value: any) => void): void {\n        this.cvaOnChange = fn;\n    }\n\n    // Implemented as part of ControlValueAccessor.\n    registerOnTouched(fn: () => void): void {\n        this.onTouched = fn;\n    }\n\n    // Implemented as part of ControlValueAccessor.\n    setDisabledState(isDisabled: boolean): void {\n        this.disabled = isDisabled;\n    }\n\n    onKeyDown(event: KeyboardEvent): void {\n        if (this.isReadOnly) { return; }\n\n        // tslint:disable-next-line: deprecation\n        const keyCode = event.keyCode;\n\n        if (this.isLetterKey(event)) {\n            event.preventDefault();\n\n            this.incorrectInput.emit();\n        } else if (this.isKeyForOpen(event)) {\n            event.preventDefault();\n\n            this.datepicker.open();\n        } else if (this.isKeyForClose(event)) {\n            event.preventDefault();\n\n            this.datepicker.close();\n        } else if (keyCode === TAB) {\n            this.datepicker.close(false);\n        } else if (this.isKeyForByPass(event)) {\n            return;\n        } else if (keyCode === SPACE) {\n            this.spaceKeyHandler(event);\n        } else if ([UP_ARROW, DOWN_ARROW].includes(keyCode)) {\n            event.preventDefault();\n\n            this.verticalArrowKeyHandler(keyCode);\n        } else if ([LEFT_ARROW, RIGHT_ARROW, HOME, PAGE_UP, END, PAGE_DOWN].includes(keyCode)) {\n            event.preventDefault();\n\n            this.changeCaretPosition(keyCode);\n        } else if (/^\\D$/.test(event.key)) {\n            event.preventDefault();\n\n            const newValue = this.getNewValue(event.key, this.selectionStart as number);\n            const formattedValue = this.replaceSymbols(newValue);\n\n            if (newValue !== formattedValue) {\n                this.setViewValue(formattedValue, true);\n\n                setTimeout(this.onInput);\n            } else {\n                this.incorrectInput.emit();\n            }\n        } else {\n            setTimeout(this.onInput);\n        }\n    }\n\n    onInput = () => {\n        this.correctCursorPosition();\n        const formattedValue = this.replaceSymbols(this.viewValue);\n\n        const newTimeObj = this.getDateFromString(formattedValue);\n        this.lastValueValid = !!newTimeObj;\n\n        if (!newTimeObj) {\n            this.control.updateValueAndValidity();\n            this._value = null;\n\n            return;\n        }\n\n        this.setViewValue(this.getTimeStringFromDate(newTimeObj, this.dateFormats.dateInput), true);\n\n        this.selectNextDigitByCursor((this.selectionStart as number));\n\n        this.updateValue(newTimeObj);\n    }\n\n    parseOnBlur = () => {\n        if (!this.viewValue) { return null; }\n\n        const date = this.getDefaultValue();\n\n        const viewDigits: string[] = this.viewValue\n            .split(this.separator)\n            .map((value: string) => value)\n            .filter((value) => value);\n\n        const [firsViewDigit, secondViewDigit, thirdViewDigit] = viewDigits;\n\n        // tslint:disable-next-line:no-magic-numbers\n        if (viewDigits.length !== 3) {\n            this.lastValueValid = false;\n            this._value = null;\n\n            return setTimeout(() => this.control.updateValueAndValidity());\n        }\n\n        date[this.firstDigit.fullName] = this.firstDigit.parse(firsViewDigit);\n        date[this.secondDigit.fullName] = this.secondDigit.parse(secondViewDigit);\n        date[this.thirdDigit.fullName] = this.thirdDigit.parse(thirdViewDigit);\n\n        const [digitWithYear, viewDigitWithYear] = [this.firstDigit, this.secondDigit, this.thirdDigit]\n            .reduce((acc, digit, index) => digit.value === DateParts.year ? [digit, viewDigits[index]] : acc, []);\n\n        // tslint:disable-next-line:no-magic-numbers\n        if (viewDigitWithYear.length < 3) {\n            // tslint:disable-next-line:no-magic-numbers\n            date.year += date.year < 30 ? 2000 : 1900;\n        } else if (viewDigitWithYear.length < digitWithYear.length) {\n            this.lastValueValid = false;\n            this._value = null;\n\n            return setTimeout(() => this.control.updateValueAndValidity());\n        }\n\n        const newTimeObj = this.getValidDateOrNull(this.dateAdapter.createDateTime(\n            date.year, date.month - 1, date.date, date.hours, date.minutes, date.seconds, date.milliseconds\n        ));\n\n        this.lastValueValid = !!newTimeObj;\n\n        this.setViewValue(this.getTimeStringFromDate(newTimeObj, this.dateFormats.dateInput), true);\n\n        this.updateValue(newTimeObj);\n    }\n\n    onChange() {\n        this.dateChange.emit(new McDatepickerInputEvent(this, this.elementRef.nativeElement));\n    }\n\n    /** Handles blur events on the input. */\n    onBlur() {\n        // Reformat the input only if we have a valid value.\n        this.parseOnBlur();\n\n        this.focusChanged(false);\n    }\n\n    onPaste($event) {\n        $event.preventDefault();\n\n        const rawValue = $event.clipboardData.getData('text');\n\n        const match: RegExpMatchArray | null = rawValue.match(/^(?<first>\\d+)\\W(?<second>\\d+)\\W(?<third>\\d+)$/);\n\n        if (!match?.groups?.first || !match?.groups?.second || !match?.groups?.third) {\n            this.setViewValue(rawValue);\n\n            return rawValue;\n        }\n\n        const value = [match.groups.first, match.groups.second, match.groups.third].join(this.separator);\n\n        const newTimeObj = this.getDateFromString(value);\n\n        if (!newTimeObj) {\n            this.setViewValue(value);\n\n            return value;\n        }\n\n        this.setViewValue(this.getTimeStringFromDate(newTimeObj, this.dateFormats.dateInput));\n\n        this.updateValue(newTimeObj);\n    }\n\n    toISO8601(value: D): string {\n        return this.dateAdapter.toIso8601(value);\n    }\n\n    private updateLocaleParams = () => {\n        this.setFormat(this.dateFormats.dateInput);\n\n        this.value = this.value;\n    }\n\n    private setFormat(format: string): void {\n        this.separator = format.match(/[aA-zZ]+(?<separator>\\W|\\D)[aA-zZ]+/)!.groups.separator;\n        this.separatorPositions = format\n            .split('')\n            .reduce((acc, item, index: number) => this.separator === item ? [...acc, index + 1] : acc, []);\n\n        this.getDigitPositions(format);\n    }\n\n    private updateValue(newValue: D) {\n        if (!this.dateAdapter.sameDate(newValue, this.value)) {\n            this._value = newValue;\n            this.cvaOnChange(newValue);\n            this.valueChange.emit(newValue);\n            this.dateInput.emit(new McDatepickerInputEvent(this, this.elementRef.nativeElement));\n        }\n\n        this.control.updateValueAndValidity();\n    }\n\n    private isKeyForClose(event: KeyboardEvent): boolean {\n        // tslint:disable-next-line: deprecation\n        return (event.altKey && event.keyCode === UP_ARROW) || event.keyCode === ESCAPE;\n    }\n\n    private isKeyForOpen(event: KeyboardEvent): boolean {\n        // tslint:disable-next-line: deprecation\n        return event.altKey && event.keyCode === DOWN_ARROW;\n    }\n\n    private isLetterKey(event: KeyboardEvent): boolean {\n        return isLetterKey(event) && !event.ctrlKey && !event.metaKey;\n    }\n\n    private isKeyForByPass(event: KeyboardEvent): boolean {\n        // tslint:disable-next-line: deprecation\n        return (hasModifierKey(event) && (isVerticalMovement(event.keyCode) || isHorizontalMovement(event.keyCode))) ||\n            event.ctrlKey ||\n            event.metaKey ||\n            // tslint:disable-next-line: deprecation\n            [DELETE, BACKSPACE].includes(event.keyCode);\n    }\n\n    private spaceKeyHandler(event: KeyboardEvent) {\n        event.preventDefault();\n\n        if (this.selectionStart === this.selectionEnd) {\n            const value = this.getNewValue(event.key, this.selectionStart as number);\n            this.setViewValue(value);\n\n            setTimeout(this.onInput);\n        } else if (this.selectionStart !== this.selectionEnd) {\n            this.selectNextDigit(this.selectionStart as number, true);\n        }\n    }\n\n    private getNewValue(key: string, position: number) {\n        return [this.viewValue.slice(0, position), key, this.viewValue.slice(position)].join('');\n    }\n\n    private setViewValue(value: string, savePosition: boolean = false) {\n        if (savePosition) {\n            const selectionStart = this.selectionStart;\n            const selectionEnd = this.selectionEnd;\n\n            this.renderer.setProperty(this.elementRef.nativeElement, 'value', value);\n\n            this.selectionStart = selectionStart;\n            this.selectionEnd = selectionEnd;\n        } else {\n            this.renderer.setProperty(this.elementRef.nativeElement, 'value', value);\n        }\n    }\n\n    private replaceSymbols(value: string): string {\n        return value\n            .split(this.separator)\n            .map((part: string) => part.replace(/^([0-9]+)\\W$/, '0$1'))\n            .join(this.separator);\n    }\n\n    private getDateFromString(timeString: string): D | null {\n        if (!timeString || timeString.length < this.firstDigit.length) { return null; }\n\n        const date = this.getDefaultValue();\n\n        const viewDigits: string[] = timeString\n            .split(this.separator)\n            .map((value: string) => value);\n\n        const [firsViewDigit, secondViewDigit, thirdViewDigit] = viewDigits;\n\n        if (viewDigits.length === 1) {\n            if (firsViewDigit.length < this.firstDigit.length) { return null; }\n\n\n            date[this.firstDigit.fullName] = this.firstDigit.parse(firsViewDigit);\n            date.month = 1;\n        // tslint:disable-next-line:no-magic-numbers\n        } else if (viewDigits.length === 2) {\n            if (firsViewDigit.length < this.firstDigit.length || secondViewDigit.length < this.secondDigit.length) {\n                return null;\n            }\n\n            date[this.firstDigit.fullName] = this.firstDigit.parse(firsViewDigit);\n            date[this.secondDigit.fullName] = this.secondDigit.parse(secondViewDigit);\n        // tslint:disable-next-line:no-magic-numbers\n        } else if (viewDigits.length === 3) {\n            if (\n                firsViewDigit.length < this.firstDigit.length ||\n                secondViewDigit.length < this.secondDigit.length ||\n                thirdViewDigit.length < this.thirdDigit.length\n            ) { return null; }\n\n            date[this.firstDigit.fullName] = this.firstDigit.parse(firsViewDigit);\n            date[this.secondDigit.fullName] = this.secondDigit.parse(secondViewDigit);\n            date[this.thirdDigit.fullName] = this.thirdDigit.parse(thirdViewDigit);\n        } else {\n            return null;\n        }\n\n        return this.getValidDateOrNull(this.dateAdapter.createDateTime(\n            date.year, date.month - 1, date.date, date.hours, date.minutes, date.seconds, date.milliseconds\n        ));\n    }\n\n    private getDefaultValue() {\n        const defaultValue = this.value || this.dateAdapter.today();\n\n        return {\n            year: this.dateAdapter.getYear(defaultValue),\n            month: this.dateAdapter.getMonth(defaultValue),\n            date: this.dateAdapter.getDate(defaultValue),\n            hours: this.dateAdapter.getHours(defaultValue),\n            minutes: this.dateAdapter.getMinutes(defaultValue),\n            seconds: this.dateAdapter.getSeconds(defaultValue),\n            milliseconds: this.dateAdapter.getMilliseconds(defaultValue)\n        };\n    }\n\n    private getTimeStringFromDate(value: D | null, timeFormat: string): string {\n        if (!value || !this.dateAdapter.isValid(value)) { return ''; }\n\n        return this.dateAdapter.format(value, timeFormat);\n    }\n\n    private getDateEditMetrics(cursorPosition: number): [\n        modifiedTimePart: DateParts,\n        cursorStartPosition: number,\n        cursorEndPosition: number\n    ] {\n        for (const digit of [this.firstDigit, this.secondDigit, this.thirdDigit]) {\n            if (cursorPosition >= digit.start && cursorPosition <= digit.end) {\n                return [digit.value, digit.start, digit.end];\n            }\n        }\n\n        return [this.thirdDigit.value, this.thirdDigit.start, this.thirdDigit.end];\n    }\n\n    private incrementDate(dateVal: D, whatToIncrement: DateParts): D {\n        let year = this.dateAdapter.getYear(dateVal);\n        let month = this.dateAdapter.getMonth(dateVal);\n        let day = this.dateAdapter.getDate(dateVal);\n\n        switch (whatToIncrement) {\n            case DateParts.day:\n                day++;\n\n                if (day > this.dateAdapter.getNumDaysInMonth(dateVal)) {\n                    day = 1;\n                }\n\n                break;\n            case DateParts.month:\n                month++;\n\n                // tslint:disable-next-line:no-magic-numbers\n                if (month > 11) {\n                    month = 0;\n                }\n\n                const lastDay = this.getLastDayFor(year, month);\n\n                if (day > lastDay) {\n                    day = lastDay;\n                }\n\n                break;\n            case DateParts.year:\n                year++;\n\n                break;\n            default:\n        }\n\n        return this.createDate(year, month, day);\n    }\n\n    private getLastDayFor(year: number, month: number): number {\n        return this.dateAdapter.getNumDaysInMonth(this.createDate(year, month, 1));\n    }\n\n    private decrementDate(dateVal: D, whatToDecrement: DateParts): D {\n        let year = this.dateAdapter.getYear(dateVal);\n        let month = this.dateAdapter.getMonth(dateVal);\n        let day = this.dateAdapter.getDate(dateVal);\n\n        switch (whatToDecrement) {\n            case DateParts.day:\n                day--;\n\n                if (day < 1) {\n                    day = this.dateAdapter.getNumDaysInMonth(dateVal);\n                }\n\n                break;\n            case DateParts.month:\n                month--;\n\n                if (month < 0) {\n                    // tslint:disable-next-line:no-magic-numbers\n                    month = 11;\n                }\n\n                const lastDay = this.getLastDayFor(year, month);\n\n                if (day > lastDay) {\n                    day = lastDay;\n                }\n\n                break;\n            case DateParts.year:\n                year--;\n\n                break;\n            default:\n        }\n\n        return this.createDate(year, month, day);\n    }\n\n    private verticalArrowKeyHandler(keyCode: number): void {\n        if (!this.value) { return; }\n\n        let changedTime;\n\n        const [modifiedTimePart, selectionStart, selectionEnd] = this.getDateEditMetrics(this.selectionStart as number);\n\n        if (keyCode === UP_ARROW) {\n            changedTime = this.incrementDate(this.value, modifiedTimePart);\n        }\n\n        if (keyCode === DOWN_ARROW) {\n            changedTime = this.decrementDate(this.value, modifiedTimePart);\n        }\n\n        this.value = changedTime;\n\n        this.selectionStart = selectionStart;\n        this.selectionEnd = selectionEnd;\n\n        this.onChange();\n        this.stateChanges.next();\n    }\n\n    private changeCaretPosition(keyCode: number): void {\n        if (!this.value) { return; }\n\n        let cursorPos = this.selectionStart as number;\n\n        if ([HOME, PAGE_UP].includes(keyCode)) {\n            cursorPos = 0;\n        } else if ([END, PAGE_DOWN].includes(keyCode)) {\n            cursorPos = this.viewValue.length;\n        } else if (keyCode === LEFT_ARROW) {\n            cursorPos = cursorPos === 0 ? this.viewValue.length : cursorPos - 1;\n        } else if (keyCode === RIGHT_ARROW) {\n            const nextSeparatorPos: number = this.viewValue.indexOf(this.separator, cursorPos);\n\n            cursorPos = nextSeparatorPos ? nextSeparatorPos + 1 : 0;\n        }\n\n        this.selectDigitByCursor(cursorPos);\n    }\n\n    private selectDigitByCursor(cursorPos: number): void {\n        setTimeout(() => {\n            const [, selectionStart, selectionEnd] = this.getDateEditMetrics(cursorPos);\n\n            this.selectionStart = selectionStart;\n            this.selectionEnd = selectionEnd;\n        });\n    }\n\n    private selectNextDigitByCursor(cursorPos: number): void {\n        setTimeout(() => {\n            const [, , endPositionOfCurrentDigit] = this.getDateEditMetrics(cursorPos);\n            const [, selectionStart, selectionEnd] = this.getDateEditMetrics(endPositionOfCurrentDigit + 1);\n\n            this.selectionStart = selectionStart;\n            this.selectionEnd = selectionEnd;\n        });\n    }\n\n    private selectNextDigit(cursorPos: number, cycle: boolean = false): void {\n        setTimeout(() => {\n            const lastValue = cycle ? 0 : cursorPos;\n            const nextSeparatorPos: number = this.viewValue.indexOf(this.separator, cursorPos);\n\n            const newCursorPos = nextSeparatorPos > 0 ? nextSeparatorPos + 1 : lastValue;\n\n            const [, selectionStart, selectionEnd] = this.getDateEditMetrics(newCursorPos);\n\n            this.selectionStart = selectionStart;\n            this.selectionEnd = selectionEnd;\n        });\n    }\n\n    /** Checks whether the input is invalid based on the native validation. */\n    private isBadInput(): boolean {\n        const validity = (<HTMLInputElement> this.elementRef.nativeElement).validity;\n\n        return validity && validity.badInput;\n    }\n\n    private cvaOnChange: (value: any) => void = () => {};\n\n    private validatorOnChange = () => {};\n\n    /** The form control validator for whether the input parses. */\n    private parseValidator: ValidatorFn = (): ValidationErrors | null => {\n        return this.focused ||\n            this.empty ||\n            this.lastValueValid ? null : { mcDatepickerParse: { text: this.elementRef.nativeElement.value } };\n    }\n\n    /** The form control validator for the min date. */\n    private minValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\n        const controlValue = this.getValidDateOrNull(this.dateAdapter.deserialize(control.value));\n\n        return (!this.min || !controlValue ||\n            this.dateAdapter.compareDate(this.min, controlValue) <= 0) ?\n            null : { mcDatepickerMin: { min: this.min, actual: controlValue } };\n    }\n\n    /** The form control validator for the max date. */\n    private maxValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\n        const controlValue = this.getValidDateOrNull(this.dateAdapter.deserialize(control.value));\n\n        return (!this.max || !controlValue ||\n            this.dateAdapter.compareDate(this.max, controlValue) >= 0) ?\n            null : { mcDatepickerMax: { max: this.max, actual: controlValue } };\n    }\n\n    /** The form control validator for the date filter. */\n    private filterValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\n        const controlValue = this.getValidDateOrNull(this.dateAdapter.deserialize(control.value));\n\n        return !this.dateFilter || !controlValue || this.dateFilter(controlValue) ?\n            null : { mcDatepickerFilter: true };\n    }\n\n    /** Formats a value and sets it on the input element. */\n    private formatValue(value: D | null) {\n        const formattedValue = value ? this.dateAdapter.format(value, this.dateFormats.dateInput) : '';\n\n        this.setViewValue(formattedValue);\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n\n    private setControl(control: AbstractControl) {\n        if (!this.control) {\n            this.control = control;\n        }\n    }\n\n    private getDigitPositions(format: string) {\n        const formatInLowerCase = format.toLowerCase();\n\n        formatInLowerCase\n            .split('')\n            .reduce(\n                ({ prev, length, start }, value: string, index: number, arr) => {\n                    if (value === this.separator || (arr.length - 1) === index) {\n                        if (!this.firstDigit) {\n                            this.firstDigit = new DateDigit(prev, start, length);\n                        } else if (!this.secondDigit) {\n                            this.secondDigit = new DateDigit(prev, start, length);\n                        } else if (!this.thirdDigit) {\n                            this.thirdDigit = new DateDigit(prev, start, arr.length - start);\n                        }\n\n                        // tslint:disable:no-parameter-reassignment\n                        length = 0;\n                        start = index + 1;\n                    } else {\n                        length++;\n                    }\n\n                    return { prev: value, length, start };\n                },\n                { length: 0, start: 0 }\n            );\n\n        if (!this.firstDigit || !this.secondDigit || !this.thirdDigit) {\n            Error(`Can' t use this format: ${format}`);\n        }\n    }\n\n    private createDate(year: number, month: number, day: number): D {\n        return this.dateAdapter.createDateTime(\n            year,\n            month,\n            day,\n            this.dateAdapter.getHours(this.value as D),\n            this.dateAdapter.getMinutes(this.value as D),\n            this.dateAdapter.getSeconds(this.value as D),\n            this.dateAdapter.getMilliseconds(this.value as D)\n        );\n    }\n\n    private correctCursorPosition() {\n        if (this.selectionStart && this.separatorPositions.includes(this.selectionStart)) {\n            this.selectionStart = this.selectionStart - 1;\n        }\n    }\n}\n","import { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport {\n    AfterContentInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ContentChild,\n    Directive,\n    Input,\n    OnChanges,\n    OnDestroy,\n    SimpleChanges,\n    ViewEncapsulation,\n    ViewChild\n} from '@angular/core';\nimport { McButton } from '@ptsecurity/mosaic/button';\nimport { merge, of as observableOf, Subscription } from 'rxjs';\n\nimport { McDatepickerIntl } from './datepicker-intl';\nimport { McDatepicker } from './datepicker.component';\n\n\n/** Can be used to override the icon of a `mcDatepickerToggle`. */\n@Directive({\n    selector: '[mcDatepickerToggleIcon]'\n})\nexport class McDatepickerToggleIcon {}\n\n\n@Component({\n    selector: 'mc-datepicker-toggle',\n    templateUrl: 'datepicker-toggle.html',\n    styleUrls: ['datepicker-toggle.scss'],\n    host: {\n        class: 'mc-datepicker-toggle',\n        '[class.mc-active]': 'datepicker && datepicker.opened'\n    },\n    exportAs: 'mcDatepickerToggle',\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McDatepickerToggle<D> implements AfterContentInit, OnChanges, OnDestroy {\n    /** Whether the toggle button is disabled. */\n    @Input()\n    get disabled(): boolean {\n        return this._disabled === undefined ? this.datepicker.disabled : this._disabled;\n    }\n\n    set disabled(value: boolean) {\n        this._disabled = coerceBooleanProperty(value);\n    }\n\n    /** Datepicker instance that the button will toggle. */\n    @Input('for') datepicker: McDatepicker<D>;\n\n    /** Tabindex for the toggle. */\n    @Input() tabIndex: number | null;\n\n    /** Custom icon set by the consumer. */\n    @ContentChild(McDatepickerToggleIcon, { static: false }) customIcon: McDatepickerToggleIcon;\n\n    /** Underlying button element. */\n    @ViewChild('button', { static: false }) button: McButton;\n    private stateChanges = Subscription.EMPTY;\n\n    private _disabled: boolean;\n\n    constructor(public intl: McDatepickerIntl, private changeDetectorRef: ChangeDetectorRef) {}\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes.datepicker) {\n            this.watchStateChanges();\n        }\n    }\n\n    ngOnDestroy() {\n        this.stateChanges.unsubscribe();\n    }\n\n    ngAfterContentInit() {\n        this.watchStateChanges();\n    }\n\n    open(event: Event): void {\n        if (this.datepicker && !this.disabled) {\n            this.datepicker.open();\n            event.stopPropagation();\n        }\n    }\n\n    private watchStateChanges() {\n        const datepickerDisabled = this.datepicker ? this.datepicker.disabledChange : observableOf();\n\n        const inputDisabled = this.datepicker && this.datepicker.datepickerInput ?\n            this.datepicker.datepickerInput.disabledChange : observableOf();\n\n        const datepickerToggled = this.datepicker ?\n            merge(this.datepicker.openedStream, this.datepicker.closedStream) :\n            observableOf();\n\n        this.stateChanges.unsubscribe();\n\n        this.stateChanges = merge(\n            this.intl.changes,\n            datepickerDisabled,\n            inputDisabled,\n            datepickerToggled\n        ).subscribe(() => this.changeDetectorRef.markForCheck());\n    }\n}\n","import {\n    animate,\n    state,\n    style,\n    transition,\n    trigger,\n    AnimationTriggerMetadata\n} from '@angular/animations';\n\n\n/**\n * Animations used by the mosaic datepicker.\n * @docs-private\n */\nexport const mcDatepickerAnimations: {\n    readonly transformPanel: AnimationTriggerMetadata;\n    readonly fadeInCalendar: AnimationTriggerMetadata;\n} = {\n    /** Transforms the height of the datepicker's calendar. */\n    transformPanel: trigger('transformPanel', [\n        state('void', style({\n            opacity: 0,\n            transform: 'scale(1, 0.8)'\n        })),\n        transition('void => enter', animate('120ms cubic-bezier(0, 0, 0.2, 1)', style({\n            opacity: 1,\n            transform: 'scale(1, 1)'\n        }))),\n        transition('* => void', animate('100ms linear', style({ opacity: 0 })))\n    ]),\n\n    /** Fades in the content of the calendar. */\n    fadeInCalendar: trigger('fadeInCalendar', [\n        state('void', style({ opacity: 0 })),\n        state('enter', style({ opacity: 1 })),\n\n        // need to keep it until #12440 gets in, otherwise the exit animation will look glitchy.\n        transition('void => *', animate('120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)'))\n    ])\n};\n\n// todo should be put into polyfils\n// https://github.com/angular/angular/issues/24769\nif (!Element.prototype.matches) {\n    Element.prototype.matches = (Element.prototype as any).msMatchesSelector;\n}\n","// tslint:disable:no-unbound-method\n// tslint:disable:no-magic-numbers\nimport { Directionality } from '@angular/cdk/bidi';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport {\n    Overlay,\n    OverlayConfig,\n    OverlayRef,\n    PositionStrategy,\n    ScrollStrategy\n} from '@angular/cdk/overlay';\nimport { ComponentPortal, ComponentType } from '@angular/cdk/portal';\nimport { DOCUMENT } from '@angular/common';\nimport {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ComponentRef,\n    EventEmitter,\n    Inject,\n    InjectionToken,\n    Input,\n    NgZone,\n    OnDestroy,\n    Optional,\n    Output,\n    ViewChild,\n    ViewContainerRef,\n    ViewEncapsulation\n} from '@angular/core';\nimport { DateAdapter } from '@ptsecurity/cdk/datetime';\nimport { McFormFieldControl } from '@ptsecurity/mosaic/form-field';\nimport { merge, Subject, Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\n\nimport { McCalendarCellCssClasses } from './calendar-body.component';\nimport { McCalendar, McCalendarView } from './calendar.component';\nimport { mcDatepickerAnimations } from './datepicker-animations';\nimport { createMissingDateImplError } from './datepicker-errors';\nimport { McDatepickerInput } from './datepicker-input.directive';\n\n\n/** Used to generate a unique ID for each datepicker instance. */\nlet datepickerUid = 0;\n\n/** Injection token that determines the scroll handling while the calendar is open. */\nexport const MC_DATEPICKER_SCROLL_STRATEGY =\n    new InjectionToken<() => ScrollStrategy>('mc-datepicker-scroll-strategy');\n\n/** @docs-private */\n// tslint:disable-next-line:naming-convention\nexport function MC_DATEPICKER_SCROLL_STRATEGY_FACTORY(overlay: Overlay): () => ScrollStrategy {\n    return () => overlay.scrollStrategies.reposition();\n}\n\n/** @docs-private */\nexport const MC_DATEPICKER_SCROLL_STRATEGY_FACTORY_PROVIDER = {\n    provide: MC_DATEPICKER_SCROLL_STRATEGY,\n    deps: [Overlay],\n    useFactory: MC_DATEPICKER_SCROLL_STRATEGY_FACTORY\n};\n\n/**\n * Component used as the content for the datepicker dialog and popup. We use this instead of using\n * McCalendar directly as the content so we can control the initial focus. This also gives us a\n * place to put additional features of the popup that are not part of the calendar itself in the\n * future. (e.g. confirmation buttons).\n * @docs-private\n */\n@Component({\n    selector: 'mc-datepicker__content',\n    exportAs: 'mcDatepickerContent',\n    templateUrl: 'datepicker-content.html',\n    styleUrls: ['datepicker-content.scss'],\n    host: {\n        class: 'mc-datepicker__content',\n\n        '[@transformPanel]': 'animationState',\n        '(@transformPanel.done)': 'animationDone.next()'\n    },\n    animations: [\n        mcDatepickerAnimations.transformPanel,\n        mcDatepickerAnimations.fadeInCalendar\n    ],\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class McDatepickerContent<D> implements OnDestroy {\n    /** Emits when an animation has finished. */\n    readonly animationDone = new Subject<void>();\n\n    /** Reference to the datepicker that created the overlay. */\n    datepicker: McDatepicker<D>;\n\n    /** Current state of the animation. */\n    animationState: 'enter' | 'void';\n\n    /** Reference to the internal calendar component. */\n    @ViewChild(McCalendar) calendar: McCalendar<D>;\n\n    private subscriptions = new Subscription();\n\n    constructor(private changeDetectorRef: ChangeDetectorRef) {}\n\n    ngAfterViewInit() {\n        this.subscriptions.add(this.datepicker.stateChanges.subscribe(() => {\n            this.changeDetectorRef.markForCheck();\n        }));\n    }\n\n    ngOnDestroy() {\n        this.subscriptions.unsubscribe();\n        this.animationDone.complete();\n    }\n\n    startExitAnimation() {\n        this.animationState = 'void';\n        this.changeDetectorRef.markForCheck();\n    }\n}\n\n\n// TODO: We use a component instead of a directive here so the user can use implicit\n// template reference variables (e.g. #d vs #d=\"mcDatepicker\"). We can change this to a directive\n// if angular adds support for `exportAs: '$implicit'` on directives.\n/** Component responsible for managing the datepicker popup/dialog. */\n@Component({\n    selector: 'mc-datepicker',\n    template: '',\n    exportAs: 'mcDatepicker',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    providers: [{ provide: McFormFieldControl, useExisting: McDatepicker }]\n})\nexport class McDatepicker<D> implements OnDestroy {\n    @Input()\n    get hasBackdrop(): boolean {\n        return this._hasBackdrop;\n    }\n\n    set hasBackdrop(value: boolean) {\n        this._hasBackdrop = coerceBooleanProperty(value);\n    }\n\n    private _hasBackdrop: boolean = false;\n\n    /** The date to open the calendar to initially. */\n    @Input()\n    get startAt(): D | null {\n        // If an explicit startAt is set we start there, otherwise we start at whatever the currently\n        // selected value is.\n        return this._startAt || (this.datepickerInput ? this.datepickerInput.value : null);\n    }\n\n    set startAt(value: D | null) {\n        this._startAt = this.getValidDateOrNull(this.dateAdapter.deserialize(value));\n    }\n\n    private _startAt: D | null;\n\n    /** Whether the datepicker pop-up should be disabled. */\n    @Input()\n    get disabled(): boolean {\n        return this._disabled === undefined && this.datepickerInput ? this.datepickerInput.disabled : this._disabled;\n    }\n\n    set disabled(value: boolean) {\n        const newValue = coerceBooleanProperty(value);\n\n        if (newValue !== this._disabled) {\n            this._disabled = newValue;\n            this.disabledChange.next(newValue);\n        }\n    }\n\n    private _disabled: boolean;\n\n    /** Whether the calendar is open. */\n    @Input()\n    get opened(): boolean {\n        return this._opened;\n    }\n\n    set opened(value: boolean) {\n        coerceBooleanProperty(value) ? this.open() : this.close();\n    }\n\n    private _opened = false;\n\n    /** The currently selected date. */\n    get selected(): D | null {\n        return this.validSelected;\n    }\n\n    set selected(value: D | null) {\n        this.validSelected = value;\n    }\n\n    /** The minimum selectable date. */\n    get minDate(): D | null {\n        return this.datepickerInput && this.datepickerInput.min;\n    }\n\n    /** The maximum selectable date. */\n    get maxDate(): D | null {\n        return this.datepickerInput && this.datepickerInput.max;\n    }\n\n    get dateFilter(): (date: D | null) => boolean {\n        return this.datepickerInput && this.datepickerInput.dateFilter;\n    }\n\n    get value(): D | null {\n        return this.selected;\n    }\n\n    /** An input indicating the type of the custom header component for the calendar, if set. */\n    @Input() calendarHeaderComponent: ComponentType<any>;\n\n    /** The view that the calendar should start in. */\n    @Input() startView: McCalendarView = McCalendarView.Month;\n\n    /**\n     * Emits selected year in multiyear view.\n     * This doesn't imply a change on the selected date.\n     */\n    @Output() readonly yearSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /**\n     * Emits selected month in year view.\n     * This doesn't imply a change on the selected date.\n     */\n    @Output() readonly monthSelected: EventEmitter<D> = new EventEmitter<D>();\n\n    /** Classes to be passed to the date picker panel. Supports the same syntax as `ngClass`. */\n    @Input() panelClass: string | string[];\n\n    /** Function that can be used to add custom CSS classes to dates. */\n    @Input() dateClass: (date: D) => McCalendarCellCssClasses;\n\n    @Input() backdropClass: string = 'cdk-overlay-transparent-backdrop';\n\n    /** Emits when the datepicker has been opened. */\n    @Output('opened') openedStream: EventEmitter<void> = new EventEmitter<void>();\n\n    /** Emits when the datepicker has been closed. */\n    @Output('closed') closedStream: EventEmitter<void> = new EventEmitter<void>();\n\n    /** The id for the datepicker calendar. */\n    id: string = `mc-datepicker-${datepickerUid++}`;\n\n    /** A reference to the overlay when the calendar is opened as a popup. */\n    popupRef: OverlayRef | null;\n\n    /** The input element this datepicker is associated with. */\n    datepickerInput: McDatepickerInput<D>;\n\n    readonly stateChanges: Subject<void> = new Subject<void>();\n\n    /** Emits when the datepicker is disabled. */\n    readonly disabledChange = new Subject<boolean>();\n\n    /** Emits new selected date when selected date changes. */\n    readonly selectedChanged = new Subject<D>();\n    private scrollStrategy: () => ScrollStrategy;\n    private validSelected: D | null = null;\n\n    /** A portal containing the calendar for this datepicker. */\n    private calendarPortal: ComponentPortal<McDatepickerContent<D>>;\n\n    /** Reference to the component instantiated in popup mode. */\n    private popupComponentRef: ComponentRef<McDatepickerContent<D>> | null;\n\n    /** The element that was focused before the datepicker was opened. */\n    private focusedElementBeforeOpen: HTMLElement | null = null;\n\n    /** Subscription to value changes in the associated input element. */\n    private inputSubscription = Subscription.EMPTY;\n\n    private closeSubscription = Subscription.EMPTY;\n\n    constructor(\n        private overlay: Overlay,\n        private ngZone: NgZone,\n        private viewContainerRef: ViewContainerRef,\n        @Inject(MC_DATEPICKER_SCROLL_STRATEGY) scrollStrategy: any,\n        @Optional() private readonly dateAdapter: DateAdapter<D>,\n        @Optional() private dir: Directionality,\n        @Optional() @Inject(DOCUMENT) private document: any\n    ) {\n        if (!this.dateAdapter) {\n            throw createMissingDateImplError('DateAdapter');\n        }\n\n        this.scrollStrategy = scrollStrategy;\n    }\n\n    ngOnDestroy() {\n        this.close();\n        this.inputSubscription.unsubscribe();\n        this.closeSubscription.unsubscribe();\n        this.disabledChange.complete();\n\n        this.destroyOverlay();\n    }\n\n    /** Selects the given date */\n    select(date: D): void {\n        const oldValue = this.selected;\n        this.selected = date;\n\n        if (!this.dateAdapter.sameDate(oldValue, this.selected)) {\n            this.selectedChanged.next(date);\n        }\n    }\n\n    /** Emits the selected year in multiyear view */\n    selectYear(normalizedYear: D): void {\n        this.yearSelected.emit(normalizedYear);\n    }\n\n    /** Emits selected month in year view */\n    selectMonth(normalizedMonth: D): void {\n        this.monthSelected.emit(normalizedMonth);\n    }\n\n    /**\n     * Register an input with this datepicker.\n     * @param input The datepicker input to register with this datepicker.\n     */\n    registerInput(input: McDatepickerInput<D>): void {\n        if (this.datepickerInput) {\n            throw Error('A McDatepicker can only be associated with a single input.');\n        }\n\n        this.datepickerInput = input;\n        this.inputSubscription = this.datepickerInput.valueChange\n            .subscribe((value: D | null) => {\n                this.selected = value;\n                // @ts-ignore\n                if (this.popupComponentRef) {\n                    this.popupComponentRef.instance.calendar.monthView?.init();\n                    this.popupComponentRef.instance.calendar.activeDate = value as D;\n                }\n            });\n    }\n\n    /** Open the calendar. */\n    open(): void {\n        if (this._opened || this.disabled) { return; }\n\n        if (!this.datepickerInput) {\n            throw Error('Attempted to open an McDatepicker with no associated input.');\n        }\n\n        if (this.document) {\n            this.focusedElementBeforeOpen = this.document.activeElement;\n        }\n\n        this.openAsPopup();\n\n        this._opened = true;\n        this.openedStream.emit();\n    }\n\n    /** Close the calendar. */\n    close(restoreFocus: boolean = true): void {\n        if (!this._opened) { return; }\n\n        if (this.popupComponentRef) {\n            const instance = this.popupComponentRef.instance;\n            instance.startExitAnimation();\n            instance.animationDone\n                .pipe(take(1))\n                .subscribe(() => this.destroyOverlay());\n        }\n\n        if (restoreFocus) {\n            this.focusedElementBeforeOpen!.focus();\n        }\n\n        this._opened = false;\n        this.closedStream.emit();\n        this.focusedElementBeforeOpen = null;\n    }\n\n    toggle(): void {\n        if (this.datepickerInput.isReadOnly) { return; }\n\n        this._opened ? this.close() : this.open();\n    }\n\n    /** Destroys the current overlay. */\n    private destroyOverlay() {\n        if (this.popupRef) {\n            this.popupRef.dispose();\n            this.popupRef = this.popupComponentRef = null;\n        }\n    }\n\n    /** Open the calendar as a popup. */\n    private openAsPopup(): void {\n        if (!this.calendarPortal) {\n            this.calendarPortal = new ComponentPortal<McDatepickerContent<D>>(\n                McDatepickerContent, this.viewContainerRef\n            );\n        }\n\n        if (!this.popupRef) {\n            this.createPopup();\n        }\n\n        if (!this.popupRef!.hasAttached()) {\n            this.popupComponentRef = this.popupRef!.attach(this.calendarPortal);\n            this.popupComponentRef.instance.datepicker = this;\n\n            // Update the position once the calendar has rendered.\n            this.ngZone.onStable.asObservable()\n                .pipe(take(1))\n                .subscribe(() => this.popupRef!.updatePosition());\n        }\n    }\n\n    /** Create the popup. */\n    private createPopup(): void {\n        const overlayConfig = new OverlayConfig({\n            positionStrategy: this.createPopupPositionStrategy(),\n            hasBackdrop: this.hasBackdrop,\n            backdropClass: this.backdropClass,\n            direction: this.dir,\n            scrollStrategy: this.scrollStrategy(),\n            panelClass: 'mc-datepicker__popup'\n        });\n\n        this.popupRef = this.overlay.create(overlayConfig);\n\n        this.closeSubscription = this.closingActions()\n            .subscribe(() => this.close(this.restoreFocus()));\n    }\n\n    private restoreFocus(): boolean {\n        return this.document.activeElement === this.document.body;\n    }\n\n    private closingActions() {\n        return merge(\n            this.popupRef!.backdropClick(),\n            this.popupRef!.outsidePointerEvents(),\n            this.popupRef!.detachments()\n        );\n    }\n\n    /** Create the popup PositionStrategy. */\n    private createPopupPositionStrategy(): PositionStrategy {\n        return this.overlay.position()\n            .flexibleConnectedTo(this.datepickerInput.elementRef)\n            .withTransformOriginOn('.mc-datepicker__content')\n            .withFlexibleDimensions(false)\n            .withViewportMargin(8)\n            .withLockedPosition()\n            .withPositions([\n                {\n                    originX: 'start',\n                    originY: 'bottom',\n                    overlayX: 'start',\n                    overlayY: 'top'\n                },\n                {\n                    originX: 'start',\n                    originY: 'top',\n                    overlayX: 'start',\n                    overlayY: 'bottom'\n                },\n                {\n                    originX: 'end',\n                    originY: 'bottom',\n                    overlayX: 'end',\n                    overlayY: 'top'\n                },\n                {\n                    originX: 'end',\n                    originY: 'top',\n                    overlayX: 'end',\n                    overlayY: 'bottom'\n                }\n            ]);\n    }\n\n    /**\n     * @param obj The object to check.\n     * @returns The given object if it is both a date instance and valid, otherwise null.\n     */\n    private getValidDateOrNull(obj: any): D | null {\n        return (this.dateAdapter.isDateInstance(obj) && this.dateAdapter.isValid(obj)) ? obj : null;\n    }\n}\n","import { A11yModule } from '@angular/cdk/a11y';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { PortalModule } from '@angular/cdk/portal';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { McButtonModule } from '@ptsecurity/mosaic/button';\nimport { McIconModule } from '@ptsecurity/mosaic/icon';\n\nimport { McCalendarBody } from './calendar-body.component';\nimport { McCalendar, McCalendarHeader } from './calendar.component';\nimport { McDatepickerInput } from './datepicker-input.directive';\nimport { McDatepickerIntl } from './datepicker-intl';\nimport { McDatepickerToggle, McDatepickerToggleIcon } from './datepicker-toggle.component';\nimport {\n    McDatepicker,\n    McDatepickerContent,\n    MC_DATEPICKER_SCROLL_STRATEGY_FACTORY_PROVIDER\n} from './datepicker.component';\nimport { McMonthView } from './month-view.component';\nimport { McMultiYearView } from './multi-year-view.component';\nimport { McYearView } from './year-view.component';\n\n\n@NgModule({\n    imports: [\n        CommonModule,\n        McButtonModule,\n        OverlayModule,\n        A11yModule,\n        PortalModule,\n        McIconModule\n    ],\n    exports: [\n        McCalendar,\n        McCalendarBody,\n        McDatepicker,\n        McDatepickerContent,\n        McDatepickerInput,\n        McDatepickerToggle,\n        McDatepickerToggleIcon,\n        McMonthView,\n        McYearView,\n        McMultiYearView,\n        McCalendarHeader,\n        McButtonModule\n    ],\n    declarations: [\n        McCalendar,\n        McCalendarBody,\n        McDatepicker,\n        McDatepickerContent,\n        McDatepickerInput,\n        McDatepickerToggle,\n        McDatepickerToggleIcon,\n        McMonthView,\n        McYearView,\n        McMultiYearView,\n        McCalendarHeader\n    ],\n    providers: [\n        McDatepickerIntl,\n        MC_DATEPICKER_SCROLL_STRATEGY_FACTORY_PROVIDER\n    ],\n    entryComponents: [\n        McDatepickerContent,\n        McCalendarHeader\n    ]\n})\nexport class McDatepickerModule {\n}\n"]}
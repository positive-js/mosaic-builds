/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/mosaic/core"),require("@angular/cdk/coercion"),require("@angular/cdk/platform"),require("@ptsecurity/cdk/keycodes"),require("@ptsecurity/mosaic/form-field"),require("rxjs")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/input",["exports","@angular/common","@angular/core","@angular/forms","@ptsecurity/cdk/a11y","@ptsecurity/mosaic/core","@angular/cdk/coercion","@angular/cdk/platform","@ptsecurity/cdk/keycodes","@ptsecurity/mosaic/form-field","rxjs"],e):(t=t||self,e((t.ng=t.ng||{},t.ng.mosaic=t.ng.mosaic||{},t.ng.mosaic.input={}),t.ng.common,t.ng.core,t.ng.forms,t.ng.cdk.a11y,t.ng.mosaic.core,t.ng.cdk.coercion,t.ng.cdk.platform,t.ng.cdk.keycodes,t.ng.mosaic.formField,t.rxjs))}(this,function(t,e,n,o,r,i,s,a,u,p,c){"use strict";function l(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t){return Error('Input type "'+t+"\" isn't supported by mcInput.")}function h(t){var e=t.toString().split(".");return 1===e.length?1:Math.pow(10,e[1].length)}function y(t,e){var n=Math.max(h(t),h(e));return(t*n+e*n)/n}var f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},m=new n.InjectionToken("MC_INPUT_VALUE_ACCESSOR"),g=function(t,e,n,o){return Math.max(Math.min(y(t,o),e),n)},v=function(t,e,n,o){return Math.min(Math.max(y(t,-o),n),e)},C=["button","checkbox","file","hidden","image","radio","range","reset","submit"],b=10,I=1,_=0,x=function(){function t(t,e,n,o){this.defaultErrorStateMatcher=t,this.parentForm=e,this.parentFormGroup=n,this.ngControl=o}return t}(),A=i.mixinErrorState(x),E=function(){function t(t,e,n,o,r,i,s){this.platform=t,this.elementRef=e,this.model=n,this.focused=!1,this.stateChanges=new c.Subject,this.step=this.isDigit(o)?parseFloat(o):I,this.bigStep=this.isDigit(r)?parseFloat(r):b,this.min=this.isDigit(i)?parseFloat(i):-1/0,this.max=this.isDigit(s)?parseFloat(s):1/0,this.host=this.elementRef.nativeElement;var a=this;"valueAsNumber"in this.host&&Object.defineProperty(Object.getPrototypeOf(this.host),"valueAsNumber",{get:function(){var t=parseFloat(a.normalizeSplitter(this.value));return isNaN(t)?null:t}})}return t.prototype.focusChanged=function(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())},t.prototype.onKeyDown=function(t){var e=this,n=t.keyCode,o=[u.NUMPAD_MINUS,u.DASH,u.FF_MINUS],r=[u.DELETE,u.BACKSPACE,u.TAB,u.ESCAPE,u.ENTER],i=[u.LEFT_ARROW,u.RIGHT_ARROW],s=[u.HOME,u.END].concat(i).concat(r).concat(o),a=function(t){return"."===t.key||"Decimal"===t.key},p=function(t){return"."===t.key||","===t.key};if(!(-1!==s.indexOf(n)||function(t){return t.keyCode===u.A&&(t.ctrlKey||t.metaKey)}(t)||function(t){return t.keyCode===u.C&&(t.ctrlKey||t.metaKey)}(t)||function(t){return t.keyCode===u.V&&(t.ctrlKey||t.metaKey)}(t)||function(t){return t.keyCode===u.X&&(t.ctrlKey||t.metaKey)}(t)||function(t){return t.keyCode===u.Z&&(t.ctrlKey||t.metaKey)}(t)||function(t){return t.keyCode>=u.F1&&t.keyCode<=u.F12}(t)||function(t){return e.platform.EDGE||e.platform.TRIDENT?a(t):p(t)}(t))&&(t.shiftKey||!function(t){return t.keyCode>=u.ZERO&&t.keyCode<=u.NINE||t.keyCode>=u.NUMPAD_ZERO&&t.keyCode<=u.NUMPAD_NINE}(t))){t.preventDefault();var c=t.shiftKey?this.bigStep:this.step;n===u.UP_ARROW&&this.stepUp(c),n===u.DOWN_ARROW&&this.stepDown(c)}},t.prototype.onPaste=function(t){var e=t.clipboardData.getData("text");e=this.normalizeSplitter(e),this.isDigit(e)||t.preventDefault()},t.prototype.stepUp=function(t){this.elementRef.nativeElement.focus();var e=g(this.host.valueAsNumber||0,this.max,this.min,t);this.host.value=e.toString(),this.model.update.emit(this.host.valueAsNumber)},t.prototype.stepDown=function(t){this.elementRef.nativeElement.focus();var e=v(this.host.valueAsNumber||0,this.max,this.min,t);this.host.value=e.toString(),this.model.update.emit(this.host.valueAsNumber)},t.prototype.normalizeSplitter=function(t){return t?t.replace(/,/g,"."):t},t.prototype.isDigit=function(t){return this.isFloat(t)||this.isInt(t)},t.prototype.isFloat=function(t){return/^-?\d+\.\d+$/.test(t)},t.prototype.isInt=function(t){return/^-?\d+$/.test(t)},t.decorators=[{type:n.Directive,args:[{selector:'input[mcInput][type="number"]',exportAs:"mcNumericalInput",providers:[{provide:p.McFormFieldNumberControl,useExisting:t}],host:{"(blur)":"focusChanged(false)","(focus)":"focusChanged(true)","(paste)":"onPaste($event)","(keydown)":"onKeyDown($event)"}}]}],t.ctorParameters=function(){return[{type:a.Platform},{type:n.ElementRef},{type:o.NgModel},{type:String,decorators:[{type:n.Attribute,args:["step"]}]},{type:String,decorators:[{type:n.Attribute,args:["big-step"]}]},{type:String,decorators:[{type:n.Attribute,args:["min"]}]},{type:String,decorators:[{type:n.Attribute,args:["max"]}]}]},t.propDecorators={bigStep:[{type:n.Input}],step:[{type:n.Input}],min:[{type:n.Input}],max:[{type:n.Input}]},t}(),M=function(t){function e(e,n,o,r,i,s,u,p){var l=t.call(this,u,i,s,r)||this;return l.elementRef=e,l.rawValidators=n,l.mcValidation=o,l.focused=!1,l.stateChanges=new c.Subject,l.controlType="mc-input",l.uid="mc-input-"+_++,l.neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(function(t){return a.getSupportedInputTypes().has(t)}),l._disabled=!1,l._required=!1,l._type="text",l._inputValueAccessor=p||l.elementRef.nativeElement,l.previousNativeValue=l.value,l.id=l.id,l}return l(e,t),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled},set:function(t){this._disabled=s.coerceBooleanProperty(t),this.focused&&(this.focused=!1,this.stateChanges.next())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t||this.uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(t){this._required=s.coerceBooleanProperty(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t||"text",this.validateType(),a.getSupportedInputTypes().has(this._type)&&(this.elementRef.nativeElement.type=this._type)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._inputValueAccessor.value},set:function(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this.ngControl&&this.mcValidation.useValidation&&i.setMosaicValidation.call(this,this.rawValidators,this.parentForm||this.parentFormGroup,this.ngControl)},e.prototype.ngOnChanges=function(){this.stateChanges.next()},e.prototype.ngOnDestroy=function(){this.stateChanges.complete()},e.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState(),this.dirtyCheckNativeValue()},e.prototype.focus=function(){this.elementRef.nativeElement.focus()},e.prototype.onBlur=function(){this.focusChanged(!1),this.ngControl.control.updateValueAndValidity()},e.prototype.focusChanged=function(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())},e.prototype.onInput=function(){},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.isNeverEmpty()&&!this.elementRef.nativeElement.value&&!this.isBadInput()},enumerable:!0,configurable:!0}),e.prototype.onContainerClick=function(){this.focus()},e.prototype.dirtyCheckNativeValue=function(){var t=this.value;this.previousNativeValue!==t&&(this.previousNativeValue=t,this.stateChanges.next())},e.prototype.validateType=function(){if(C.indexOf(this._type)>-1)throw d(this._type)},e.prototype.isNeverEmpty=function(){return this.neverEmptyInputTypes.indexOf(this._type)>-1},e.prototype.isBadInput=function(){var t=this.elementRef.nativeElement.validity;return t&&t.badInput},e.decorators=[{type:n.Directive,args:[{selector:"input[mcInput]",exportAs:"mcInput",host:{class:"mc-input","[attr.id]":"id","[attr.placeholder]":"placeholder","[disabled]":"disabled","[required]":"required","(blur)":"onBlur()","(focus)":"focusChanged(true)","(input)":"onInput()"},providers:[{provide:p.McFormFieldControl,useExisting:e}]}]}],e.ctorParameters=function(){return[{type:n.ElementRef},{type:Array,decorators:[{type:n.Optional},{type:n.Self},{type:n.Inject,args:[o.NG_VALIDATORS]}]},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[i.MC_VALIDATION]}]},{type:o.NgControl,decorators:[{type:n.Optional},{type:n.Self}]},{type:o.NgForm,decorators:[{type:n.Optional}]},{type:o.FormGroupDirective,decorators:[{type:n.Optional}]},{type:i.ErrorStateMatcher},{type:void 0,decorators:[{type:n.Optional},{type:n.Self},{type:n.Inject,args:[m]}]}]},e.propDecorators={errorStateMatcher:[{type:n.Input}],placeholder:[{type:n.Input}],disabled:[{type:n.Input}],id:[{type:n.Input}],required:[{type:n.Input}],type:[{type:n.Input}],value:[{type:n.Input}]},e}(A),N=function(){function t(){}return t.decorators=[{type:n.Directive,args:[{selector:"input[mcInputMonospace]",exportAs:"McInputMonospace",host:{class:"mc-input_monospace"}}]}],t}(),O={provide:o.NG_VALIDATORS,useExisting:n.forwardRef(function(){return D}),multi:!0},D=function(){function t(){}return t.prototype.ngOnChanges=function(t){"min"in t&&(this.createValidator(),this.onChange&&this.onChange())},t.prototype.validate=function(t){return this.validator(t)},t.prototype.registerOnValidatorChange=function(t){this.onChange=t},t.prototype.createValidator=function(){this.validator=o.Validators.min(parseInt(this.min,10))},t.decorators=[{type:n.Directive,args:[{selector:"[min][formControlName],[min][formControl],[min][ngModel]",providers:[O],host:{"[attr.min]":"min ? min : null"}}]}],t.propDecorators={min:[{type:n.Input}]},t}(),S={provide:o.NG_VALIDATORS,useExisting:n.forwardRef(function(){return k}),multi:!0},k=function(){function t(){}return t.prototype.ngOnChanges=function(t){"max"in t&&(this.createValidator(),this.onChange&&this.onChange())},t.prototype.validate=function(t){return this.validator(t)},t.prototype.registerOnValidatorChange=function(t){this.onChange=t},t.prototype.createValidator=function(){this.validator=o.Validators.max(parseInt(this.max,10))},t.decorators=[{type:n.Directive,args:[{selector:"[max][formControlName],[max][formControl],[max][ngModel]",providers:[S],host:{"[attr.max]":"max ? max : null"}}]}],t.propDecorators={max:[{type:n.Input}]},t}(),R=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule,r.A11yModule,i.McCommonModule,o.FormsModule],exports:[M,E,N,D,k],declarations:[M,E,N,D,k]}]}],t}();t.BIG_STEP=b,t.MC_INPUT_VALUE_ACCESSOR=m,t.McInput=M,t.McInputBase=x,t.McInputMixinBase=A,t.McInputModule=R,t.McInputMono=N,t.McNumberInput=E,t.SMALL_STEP=I,t.stepDown=v,t.stepUp=g,t.ɵa25=O,t.ɵb25=D,t.ɵc25=S,t.ɵd25=k,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-input.umd.min.js.map

/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@ptsecurity/cdk/portal"),require("rxjs"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/mosaic/core"),require("@angular/animations"),require("@ptsecurity/cdk/coercion"),require("@ptsecurity/cdk/keycodes"),require("rxjs/operators"),require("@ptsecurity/cdk/bidi"),require("@ptsecurity/cdk/overlay")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/dropdown",["exports","@angular/common","@angular/core","@ptsecurity/cdk/portal","rxjs","@ptsecurity/cdk/a11y","@ptsecurity/mosaic/core","@angular/animations","@ptsecurity/cdk/coercion","@ptsecurity/cdk/keycodes","rxjs/operators","@ptsecurity/cdk/bidi","@ptsecurity/cdk/overlay"],e):e((t.ng=t.ng||{},t.ng.mosaic=t.ng.mosaic||{},t.ng.mosaic.dropdown={}),t.ng.common,t.ng.core,t.ng.cdk.portal,t.rxjs,t.ng.cdk.a11y,t.ng.mosaic.core,t.ng.animations,t.ng.cdk.coercion,t.ng.cdk.keycodes,t.rxjs.operators,t.ng.cdk.bidi,t.ng.cdk.overlay)}(this,function(t,e,o,n,i,r,s,a,p,c,d,l,u){"use strict";function h(t,e){function o(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}function m(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s}function _(t,e){return function(o,n){e(o,n,t)}}function f(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function y(){throw Error('mcDropdownTriggerFor: must pass in an mc-dropdown instance.\n    Example:\n      <mc-dropdown #dropdown="mcDropdown"></mc-dropdown>\n      <button [mcDropdownTriggerFor]="dropdown"></button>')}function g(){throw Error('xPosition value must be either \'before\' or after\'.\n      Example: <mc-dropdown xPosition="before" #dropdown="mcDropdown"></mc-dropdown>')}function b(){throw Error('yPosition value must be either \'above\' or below\'.\n      Example: <mc-dropdown yPosition="above" #dropdown="mcDropdown"></mc-dropdown>')}function w(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}function v(t){return function(){return t.scrollStrategies.reposition()}}var O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},D=function(){function t(t,e,o,n,r,s){this._template=t,this._componentFactoryResolver=e,this._appRef=o,this._injector=n,this._viewContainerRef=r,this._document=s,this._attached=new i.Subject}return t.prototype.attach=function(t){void 0===t&&(t={}),this._portal||(this._portal=new n.TemplatePortal(this._template,this._viewContainerRef)),this.detach(),this._outlet||(this._outlet=new n.DomPortalOutlet(this._document.createElement("div"),this._componentFactoryResolver,this._appRef,this._injector));var e=this._template.elementRef.nativeElement;e.parentNode.insertBefore(this._outlet.outletElement,e),this._portal.attach(this._outlet,t),this._attached.next()},t.prototype.detach=function(){this._portal.isAttached&&this._portal.detach()},t.prototype.ngOnDestroy=function(){this._outlet&&this._outlet.dispose()},t=m([o.Directive({selector:"ng-template[mcDropdownContent]"}),_(5,o.Inject(e.DOCUMENT)),f("design:paramtypes",[o.TemplateRef,o.ComponentFactoryResolver,o.ApplicationRef,o.Injector,o.ViewContainerRef,Object])],t)}(),P=new o.InjectionToken("MC_DROPDOWN_PANEL"),k=function(){function t(){}return t}(),C=s.mixinDisabled(k),R=function(t){function n(e,o,n,i){var r=t.call(this)||this;return r._elementRef=e,r._focusMonitor=n,r._parentDropdownPanel=i,n&&n.monitor(r._elementRef.nativeElement,!1),i&&i.addItem&&i.addItem(r),r._document=o,r}return h(n,t),n.prototype.focus=function(t){void 0===t&&(t="program"),this._focusMonitor?this._focusMonitor.focusVia(this._getHostElement(),t):this._getHostElement().focus()},n.prototype.ngOnDestroy=function(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef.nativeElement),this._parentDropdownPanel&&this._parentDropdownPanel.removeItem&&this._parentDropdownPanel.removeItem(this)},n.prototype._getTabIndex=function(){return this.disabled?"-1":"0"},n.prototype._getHostElement=function(){return this._elementRef.nativeElement},n.prototype._checkDisabled=function(t){this.disabled&&(t.preventDefault(),t.stopPropagation())},n.prototype.getLabel=function(){var t=this._elementRef.nativeElement,e=this._document?this._document.TEXT_NODE:3,o="";if(t.childNodes)for(var n=t.childNodes.length,i=0;i<n;i++)t.childNodes[i].nodeType===e&&(o+=t.childNodes[i].textContent);return o.trim()},n=m([o.Component({selector:"mc-dropdown-item, [mc-dropdown-item]",exportAs:"mcDropdownItem",inputs:["disabled"],host:{role:"dropdown-item",class:"mc-dropdown__item","[attr.tabindex]":"_getTabIndex()","[attr.disabled]":"disabled || null","(click)":"_checkDisabled($event)"},changeDetection:o.ChangeDetectionStrategy.OnPush,encapsulation:o.ViewEncapsulation.None,template:"<ng-content></ng-content>"}),_(1,o.Inject(e.DOCUMENT)),_(3,o.Inject(P)),_(3,o.Optional()),f("design:paramtypes",[o.ElementRef,Object,r.FocusMonitor,Object])],n)}(C),x={transformDropdown:a.trigger("transformDropdown",[a.state("void",a.style({opacity:0,transform:"scale(0.8)"})),a.transition("void => enter",a.group([a.query(".mc-dropdown__content",a.animate("50ms linear",a.style({opacity:1}))),a.animate("50ms cubic-bezier(0, 0, 0.2, 1)",a.style({transform:"scale(1)"}))])),a.transition("* => void",a.animate("50ms 25ms linear",a.style({opacity:0})))]),fadeInItems:a.trigger("fadeInItems",[a.state("showing",a.style({opacity:1})),a.transition("void => *",[a.style({opacity:0}),a.animate("200ms 60ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},I=x.fadeInItems,E=x.transformDropdown,T=new o.InjectionToken("mc-dropdown-default-options",{providedIn:"root",factory:w}),M=function(){function t(t,e,n){this._elementRef=t,this._ngZone=e,this._defaultOptions=n,this._classList={},this._panelAnimationState="void",this._animationDone=new i.Subject,this.backdropClass=this._defaultOptions.backdropClass,this.closed=new o.EventEmitter,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._items=[],this._itemChanges=new i.Subject,this._tabSubscription=i.Subscription.EMPTY,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop}e=t,Object.defineProperty(t.prototype,"xPosition",{get:function(){return this._xPosition},set:function(t){"before"!==t&&"after"!==t&&g(),this._xPosition=t,this.setPositionClasses()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yPosition",{get:function(){return this._yPosition},set:function(t){"above"!==t&&"below"!==t&&b(),this._yPosition=t,this.setPositionClasses()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overlapTrigger",{get:function(){return this._overlapTrigger},set:function(t){this._overlapTrigger=p.coerceBooleanProperty(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasBackdrop",{get:function(){return this._hasBackdrop},set:function(t){this._hasBackdrop=p.coerceBooleanProperty(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panelClass",{set:function(t){t&&t.length&&(this._classList=t.split(" ").reduce(function(t,e){return t[e]=!0,t},{}),this._elementRef.nativeElement.className="")},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.setPositionClasses()},t.prototype.ngAfterContentInit=function(){var t=this;this._keyManager=new r.FocusKeyManager(this.items).withWrap().withTypeAhead(),this._tabSubscription=this._keyManager.tabOut.subscribe(function(){return t.closed.emit("tab")})},t.prototype.ngOnDestroy=function(){this._tabSubscription.unsubscribe(),this.closed.complete()},t.prototype._handleKeydown=function(t){switch(t.keyCode){case c.ESCAPE:this.closed.emit("keydown");break;case c.UP_ARROW:case c.DOWN_ARROW:this._keyManager.setFocusOrigin("keyboard"),this._keyManager.onKeydown(t);break;default:this._keyManager.onKeydown(t)}},t.prototype.focusFirstItem=function(t){var e=this;void 0===t&&(t="program"),this.lazyContent?this._ngZone.onStable.asObservable().pipe(d.take(1)).subscribe(function(){return e._keyManager.setFocusOrigin(t).setFirstItemActive()}):this._keyManager.setFocusOrigin(t).setFirstItemActive()},t.prototype.resetActiveItem=function(){this._keyManager.setActiveItem(-1)},t.prototype.addItem=function(t){-1===this._items.indexOf(t)&&(this._items.push(t),this._itemChanges.next(this._items))},t.prototype.removeItem=function(t){var e=this._items.indexOf(t);this._items.indexOf(t)>-1&&(this._items.splice(e,1),this._itemChanges.next(this._items))},t.prototype.setPositionClasses=function(t,e){void 0===t&&(t=this.xPosition),void 0===e&&(e=this.yPosition);var o=this._classList;o["mc-dropdown-before"]="before"===t,o["mc-dropdown-after"]="after"===t,o["mc-dropdown-above"]="above"===e,o["mc-dropdown-below"]="below"===e},t.prototype._startAnimation=function(){this._panelAnimationState="enter"},t.prototype._resetAnimation=function(){this._panelAnimationState="void"},t.prototype._onAnimationDone=function(t){this._animationDone.next(t),this._isAnimating=!1,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)};var e;return m([o.Input(),f("design:type",String),f("design:paramtypes",[String])],t.prototype,"xPosition",null),m([o.Input(),f("design:type",String),f("design:paramtypes",[String])],t.prototype,"yPosition",null),m([o.Input(),f("design:type",Boolean),f("design:paramtypes",[Boolean])],t.prototype,"overlapTrigger",null),m([o.Input(),f("design:type",Object),f("design:paramtypes",[Object])],t.prototype,"hasBackdrop",null),m([o.Input("class"),f("design:type",String),f("design:paramtypes",[String])],t.prototype,"panelClass",null),m([o.Input(),f("design:type",String)],t.prototype,"backdropClass",void 0),m([o.ViewChild(o.TemplateRef),f("design:type",o.TemplateRef)],t.prototype,"templateRef",void 0),m([o.ContentChildren(R),f("design:type",o.QueryList)],t.prototype,"items",void 0),m([o.ContentChild(D),f("design:type",D)],t.prototype,"lazyContent",void 0),m([o.Output(),f("design:type",o.EventEmitter)],t.prototype,"closed",void 0),t=e=m([o.Component({selector:"mc-dropdown",template:'<ng-template><div class="mc-dropdown__panel" [ngClass]="_classList" (keydown)="_handleKeydown($event)" (click)="closed.emit(\'click\')" [@transformDropdown]="_panelAnimationState" (@transformDropdown.start)="_isAnimating = true" (@transformDropdown.done)="_onAnimationDone($event)" tabindex="-1"><div class="mc-dropdown__content"><ng-content></ng-content></div></div></ng-template>',styles:[".mc-dropdown__item{display:block;box-sizing:border-box;width:100%;border:1px solid transparent;outline:0;padding:5px 15px;text-align:left}.mc-dropdown__item:not([disabled]){cursor:pointer}.mc-dropdown__item .mc-dropdown__item-caption{margin-top:4px}.mc-dropdown__panel{min-width:100%;overflow:auto;margin-top:-1px;border-width:1px;border-style:solid;border-bottom-left-radius:3px;border-bottom-right-radius:3px;padding:4px 0}.mc-dropdown__content{height:100%}.mc-dropdown__content h1,.mc-dropdown__content h2,.mc-dropdown__content h3,.mc-dropdown__content h4,.mc-dropdown__content h5{padding:8px 16px 4px 16px;margin:0}"],changeDetection:o.ChangeDetectionStrategy.OnPush,encapsulation:o.ViewEncapsulation.None,exportAs:"mcDropdown",animations:[x.transformDropdown,x.fadeInItems],providers:[{provide:P,useExisting:e}]}),_(2,o.Inject(T)),f("design:paramtypes",[o.ElementRef,o.NgZone,Object])],t)}(),S=new o.InjectionToken("mc-dropdown-scroll-strategy"),j={provide:S,deps:[u.Overlay],useFactory:v},A=function(){function t(t,e,n,r,s,a){this._overlay=t,this._element=e,this._viewContainerRef=n,this._scrollStrategy=r,this._dir=s,this._focusMonitor=a,this._openedBy=null,this.dropdownOpened=new o.EventEmitter,this.dropdownClosed=new o.EventEmitter,this._overlayRef=null,this._opened=!1,this._closeSubscription=i.Subscription.EMPTY,this._hoverSubscription=i.Subscription.EMPTY}return Object.defineProperty(t.prototype,"opened",{get:function(){return this._opened},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.dropdown.closed=this.dropdown.closed||new o.EventEmitter},t.prototype.ngAfterContentInit=function(){var t=this;this._check(),this.dropdown.closed.asObservable().subscribe(function(){t._destroy()})},t.prototype.ngOnDestroy=function(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._cleanUpSubscriptions()},t.prototype.toggle=function(){return this._opened?this.close():this.open()},t.prototype.open=function(){var t=this;if(!this._opened){this._check();var e=this._createOverlay();this._setPosition(e.getConfig().positionStrategy),e.attach(this._portal),this.dropdown.lazyContent&&this.dropdown.lazyContent.attach(this.data),this._closeSubscription=this._closingActions().subscribe(function(){return t.close()}),this._init(),this.dropdown instanceof M&&this.dropdown._startAnimation()}},t.prototype.close=function(){this.dropdown.closed.emit()},t.prototype.focus=function(t){void 0===t&&(t="program"),this._focusMonitor?this._focusMonitor.focusVia(this._element.nativeElement,t):this._element.nativeElement.focus()},t.prototype._destroy=function(){var t=this;if(this._overlayRef&&this.opened){var e=this.dropdown;this._closeSubscription.unsubscribe(),this._overlayRef.detach(),e instanceof M?(e._resetAnimation(),e.lazyContent?e._animationDone.pipe(d.filter(function(t){return"void"===t.toState}),d.take(1),d.takeUntil(e.lazyContent._attached)).subscribe(function(){return e.lazyContent.detach()},void 0,function(){t._reset()}):this._reset()):(this._reset(),e.lazyContent&&e.lazyContent.detach())}},t.prototype._init=function(){this.dropdown.direction=this.dir,this._setIsOpened(!0),this.dropdown.focusFirstItem(this._openedBy||"program")},t.prototype._reset=function(){this._setIsOpened(!1),this._openedBy?this.focus(this._openedBy):this.focus(),this._openedBy=null},t.prototype._setIsOpened=function(t){this._opened=t,this._opened?this.dropdownOpened.emit():this.dropdownClosed.emit()},t.prototype._check=function(){this.dropdown||y()},t.prototype._createOverlay=function(){if(!this._overlayRef){this._portal=new n.TemplatePortal(this.dropdown.templateRef,this._viewContainerRef);var t=this._getOverlayConfig();this._subscribeToPositions(t.positionStrategy),this._overlayRef=this._overlay.create(t),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef},t.prototype._getOverlayConfig=function(){return new u.OverlayConfig({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withTransformOriginOn(".mc-dropdown__panel"),hasBackdrop:null===this.dropdown.hasBackdrop||void 0===this.dropdown.hasBackdrop||this.dropdown.hasBackdrop,backdropClass:this.dropdown.backdropClass||"cdk-overlay-transparent-backdrop",scrollStrategy:this._scrollStrategy(),direction:this._dir})},t.prototype._subscribeToPositions=function(t){var e=this;this.dropdown.setPositionClasses&&t.positionChanges.subscribe(function(){e.dropdown.setPositionClasses(e.dropdown.xPosition,e.dropdown.yPosition)})},t.prototype._setPosition=function(t){var e="before"===this.dropdown.xPosition?["end","start"]:["start","end"],o=e[0],n=e[1],i="above"===this.dropdown.yPosition?["bottom","top"]:["top","bottom"],r=i[0],s=i[1],a=[r,s],p=a[0],c=a[1],d=[o,n],l=d[0],u=d[1];this.dropdown.overlapTrigger||(p="top"===r?"bottom":"top",c="top"===s?"bottom":"top"),t.withPositions([{originX:o,originY:p,overlayX:l,overlayY:r,offsetY:0},{originX:n,originY:p,overlayX:u,overlayY:r,offsetY:0},{originX:o,originY:c,overlayX:l,overlayY:s,offsetY:-0},{originX:n,originY:c,overlayX:u,overlayY:s,offsetY:-0}])},t.prototype._cleanUpSubscriptions=function(){this._closeSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()},t.prototype._closingActions=function(){var t=this._overlayRef.backdropClick(),e=this._overlayRef.detachments();return i.merge(t,e)},m([o.Input("mcDropdownTriggerFor"),f("design:type",Object)],t.prototype,"dropdown",void 0),m([o.Input("mcDropdownTriggerData"),f("design:type",Object)],t.prototype,"data",void 0),m([o.Output(),f("design:type",o.EventEmitter)],t.prototype,"dropdownOpened",void 0),m([o.Output(),f("design:type",o.EventEmitter)],t.prototype,"dropdownClosed",void 0),t=m([o.Directive({selector:"[mcDropdownTriggerFor]",host:{"(touchstart)":'_openedBy = "touch"',"(click)":"toggle()"},exportAs:"mcDropdownTrigger"}),_(3,o.Inject(S)),_(4,o.Optional()),f("design:paramtypes",[u.Overlay,o.ElementRef,o.ViewContainerRef,Object,l.Directionality,r.FocusMonitor])],t)}(),N=function(){function t(){}return t=m([o.NgModule({imports:[e.CommonModule,u.OverlayModule],exports:[M,R,A,D],declarations:[M,R,A,D],providers:[j]})],t)}();t.McDropdownModule=N,t.MC_DROPDOWN_DEFAULT_OPTIONS=T,t.MC_DROPDOWN_DEFAULT_OPTIONS_FACTORY=w,t.McDropdown=M,t.McDropdownItemBase=k,t._McDropdownItemMixinBase=C,t.McDropdownItem=R,t.MC_DROPDOWN_PANEL=P,t.throwMcDropdownMissingError=y,t.throwMcDropdownInvalidPositionX=g,t.throwMcDropdownInvalidPositionY=b,t.mcDropdownAnimations=x,t.fadeInItems=I,t.transformDropdown=E,t.McDropdownContent=D,t.MC_DROPDOWN_SCROLL_STRATEGY=S,t.MC_DROPDOWN_SCROLL_STRATEGY_FACTORY=v,t.MC_DROPDOWN_SCROLL_STRATEGY_FACTORY_PROVIDER=j,t.McDropdownTrigger=A,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-dropdown.umd.min.js.map

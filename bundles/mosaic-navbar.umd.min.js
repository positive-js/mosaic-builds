/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/cdk/keycodes"),require("@ptsecurity/cdk/platform"),require("@ptsecurity/mosaic/core"),require("@angular/common"),require("@ptsecurity/mosaic/icon")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/navbar",["exports","rxjs","rxjs/operators","@angular/core","@ptsecurity/cdk/a11y","@ptsecurity/cdk/keycodes","@ptsecurity/cdk/platform","@ptsecurity/mosaic/core","@angular/common","@ptsecurity/mosaic/icon"],e):e((t.ng=t.ng||{},t.ng.mosaic=t.ng.mosaic||{},t.ng.mosaic.navbar={}),t.rxjs,t.rxjs.operators,t.ng.core,t.ng.cdk.a11y,t.ng.cdk.keycodes,t.ng.cdk.platform,t.ng.mosaic.core,t.ng.common,t.ng.mosaic.icon)}(this,function(t,e,n,o,i,r,a,s,c,l){"use strict";function p(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}function m(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},h="mc-navbar-container",f="mc-navbar-item",b="mc-navbar-brand",g="mc-navbar-title",v=function(){function t(){}return t=d([o.Directive({selector:"mc-navbar-logo",host:{class:"mc-navbar-logo"}})],t)}(),y=function(){function t(){}return t=d([o.Directive({selector:b,host:{class:b}})],t)}(),w=function(){function t(){}return t=d([o.Directive({selector:g,host:{class:g}})],t)}(),C=function(){function t(t){this._elementRef=t}return t}(),I=s.mixinDisabled(C),x=function(t){function n(n,o,i,r){var a=t.call(this,n)||this;return a.elementRef=n,a._focusMonitor=o,a._platform=i,a._cdRef=r,a.tabIndex=0,a.dropdownItems=[],a.isCollapsed=!0,a._subscription=new e.Subscription,a}return p(n,t),Object.defineProperty(n.prototype,"collapsedTitle",{set:function(t){this.elementRef.nativeElement.setAttribute("computedTitle",encodeURI(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasDropdownContent",{get:function(){return this.dropdownItems.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_dropdownElements",{get:function(){return this.dropdownContent?this.dropdownContent.nativeElement.querySelectorAll("li > *"):[]},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){this.denyClickIfDisabled(),this._focusMonitor$=this._focusMonitor.monitor(this.elementRef.nativeElement,!0),this.hasDropdownContent&&this.listenClickOutside()},n.prototype.ngAfterViewInit=function(){this.hasDropdownContent&&this.startListenFocusDropdownItems()},n.prototype.ngOnDestroy=function(){this._subscription.unsubscribe(),this._focusMonitor.stopMonitoring(this.elementRef.nativeElement),this.stopListenFocusDropdownItems()},n.prototype.isActiveDropdownLink=function(t){return!!this._platform.isBrowser&&window.location.href.indexOf(t)>=0},n.prototype.handleClickByItem=function(){this.toggleDropdown()},n.prototype.handleKeydown=function(t){var e=t.target.classList.contains(f);this.hasDropdownContent&&t.keyCode===r.SPACE&&e&&this.toggleDropdown()},n.prototype.handleClickByDropdownItem=function(){this.forceCloseDropdown()},n.prototype.listenClickOutside=function(){var t=this;this._subscription.add(this._focusMonitor$.subscribe(function(e){null===e&&t.forceCloseDropdown()}))},n.prototype.toggleDropdown=function(){this.isCollapsed=!this.isCollapsed},n.prototype.forceCloseDropdown=function(){this.isCollapsed=!0,this._cdRef.detectChanges()},n.prototype.startListenFocusDropdownItems=function(){var t=this;this._dropdownElements.forEach(function(e){t._focusMonitor.monitor(e,!0)})},n.prototype.stopListenFocusDropdownItems=function(){var t=this;this._dropdownElements.forEach(function(e){t._focusMonitor.stopMonitoring(e)})},n.prototype.denyClickIfDisabled=function(){var t=this,e=this.elementRef.nativeElement.eventListeners("click");e.forEach(function(e){return t.elementRef.nativeElement.removeEventListener("click",e)}),this.elementRef.nativeElement.addEventListener("click",function(e){t.elementRef.nativeElement.hasAttribute("disabled")&&e.stopImmediatePropagation()},!0),e.forEach(function(e){return t.elementRef.nativeElement.addEventListener("click",e)})},d([o.Input(),m("design:type",Number)],n.prototype,"tabIndex",void 0),d([o.Input(),m("design:type",Array)],n.prototype,"dropdownItems",void 0),d([o.Input(),m("design:type",String),m("design:paramtypes",[String])],n.prototype,"collapsedTitle",null),d([o.ContentChild("dropdownItemTmpl",{read:o.TemplateRef}),m("design:type",o.TemplateRef)],n.prototype,"dropdownItemTmpl",void 0),d([o.ViewChild("dropdownContent",{read:o.ElementRef}),m("design:type",o.ElementRef)],n.prototype,"dropdownContent",void 0),n=d([o.Component({selector:f,template:'\n        <a\n            [attr.tabindex]="disabled ? -1 : tabIndex"\n            (click)="handleClickByItem()"\n            (keydown)="handleKeydown($event)"\n            class="mc-navbar-item"\n        >\n            <ng-content></ng-content>\n            <i *ngIf="hasDropdownContent" mc-icon="mc-angle-M_16"></i>\n        </a>\n        <ul\n            #dropdownContent\n            *ngIf="hasDropdownContent"\n            [ngClass]="{ \'is-collapsed\': isCollapsed }"\n            class="mc-navbar-dropdown"\n        >\n            <li\n                *ngFor="let item of dropdownItems"\n                (click)="handleClickByDropdownItem()"\n                class="mc-navbar-dropdown-item"\n            >\n                <ng-container *ngIf="dropdownItemTmpl">\n                    <ng-container *ngTemplateOutlet="dropdownItemTmpl; context: { $implicit: item }"></ng-container>\n                </ng-container>\n                <a\n                    *ngIf="!dropdownItemTmpl"\n                    [attr.href]="item.link"\n                    [ngClass]="{ \'is-active\': isActiveDropdownLink(item.link) }"\n                    class="mc-navbar-dropdown-link"\n                >{{ item.text }}</a>\n            </li>\n        </ul>\n    ',encapsulation:o.ViewEncapsulation.None,changeDetection:o.ChangeDetectionStrategy.OnPush,inputs:["disabled"],host:{"[attr.disabled]":"disabled || null","[attr.tabindex]":"-1"}}),m("design:paramtypes",[o.ElementRef,i.FocusMonitor,a.Platform,o.ChangeDetectorRef])],n)}(I),_=function(){function t(){this.position="left"}return Object.defineProperty(t.prototype,"cssClasses",{get:function(){return"left"===this.position?"mc-navbar-left":"mc-navbar-right"},enumerable:!0,configurable:!0}),d([o.Input(),m("design:type",String)],t.prototype,"position",void 0),d([o.HostBinding("class"),m("design:type",String),m("design:paramtypes",[])],t.prototype,"cssClasses",null),t=d([o.Directive({selector:h})],t)}(),k=function(){function t(t,e){this.element=t,this.width=e,this._collapsed=!1}return t.prototype.processCollapsed=function(t){this._collapsed=t,this.updateCollapsedClass()},t.prototype.updateCollapsedClass=function(){this._collapsed?this.element.classList.add("mc-navbar-collapsed-title"):this.element.classList.remove("mc-navbar-collapsed-title")},t}(),D=function(){function t(t,e,n){void 0===n&&(n=[]),this.element=t,this.width=e,this.itemsForCollapse=n}return Object.defineProperty(t.prototype,"canCollapse",{get:function(){return this.itemsForCollapse.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapsedItemsWidth",{get:function(){return void 0!==this._collapsedItemsWidth?this._collapsedItemsWidth:(this.calculateAndCacheCollapsedItemsWidth(),this._collapsedItemsWidth)},enumerable:!0,configurable:!0}),t.prototype.processCollapsed=function(t){this.itemsForCollapse.length>0&&this.updateTitle(t),this.itemsForCollapse.forEach(function(e){return e.processCollapsed(t)})},t.prototype.calculateAndCacheCollapsedItemsWidth=function(){this._collapsedItemsWidth=this.itemsForCollapse.reduce(function(t,e){return t+e.width},0)},t.prototype.getTitle=function(){var t=this.element.getAttribute("computedTitle");return t?decodeURI(t):this.itemsForCollapse.length>0?this.itemsForCollapse[0].element.innerText:""},t.prototype.updateTitle=function(t){t?this.element.setAttribute("title",this.getTitle()):this.element.removeAttribute("title")},t}(),E=function(){function t(t){this._elementRef=t,this.forceRecalculateItemsWidth=!1,this.resizeDebounceInterval=100,this.firstLevelElement=h,this.secondLevelElements=[f,b,g];var o=e.fromEvent(window,"resize").pipe(n.debounceTime(this.resizeDebounceInterval));this._resizeSubscription=o.subscribe(this.updateCollapsed.bind(this))}return Object.defineProperty(t.prototype,"maxAllowedWidth",{get:function(){return this._elementRef.nativeElement.querySelector("nav").getBoundingClientRect().width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsWidths",{get:function(){return void 0===this._itemsWidths||this.forceRecalculateItemsWidth?(this.calculateAndCacheItemsWidth(),this._itemsWidths):this._itemsWidths},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalItemsWidth",{get:function(){return void 0===this._totalItemsWidths||this.forceRecalculateItemsWidth?(this.calculateAndCacheTotalItemsWidth(),this._totalItemsWidths):this._totalItemsWidths},enumerable:!0,configurable:!0}),t.prototype.updateCollapsed=function(){for(var t=this.totalItemsWidth-this.maxAllowedWidth,e=this.itemsWidths.length-1;e>=0;e--){var n=this.itemsWidths[e];n.canCollapse&&(n.processCollapsed(t>0),t-=n.collapsedItemsWidth)}},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){return t.updateCollapsed()},0)},t.prototype.ngOnDestroy=function(){this._resizeSubscription.unsubscribe()},t.prototype.calculateAndCacheTotalItemsWidth=function(){this._totalItemsWidths=this.itemsWidths.reduce(function(t,e){return t+e.width},0)},t.prototype.getOuterElementWidth=function(t){return t.getBoundingClientRect().width+parseInt(getComputedStyle(t).getPropertyValue("margin-right"))+parseInt(getComputedStyle(t).getPropertyValue("margin-left"))},t.prototype.calculateAndCacheItemsWidth=function(){var t=this,e=this.secondLevelElements.map(function(e){return t.firstLevelElement+">"+e}),n=Array.from(this._elementRef.nativeElement.querySelectorAll(e));this._itemsWidths=n.map(function(e){return new D(e,t.getOuterElementWidth(e),t.getItemsForCollapse(e))})},t.prototype.getItemsForCollapse=function(t){return t.querySelector("[mc-icon],mc-navbar-logo,[mc-navbar-logo]")?Array.from(t.querySelectorAll(g)).map(function(t){return new k(t,t.getBoundingClientRect().width)}):[]},t=d([o.Component({selector:"mc-navbar",changeDetection:o.ChangeDetectionStrategy.OnPush,template:'\n        <nav class="mc-navbar">\n            <ng-content select="['+h+"],"+h+'"></ng-content>\n        </nav>\n    ',styles:['.mc-navbar-left,.mc-navbar-right,mc-navbar-container{height:100%;display:flex;flex-shrink:0;flex-direction:row;justify-content:space-between;align-items:center}.mc-navbar{position:relative;height:48px;padding:0 0;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.mc-navbar [mc-icon]+mc-navbar-title{margin-left:8px}.mc-navbar mc-navbar-title:not(.mc-navbar-collapsed-title)+[mc-icon]{margin-left:8px}.mc-navbar-brand,.mc-navbar-item,.mc-navbar-title,mc-navbar-brand,mc-navbar-item,mc-navbar-item:first-child{height:100%;position:relative;display:flex;align-items:center;padding-left:16px;padding-right:16px;background-color:transparent;border:none}.mc-navbar-brand,mc-navbar-brand{padding-left:0;padding-right:12px;margin-right:24px}.mc-navbar-brand .mc-navbar-title,mc-navbar-brand .mc-navbar-title{padding-left:12px;padding-right:0}.mc-navbar-title{white-space:nowrap}.mc-navbar-item:not([disabled]){cursor:pointer}.mc-navbar-item .mc-navbar-title,mc-navbar-brand,mc-navbar-item,mc-navbar-item:first-child{padding:0}mc-navbar-item.mc-progress:not([disabled]){cursor:pointer}.mc-navbar-item[disabled],mc-navbar-item[disabled] .mc-navbar-item{cursor:default}mc-navbar-title.mc-navbar-collapsed-title{display:none}.mc-navbar-dropdown{position:absolute;top:100%;left:0;box-sizing:border-box;min-width:100%;height:auto;margin:0;list-style:none;padding-top:4px;padding-right:0;padding-bottom:4px;padding-left:0;border:1px solid;border-top:none;z-index:1}.mc-navbar-right .mc-navbar-dropdown{left:auto;right:0}.mc-navbar-dropdown-link{position:relative;display:block;box-sizing:border-box;padding-top:6px;padding-right:16px;padding-bottom:6px;padding-left:16px;border:2px solid transparent;text-decoration:none;white-space:nowrap}.mc-navbar-dropdown-link.is-active:hover::before{position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;content:""}.mc-navbar-dropdown.is-collapsed{display:none}'],encapsulation:o.ViewEncapsulation.None}),m("design:paramtypes",[o.ElementRef])],t)}(),R=function(){function t(){}return t=d([o.NgModule({imports:[c.CommonModule,i.A11yModule,a.PlatformModule,l.McIconModule],exports:[E,_,w,x,y,v],declarations:[E,_,w,x,y,v]})],t)}();t.McNavbarModule=R,t.McNavbarLogo=v,t.McNavbarBrand=y,t.McNavbarTitle=w,t.McNavbarItemBase=C,t._McNavbarMixinBase=I,t.McNavbarItem=x,t.McNavbarContainer=_,t.McNavbar=E,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-navbar.umd.min.js.map

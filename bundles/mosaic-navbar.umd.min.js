/**
 * @license
 * Positive Technologies All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ptsecurity/mosaic/core"),require("@angular/common"),require("@ptsecurity/cdk/a11y"),require("@ptsecurity/cdk/platform"),require("rxjs"),require("rxjs/operators"),require("@ptsecurity/cdk/keycodes")):"function"==typeof define&&define.amd?define("@ptsecurity/mosaic/navbar",["exports","@angular/core","@ptsecurity/mosaic/core","@angular/common","@ptsecurity/cdk/a11y","@ptsecurity/cdk/platform","rxjs","rxjs/operators","@ptsecurity/cdk/keycodes"],e):e((t.ng=t.ng||{},t.ng.mosaic=t.ng.mosaic||{},t.ng.mosaic.navbar={}),t.ng.core,t.ng.mosaic.core,t.ng.common,t.ng.cdk.a11y,t.ng.cdk.platform,t.rxjs,t.rxjs.operators,t.ng.cdk.keycodes)}(this,function(t,e,n,o,i,r,a,s,c){"use strict";function l(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},d=function(){function t(){}return t.decorators=[{type:e.Directive,args:[{selector:"[mc-icon]",host:{class:"mc mc-icon"}}]}],t}(),m=function(){function t(t){this._elementRef=t}return t}(),u=n.mixinColor(m),h=function(t){function n(e,n){var o=t.call(this,e)||this;return e.nativeElement.classList.add(n),o}return l(n,t),n.prototype._getHostElement=function(){return this._elementRef.nativeElement},n.decorators=[{type:e.Component,args:[{selector:"[mc-icon]",template:"<ng-content></ng-content>",styles:[""],changeDetection:e.ChangeDetectionStrategy.OnPush,encapsulation:e.ViewEncapsulation.None}]}],n.ctorParameters=function(){return[{type:e.ElementRef},{type:String,decorators:[{type:e.Attribute,args:["mc-icon"]}]}]},n}(u),f=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.CommonModule,i.A11yModule,r.PlatformModule],exports:[h,d],declarations:[h,d]}]}],t}(),b="mc-navbar-container",g="mc-navbar-item",y="mc-navbar-brand",v="mc-navbar-title",C=function(){function t(){}return t.decorators=[{type:e.Directive,args:[{selector:"mc-navbar-logo",host:{class:"mc-navbar-logo"}}]}],t}(),w=function(){function t(){}return t.decorators=[{type:e.Directive,args:[{selector:y,host:{class:y}}]}],t}(),I=function(){function t(){}return t.decorators=[{type:e.Directive,args:[{selector:v,host:{class:v}}]}],t}(),x=function(){function t(t){this._elementRef=t}return t}(),_=n.mixinDisabled(x),D=function(t){function n(e,n,o,i){var r=t.call(this,e)||this;return r.elementRef=e,r._focusMonitor=n,r._platform=o,r._cdRef=i,r.tabIndex=0,r.dropdownItems=[],r.isCollapsed=!0,r._subscription=new a.Subscription,r}return l(n,t),Object.defineProperty(n.prototype,"collapsedTitle",{set:function(t){this.elementRef.nativeElement.setAttribute("computedTitle",encodeURI(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasDropdownContent",{get:function(){return this.dropdownItems.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_dropdownElements",{get:function(){return this.dropdownContent?this.dropdownContent.nativeElement.querySelectorAll("li > *"):[]},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){this.denyClickIfDisabled(),this._focusMonitor$=this._focusMonitor.monitor(this.elementRef.nativeElement,!0),this.hasDropdownContent&&this.listenClickOutside()},n.prototype.ngAfterViewInit=function(){this.hasDropdownContent&&this.startListenFocusDropdownItems()},n.prototype.ngOnDestroy=function(){this._subscription.unsubscribe(),this._focusMonitor.stopMonitoring(this.elementRef.nativeElement),this.stopListenFocusDropdownItems()},n.prototype.isActiveDropdownLink=function(t){return!!this._platform.isBrowser&&window.location.href.indexOf(t)>=0},n.prototype.handleClickByItem=function(){this.toggleDropdown()},n.prototype.handleKeydown=function(t){var e=t.target.classList.contains(g);this.hasDropdownContent&&t.keyCode===c.SPACE&&e&&this.toggleDropdown()},n.prototype.handleClickByDropdownItem=function(){this.forceCloseDropdown()},n.prototype.listenClickOutside=function(){var t=this;this._subscription.add(this._focusMonitor$.subscribe(function(e){null===e&&t.forceCloseDropdown()}))},n.prototype.toggleDropdown=function(){this.isCollapsed=!this.isCollapsed},n.prototype.forceCloseDropdown=function(){this.isCollapsed=!0,this._cdRef.detectChanges()},n.prototype.startListenFocusDropdownItems=function(){var t=this;this._dropdownElements.forEach(function(e){t._focusMonitor.monitor(e,!0)})},n.prototype.stopListenFocusDropdownItems=function(){var t=this;this._dropdownElements.forEach(function(e){t._focusMonitor.stopMonitoring(e)})},n.prototype.denyClickIfDisabled=function(){var t=this,e=this.elementRef.nativeElement.eventListeners("click");e.forEach(function(e){return t.elementRef.nativeElement.removeEventListener("click",e)}),this.elementRef.nativeElement.addEventListener("click",function(e){t.elementRef.nativeElement.hasAttribute("disabled")&&e.stopImmediatePropagation()},!0),e.forEach(function(e){return t.elementRef.nativeElement.addEventListener("click",e)})},n.decorators=[{type:e.Component,args:[{selector:g,template:'\n        <a\n            [attr.tabindex]="disabled ? -1 : tabIndex"\n            (click)="handleClickByItem()"\n            (keydown)="handleKeydown($event)"\n            class="mc-navbar-item"\n        >\n            <ng-content></ng-content>\n            <i *ngIf="hasDropdownContent" mc-icon="mc-angle-M_16"></i>\n        </a>\n        <ul\n            #dropdownContent\n            *ngIf="hasDropdownContent"\n            [ngClass]="{ \'is-collapsed\': isCollapsed }"\n            class="mc-navbar-dropdown"\n        >\n            <li\n                *ngFor="let item of dropdownItems"\n                (click)="handleClickByDropdownItem()"\n                class="mc-navbar-dropdown-item"\n            >\n                <ng-container *ngIf="dropdownItemTmpl">\n                    <ng-container *ngTemplateOutlet="dropdownItemTmpl; context: { $implicit: item }"></ng-container>\n                </ng-container>\n                <a\n                    *ngIf="!dropdownItemTmpl"\n                    [attr.href]="item.link"\n                    [ngClass]="{ \'is-active\': isActiveDropdownLink(item.link) }"\n                    class="mc-navbar-dropdown-link"\n                >{{ item.text }}</a>\n            </li>\n        </ul>\n    ',encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush,inputs:["disabled"],host:{"[attr.disabled]":"disabled || null","[attr.tabindex]":"-1"}}]}],n.ctorParameters=function(){return[{type:e.ElementRef},{type:i.FocusMonitor},{type:r.Platform},{type:e.ChangeDetectorRef}]},n.propDecorators={tabIndex:[{type:e.Input}],dropdownItems:[{type:e.Input}],collapsedTitle:[{type:e.Input}],dropdownItemTmpl:[{type:e.ContentChild,args:["dropdownItemTmpl",{read:e.TemplateRef}]}],dropdownContent:[{type:e.ViewChild,args:["dropdownContent",{read:e.ElementRef}]}]},n}(_),E=function(){function t(){this.position="left"}return Object.defineProperty(t.prototype,"cssClasses",{get:function(){return"left"===this.position?"mc-navbar-left":"mc-navbar-right"},enumerable:!0,configurable:!0}),t.decorators=[{type:e.Directive,args:[{selector:b}]}],t.propDecorators={position:[{type:e.Input}],cssClasses:[{type:e.HostBinding,args:["class"]}]},t}(),k=function(){function t(t,e){this.element=t,this.width=e,this._collapsed=!1}return t.prototype.processCollapsed=function(t){this._collapsed=t,this.updateCollapsedClass()},t.prototype.updateCollapsedClass=function(){this._collapsed?this.element.classList.add("mc-navbar-collapsed-title"):this.element.classList.remove("mc-navbar-collapsed-title")},t}(),W=function(){function t(t,e,n){void 0===n&&(n=[]),this.element=t,this.width=e,this.itemsForCollapse=n}return Object.defineProperty(t.prototype,"canCollapse",{get:function(){return this.itemsForCollapse.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapsedItemsWidth",{get:function(){return void 0!==this._collapsedItemsWidth?this._collapsedItemsWidth:(this.calculateAndCacheCollapsedItemsWidth(),this._collapsedItemsWidth)},enumerable:!0,configurable:!0}),t.prototype.processCollapsed=function(t){this.itemsForCollapse.length>0&&this.updateTitle(t),this.itemsForCollapse.forEach(function(e){return e.processCollapsed(t)})},t.prototype.calculateAndCacheCollapsedItemsWidth=function(){this._collapsedItemsWidth=this.itemsForCollapse.reduce(function(t,e){return t+e.width},0)},t.prototype.getTitle=function(){var t=this.element.getAttribute("computedTitle");return t?decodeURI(t):this.itemsForCollapse.length>0?this.itemsForCollapse[0].element.innerText:""},t.prototype.updateTitle=function(t){t?this.element.setAttribute("title",this.getTitle()):this.element.removeAttribute("title")},t}(),M=function(){function t(t){this._elementRef=t,this.forceRecalculateItemsWidth=!1,this.resizeDebounceInterval=100,this.firstLevelElement=b,this.secondLevelElements=[g,y,v];var e=a.fromEvent(window,"resize").pipe(s.debounceTime(this.resizeDebounceInterval));this._resizeSubscription=e.subscribe(this.updateCollapsed.bind(this))}return Object.defineProperty(t.prototype,"maxAllowedWidth",{get:function(){return this._elementRef.nativeElement.querySelector("nav").getBoundingClientRect().width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsWidths",{get:function(){return void 0===this._itemsWidths||this.forceRecalculateItemsWidth?(this.calculateAndCacheItemsWidth(),this._itemsWidths):this._itemsWidths},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalItemsWidth",{get:function(){return void 0===this._totalItemsWidths||this.forceRecalculateItemsWidth?(this.calculateAndCacheTotalItemsWidth(),this._totalItemsWidths):this._totalItemsWidths},enumerable:!0,configurable:!0}),t.prototype.updateCollapsed=function(){for(var t=this.totalItemsWidth-this.maxAllowedWidth,e=this.itemsWidths.length-1;e>=0;e--){var n=this.itemsWidths[e];n.canCollapse&&(n.processCollapsed(t>0),t-=n.collapsedItemsWidth)}},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){return t.updateCollapsed()},0)},t.prototype.ngOnDestroy=function(){this._resizeSubscription.unsubscribe()},t.prototype.calculateAndCacheTotalItemsWidth=function(){this._totalItemsWidths=this.itemsWidths.reduce(function(t,e){return t+e.width},0)},t.prototype.getOuterElementWidth=function(t){return t.getBoundingClientRect().width+parseInt(getComputedStyle(t).getPropertyValue("margin-right"))+parseInt(getComputedStyle(t).getPropertyValue("margin-left"))},t.prototype.calculateAndCacheItemsWidth=function(){var t=this,e=this.secondLevelElements.map(function(e){return t.firstLevelElement+">"+e}),n=Array.from(this._elementRef.nativeElement.querySelectorAll(e));this._itemsWidths=n.map(function(e){return new W(e,t.getOuterElementWidth(e),t.getItemsForCollapse(e))})},t.prototype.getItemsForCollapse=function(t){return t.querySelector("[mc-icon],mc-navbar-logo,[mc-navbar-logo]")?Array.from(t.querySelectorAll(v)).map(function(t){return new k(t,t.getBoundingClientRect().width)}):[]},t.decorators=[{type:e.Component,args:[{selector:"mc-navbar",changeDetection:e.ChangeDetectionStrategy.OnPush,template:'\n        <nav class="mc-navbar">\n            <ng-content select="['+b+"],"+b+'"></ng-content>\n        </nav>\n    ',styles:['.mc-navbar-left,.mc-navbar-right,mc-navbar-container{height:100%;display:flex;flex-shrink:0;flex-direction:row;justify-content:space-between;align-items:center}.mc-navbar{position:relative;height:48px;padding:0 0;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.mc-navbar [mc-icon]+mc-navbar-title{margin-left:8px}.mc-navbar mc-navbar-title:not(.mc-navbar-collapsed-title)+[mc-icon]{margin-left:8px}.mc-navbar-brand,.mc-navbar-item,.mc-navbar-title,mc-navbar-brand,mc-navbar-item,mc-navbar-item:first-child{height:100%;position:relative;display:flex;align-items:center;padding-left:16px;padding-right:16px;background-color:transparent;border:none}.mc-navbar-brand,mc-navbar-brand{padding-left:0;padding-right:12px;margin-right:24px}.mc-navbar-brand .mc-navbar-title,mc-navbar-brand .mc-navbar-title{padding-left:12px;padding-right:0}.mc-navbar-title{white-space:nowrap}.mc-navbar-item:not([disabled]){cursor:pointer}.mc-navbar-item .mc-navbar-title,mc-navbar-brand,mc-navbar-item,mc-navbar-item:first-child{padding:0}mc-navbar-item.mc-progress:not([disabled]){cursor:pointer}.mc-navbar-item[disabled],mc-navbar-item[disabled] .mc-navbar-item{cursor:default}mc-navbar-title.mc-navbar-collapsed-title{display:none}.mc-navbar-dropdown{position:absolute;top:100%;left:0;box-sizing:border-box;min-width:100%;height:auto;margin:0;list-style:none;padding-top:4px;padding-right:0;padding-bottom:4px;padding-left:0;border:1px solid;border-top:none;z-index:1}.mc-navbar-right .mc-navbar-dropdown{left:auto;right:0}.mc-navbar-dropdown-link{position:relative;display:block;box-sizing:border-box;padding-top:6px;padding-right:16px;padding-bottom:6px;padding-left:16px;border:2px solid transparent;text-decoration:none;white-space:nowrap}.mc-navbar-dropdown-link.is-active:hover::before{position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;content:""}.mc-navbar-dropdown.is-collapsed{display:none}'],encapsulation:e.ViewEncapsulation.None}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t}(),R=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.CommonModule,i.A11yModule,r.PlatformModule,f],exports:[M,E,I,D,w,C],declarations:[M,E,I,D,w,C]}]}],t}();t.McNavbarModule=R,t.McNavbarLogo=C,t.McNavbarBrand=w,t.McNavbarTitle=I,t.McNavbarItemBase=x,t._McNavbarMixinBase=_,t.McNavbarItem=D,t.McNavbarContainer=E,t.McNavbar=M,t.ɵe8=h,t.ɵc8=m,t.ɵb8=d,t.ɵd8=u,t.ɵa8=f,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mosaic-navbar.umd.min.js.map
